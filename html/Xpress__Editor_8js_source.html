<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>XpressEngine Core: modules/editor/skins/xpresseditor/js/Xpress_Editor.js Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XpressEngine Core
   &#160;<span id="projectnumber">1.8.24</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e05d7e2b1ecd646af5bb94391405f3b5.html">modules</a></li><li class="navelem"><a class="el" href="dir_c27088f86878aa775a3d6accbab0d8f5.html">editor</a></li><li class="navelem"><a class="el" href="dir_3868ef74fe29a41483bcd4563b6147f2.html">skins</a></li><li class="navelem"><a class="el" href="dir_e0a65361d39fca864b91689baca060df.html">xpresseditor</a></li><li class="navelem"><a class="el" href="dir_f0bda578b681df531d8acb5e7f39b79d.html">js</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Xpress_Editor.js</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Xpress__Editor_8js.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;(<span class="keyword">function</span>($){</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// extends jQuery object</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;$.extend({</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    Class : <span class="keyword">function</span>(def) {</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        <span class="keyword">function</span> <a class="code" href="jquery-1_8x_8min_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>(){</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;            <span class="keywordflow">if</span> (typeof this.$super != <span class="stringliteral">&#39;undefined&#39;</span>) this.$super.$this = <span class="keyword">this</span>;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;            <span class="keywordflow">if</span> ($.isFunction(this.$init)) this.$init.apply(<span class="keyword">this</span>, arguments);</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        }</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        <a class="code" href="jquery-1_8x_8min_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>.prototype = def;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        <a class="code" href="jquery-1_8x_8min_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>.constructor = <a class="code" href="jquery-1_8x_8min_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        <a class="code" href="jquery-1_8x_8min_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>.extend = <a class="code" href="Xpress__Editor_8js.html#a86e645479660fa42b910395d43150925">Class_extend</a>;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="jquery-1_8x_8min_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a>;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    },</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    $ : <span class="keyword">function</span>(<a class="code" href="JSSpec_8js.html#ae8ddf9e890c62bf03be54143867a14a8">id</a>) {</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="keywordflow">if</span>(typeof <span class="keywordtype">id</span> == <span class="stringliteral">&#39;string&#39;</span>) {</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">id</span>.substring(0,1) == <span class="charliteral">&#39;&lt;&#39;</span>) <span class="keywordflow">return</span> $(<span class="keywordtype">id</span>).get(0);</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;            <span class="keywordflow">return</span> $(<span class="charliteral">&#39;#&#39;</span>+<a class="code" href="JSSpec_8js.html#ae8ddf9e890c62bf03be54143867a14a8">id</a>).<span class="keyword">get</span>(0);</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="JSSpec_8js.html#ae8ddf9e890c62bf03be54143867a14a8">id</a>;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        }</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    },</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    fnBind : <span class="keyword">function</span>(<a class="code" href="jquery-1_8x_8min_8js.html#a37b9e1ceee4c6d2616fa6081784b5468">fn</a>, th<span class="comment">/* , args... */</span>) {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        var args = $.makeArray(arguments);</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        args.shift(); args.shift();</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">function</span>() {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            var <a class="code" href="modernizr_8min_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a> = args.concat($.makeArray(arguments));</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="jquery-1_8x_8min_8js.html#a37b9e1ceee4c6d2616fa6081784b5468">fn</a>.apply(th, a);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        };</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;});</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="Xpress__Editor_8js.html#a95fb6129d74701884bbc51ee4d1430d4">   36</a></span>&#160;$.browser.nVersion = parseFloat($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.version);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="Xpress__Editor_8js.html#a86e645479660fa42b910395d43150925">   38</a></span>&#160;<span class="keyword">function</span> <a class="code" href="Xpress__Editor_8js.html#a86e645479660fa42b910395d43150925">Class_extend</a>(superDef) {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    var Super = superDef.prototype;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    this.<a class="code" href="jquery-1_8x_8js.html#a7ef9b7a13e7ecdb967f1b98b4ada2470">prototype</a>.$super = {};</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keyword">function</span> bind(<a class="code" href="jquery-1_8x_8min_8js.html#a37b9e1ceee4c6d2616fa6081784b5468">fn</a>) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">function</span>() {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="jquery-1_8x_8min_8js.html#a37b9e1ceee4c6d2616fa6081784b5468">fn</a>.apply(this.$this, arguments);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        };</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">for</span>(var <a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a> in Super) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">if</span> (!Super.propertyIsEnumerable(<a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a>)) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">if</span> (typeof this.<a class="code" href="jquery-1_8x_8js.html#a7ef9b7a13e7ecdb967f1b98b4ada2470">prototype</a>[<a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a>] == <span class="stringliteral">&#39;undefined&#39;</span>) this.<a class="code" href="jquery-1_8x_8js.html#a7ef9b7a13e7ecdb967f1b98b4ada2470">prototype</a>[<a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a>] = Super[<a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a>];</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        this.<a class="code" href="jquery-1_8x_8js.html#a7ef9b7a13e7ecdb967f1b98b4ada2470">prototype</a>.$super[<a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a>] = $.isFunction(Super[<a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a>])?bind(Super[x]):Super[<a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a>];</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">this</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordflow">if</span> (typeof <a class="code" href="jquery-1_8x_8js.html#ad55530ae1e5978df8e721017c1fc8466">window</a>.xe == <span class="stringliteral">&#39;undefined&#39;</span>) <a class="code" href="jquery-1_8x_8js.html#ad55530ae1e5978df8e721017c1fc8466">window</a>.xe = {};</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="Xpress__Editor_8js.html#a7362b09fcd4e8ae301dc538f2299ec97">   66</a></span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XpressCore = $.Class({</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XpressCore&quot;</span>,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    $init : <span class="keyword">function</span>(htOptions){</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        htOptions = !htOptions?{}:$.Class({}).<a class="code" href="jquery_8js.html#a84ade6b4c0a71f54664069487f2526dc">extend</a>({</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            oDebugger : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }).<a class="code" href="jquery_8js.html#a84ade6b4c0a71f54664069487f2526dc">extend</a>(htOptions);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">if</span>(htOptions.oDebugger){</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            this.oDebugger = htOptions.oDebugger;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            this.oDebugger.oApp = <span class="keyword">this</span>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="comment">// To prevent processing a Xpress command before all the plugins are registered and ready,</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="comment">// Queue up all the commands here until the application&#39;s status is changed to READY</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        this.commandQueue = [];</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        this.oCommandMap = {};</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        this.oDisabledCommand = {};</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        this.aPlugins = [];</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        this.appStatus = <a class="code" href="namespacexe.html">xe</a>.APP_STATUS[<span class="stringliteral">&quot;NOT_READY&quot;</span>];</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">// Register the core as a plugin so it can receive messages</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        this.<a class="code" href="xe_8min_8js.html#adee58f90c97f973ad30e3b5c6b693409">registerPlugin</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    },</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    exec : <span class="keyword">function</span>(msg, args, oEvent){</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="comment">// If the application is not yet ready just queue the command</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">if</span>(this.appStatus == <a class="code" href="namespacexe.html">xe</a>.APP_STATUS[<span class="stringliteral">&quot;NOT_READY&quot;</span>]){</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            this.commandQueue[this.commandQueue.length] = {<span class="stringliteral">&#39;msg&#39;</span>:msg, <span class="stringliteral">&#39;args&#39;</span>:args, <span class="stringliteral">&#39;event&#39;</span>:oEvent};</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        this.exec = this._exec;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        this.exec(msg, args, oEvent);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    },</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    delayedExec : <span class="keyword">function</span>(msg, args, nDelay, oEvent){</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        var fExec = $.fnBind(this.exec, <span class="keyword">this</span>, msg, args, oEvent);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        setTimeout(fExec, nDelay);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    },</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    _exec : <span class="keyword">function</span>(msg, args, oEvent){<span class="keywordflow">return</span> (this._exec = this.oDebugger?this._execWithDebugger:this._execWithoutDebugger).call(<span class="keyword">this</span>, msg, args, oEvent);},</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    _execWithDebugger : <span class="keyword">function</span>(msg, args, oEvent){this.oDebugger.log_MessageStart(msg, args);var bResult = this._doExec(msg, args, oEvent);this.oDebugger.log_MessageEnd(msg, args);<span class="keywordflow">return</span> bResult;   },</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    _execWithoutDebugger : <span class="keyword">function</span>(msg, args, oEvent){<span class="keywordflow">return</span> this._doExec(msg, args, oEvent);},</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    _doExec : <span class="keyword">function</span>(msg, args, oEvent){</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        var bContinue = <span class="keyword">false</span>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">if</span>(!this.oDisabledCommand[msg]){</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            var allArgs = [];</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordflow">if</span>(args &amp;&amp; args.length){</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                var iLen = args.length;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;iLen; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++) allArgs[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>] = args[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>];</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">if</span>(oEvent) allArgs[allArgs.length] = oEvent;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            var bContinue = <span class="keyword">true</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            bContinue = this._execMsgStep(<span class="stringliteral">&quot;BEFORE&quot;</span>, msg, allArgs);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span>(bContinue) bContinue = this._execMsgStep(<span class="stringliteral">&quot;ON&quot;</span>, msg, allArgs);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keywordflow">if</span>(bContinue) bContinue = this._execMsgStep(<span class="stringliteral">&quot;AFTER&quot;</span>, msg, allArgs);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">return</span> bContinue;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    },</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="xe_8min_8js.html#adee58f90c97f973ad30e3b5c6b693409">registerPlugin</a> : <span class="keyword">function</span>(oPlugin){</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">if</span>(!oPlugin) <span class="keywordflow">throw</span>(<span class="stringliteral">&quot;An error occured in registerPlugin(): invalid plug-in&quot;</span>);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        oPlugin.nIdx = this.aPlugins.length;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        oPlugin.oApp = <span class="keyword">this</span>;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        this.aPlugins[oPlugin.nIdx] = oPlugin;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// If the plugin does not specify that it takes time to be ready, change the stauts to READY right away</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span>(oPlugin.status != <a class="code" href="namespacexe.html">xe</a>.PLUGIN_STATUS[<span class="stringliteral">&quot;NOT_READY&quot;</span>]) oPlugin.status = <a class="code" href="namespacexe.html">xe</a>.PLUGIN_STATUS[<span class="stringliteral">&quot;READY&quot;</span>];</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        this.exec(<span class="stringliteral">&quot;MSG_PLUGIN_REGISTERED&quot;</span>, [oPlugin]);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">return</span> oPlugin.nIdx;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    },</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    disableCommand : <span class="keyword">function</span>(sCommand, bDisable){this.oDisabledCommand[sCommand] = bDisable;},</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    registerBrowserEvent : <span class="keyword">function</span>(obj, sEvent, sCMD, aParams, nDelay){</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span>(!obj) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        aParams = aParams || [];</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        var func = (nDelay)?$.fnBind(this.delayedExec, <span class="keyword">this</span>, sCMD, aParams, nDelay):$.fnBind(this.exec, <span class="keyword">this</span>, sCMD, aParams);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        $(obj).bind(sEvent, func);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    },</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="JSSpec_8js.html#a1bbe1edfe5ca552feb7c8830e9a19625">run</a> : <span class="keyword">function</span>(){</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">// Change the status from NOT_READY to let exec to process all the way</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        this._changeAppStatus(<a class="code" href="namespacexe.html">xe</a>.APP_STATUS[<span class="stringliteral">&quot;WAITING_FOR_PLUGINS_READY&quot;</span>]);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">// Process all the commands in the queue</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        var iQueueLength = this.commandQueue.length;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;iQueueLength; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            var curMsgAndArgs = this.commandQueue[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>];</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            this.exec(curMsgAndArgs.msg, curMsgAndArgs.args, curMsgAndArgs.event);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        this._waitForPluginReady();</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    },</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// Use this also to update the mapping</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    createCommandMap : <span class="keyword">function</span>(sMsgHandler){</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        this.oCommandMap[sMsgHandler] = [];</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        var nLen = this.aPlugins.length;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;nLen; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++) this._doAddToCommandMap(sMsgHandler, this.aPlugins[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>]);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    },</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    addToCommandMap : <span class="keyword">function</span>(sMsgHandler, oPlugin){</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">// cannot &quot;ADD&quot; unless the map is already created.</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">// the message will be added automatically to the mapping when it is first passed anyways, so do not add now</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span>(!this.oCommandMap[sMsgHandler]) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        this._addToCommandMap(sMsgHandler, oPlugin);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    },</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    _changeAppStatus : <span class="keyword">function</span>(appStatus){</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        this.appStatus = appStatus;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="comment">// Initiate MSG_APP_READY if the application&#39;s status is being switched to READY</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">if</span>(this.appStatus == <a class="code" href="namespacexe.html">xe</a>.APP_STATUS[<span class="stringliteral">&quot;READY&quot;</span>]) this.exec(<span class="stringliteral">&quot;MSG_APP_READY&quot;</span>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    },</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    _execMsgStep : <span class="keyword">function</span>(sMsgStep, sMsg, args){<span class="keywordflow">return</span> (this._execMsgStep = this.oDebugger?this._execMsgStepWithDebugger:this._execMsgStepWithoutDebugger).call(<span class="keyword">this</span>, sMsgStep, sMsg, args);},</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    _execMsgStepWithDebugger : <span class="keyword">function</span>(sMsgStep, sMsg, args){this.oDebugger.log_MessageStepStart(sMsgStep, sMsg, args);var bStatus = this._execMsgHandler (<span class="stringliteral">&quot;$&quot;</span>+sMsgStep+<span class="stringliteral">&quot;_&quot;</span>+sMsg, args);this.oDebugger.log_MessageStepEnd(sMsgStep, sMsg, args);<span class="keywordflow">return</span> bStatus;},</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    _execMsgStepWithoutDebugger : <span class="keyword">function</span>(sMsgStep, sMsg, args){<span class="keywordflow">return</span> this._execMsgHandler (<span class="stringliteral">&quot;$&quot;</span>+sMsgStep+<span class="stringliteral">&quot;_&quot;</span>+sMsg, args);},</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    _execMsgHandler : <span class="keyword">function</span>(sMsgHandler, args){</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">if</span>(!this.oCommandMap[sMsgHandler]){</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            this.createCommandMap(sMsgHandler);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        var aPlugins = this.oCommandMap[sMsgHandler];</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        var iNumOfPlugins = aPlugins.length;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">if</span>(iNumOfPlugins == 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        var tmpStatus, bResult = <span class="keyword">true</span>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">// two similar codes were written twice due to the performace.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span>(sMsgHandler.match(/^\$(BEFORE|ON|AFTER)_MSG_APP_READY$/)){</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;iNumOfPlugins; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                tmpStatus = this._execHandler(aPlugins[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>], sMsgHandler, args);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="keywordflow">if</span>(tmpStatus === <span class="keyword">false</span>){</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    bResult = <span class="keyword">false</span>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;iNumOfPlugins; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <span class="keywordflow">if</span>(typeof aPlugins[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>][<span class="stringliteral">&quot;$PRECONDITION&quot;</span>] == <span class="stringliteral">&quot;function&quot;</span>) <span class="keywordflow">if</span>(!this._execHandler(aPlugins[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>], <span class="stringliteral">&quot;$PRECONDITION&quot;</span>, [sMsgHandler, args])) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                tmpStatus = this._execHandler(aPlugins[i], sMsgHandler, args);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="keywordflow">if</span>(tmpStatus === <span class="keyword">false</span>){</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    bResult = <span class="keyword">false</span>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">return</span> bResult;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    },</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    _execHandler : <span class="keyword">function</span>(oPlugin, sHandler, args){<span class="keywordflow">return</span> (this._execHandler = this.oDebugger?this._execHandlerWithDebugger:this._execHandlerWithoutDebugger).call(<span class="keyword">this</span>, oPlugin, sHandler, args);},</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    _execHandlerWithDebugger : <span class="keyword">function</span>(oPlugin, sHandler, args){this.oDebugger.log_CallHandlerStart(oPlugin, sHandler, args);var bResult = oPlugin[sHandler].apply(oPlugin, args);this.oDebugger.log_CallHandlerEnd(oPlugin, sHandler, args);<span class="keywordflow">return</span> bResult;},</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    _execHandlerWithoutDebugger : <span class="keyword">function</span>(oPlugin, sHandler, args){<span class="keywordflow">return</span> oPlugin[sHandler].apply(oPlugin, args);},</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    _doAddToCommandMap : <span class="keyword">function</span>(sMsgHandler, oPlugin){</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span>(typeof oPlugin[sMsgHandler] != <span class="stringliteral">&quot;function&quot;</span>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        this.oCommandMap[sMsgHandler][this.oCommandMap[sMsgHandler].length] = oPlugin;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    },</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    _waitForPluginReady : <span class="keyword">function</span>(){</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        var bAllReady = <span class="keyword">true</span>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;this.aPlugins.length; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">if</span>(this.aPlugins[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].status == <a class="code" href="namespacexe.html">xe</a>.PLUGIN_STATUS[<span class="stringliteral">&quot;NOT_READY&quot;</span>]){</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                bAllReady = <span class="keyword">false</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordflow">if</span>(bAllReady){</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            this._changeAppStatus(<a class="code" href="namespacexe.html">xe</a>.APP_STATUS[<span class="stringliteral">&quot;READY&quot;</span>]);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            setTimeout($.fnBind(this._waitForPluginReady, <span class="keyword">this</span>), 100);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;});</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="Xpress__Editor_8js.html#a4e98cc700c9a207c4bfec6d81153121b">  256</a></span>&#160;<a class="code" href="namespacexe.html">xe</a>.APP_STATUS = {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="stringliteral">&#39;NOT_READY&#39;</span> : 0,</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="stringliteral">&#39;WAITING_FOR_PLUGINS_READY&#39;</span> : 1,</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="stringliteral">&#39;READY&#39;</span> : 2</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;};</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="Xpress__Editor_8js.html#ae57b23204a095d3ea0709da593a8da70">  262</a></span>&#160;<a class="code" href="namespacexe.html">xe</a>.PLUGIN_STATUS = {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="stringliteral">&#39;NOT_READY&#39;</span> : 0,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="stringliteral">&#39;READY&#39;</span> : 1</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;};</div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="Xpress__Editor_8js.html#ae005ad41457e21ee74e7ea4a3c3f1bee">  270</a></span>&#160;<a class="code" href="namespacexe.html">xe</a>.W3CDOMRange = $.Class({</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    $init : <span class="keyword">function</span>(doc){</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        this._document = doc || <a class="code" href="html5_8js.html#aa14f8e0338cced6720590fd2ea13bd4b">document</a>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        this.collapsed = <span class="keyword">true</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        this.commonAncestorContainer = this._document.body;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        this.endContainer = this._document.body;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        this.endOffset = 0;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        this.startContainer = this._document.body;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        this.startOffset = 0;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    },</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    cloneContents : <span class="keyword">function</span>(){</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        var oClonedContents = this._document.createDocumentFragment();</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        var oTmpContainer = this._document.createDocumentFragment();</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        var aNodes = this._getNodesInRange();</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">if</span>(aNodes.length &lt; 1) <span class="keywordflow">return</span> oClonedContents;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        var oClonedContainers = this._constructClonedTree(aNodes, oTmpContainer);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">// oTopContainer = aNodes[aNodes.length-1].parentNode and this is not part of the initial array and only those child nodes should be cloned</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        var oTopContainer = oTmpContainer.firstChild;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">if</span>(oTopContainer){</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            var elCurNode = oTopContainer.firstChild;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            var elNextNode;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">while</span>(elCurNode){</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                elNextNode = elCurNode.nextSibling;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                oClonedContents.appendChild(elCurNode);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                elCurNode = elNextNode;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        oClonedContainers = this._splitTextEndNodes({oStartContainer: oClonedContainers.oStartContainer, iStartOffset: this.startOffset,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                                    oEndContainer: oClonedContainers.oEndContainer, iEndOffset: this.endOffset});</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">if</span>(oClonedContainers.oStartContainer &amp;&amp; oClonedContainers.oStartContainer.previousSibling)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oClonedContainers.oStartContainer).removeChild(oClonedContainers.oStartContainer.previousSibling);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span>(oClonedContainers.oEndContainer &amp;&amp; oClonedContainers.oEndContainer.nextSibling)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oClonedContainers.oEndContainer).removeChild(oClonedContainers.oEndContainer.nextSibling);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">return</span> oClonedContents;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    },</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    _constructClonedTree : <span class="keyword">function</span>(aNodes, oClonedParentNode){</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        var oClonedStartContainer = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        var oClonedEndContainer = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        var oStartContainer = this.startContainer;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        var oEndContainer = this.endContainer;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        _recurConstructClonedTree = <span class="keyword">function</span>(aAllNodes, iCurIdx, oParentNode, oClonedParentNode){</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordflow">if</span>(iCurIdx &lt; 0) <span class="keywordflow">return</span> iCurIdx;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            var iChildIdx = iCurIdx-1;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            var oCurNodeCloneWithChildren = aAllNodes[iCurIdx].cloneNode(<span class="keyword">false</span>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">if</span>(aAllNodes[iCurIdx] == oStartContainer) oClonedStartContainer = oCurNodeCloneWithChildren;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="keywordflow">if</span>(aAllNodes[iCurIdx] == oEndContainer) oClonedEndContainer = oCurNodeCloneWithChildren;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">while</span>(iChildIdx &gt;= 0 &amp;&amp; <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(aAllNodes[iChildIdx]) == aAllNodes[iCurIdx]){</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                iChildIdx = this._recurConstructClonedTree(aAllNodes, iChildIdx, aAllNodes[iCurIdx], oCurNodeCloneWithChildren, oClonedStartContainer, oClonedEndContainer);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="comment">// this may trigger an error message in IE when an erroneous script is inserted</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            oClonedParentNode.insertBefore(oCurNodeCloneWithChildren, oClonedParentNode.firstChild);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">return</span> iChildIdx;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        };</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        aNodes[aNodes.length] = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(aNodes[aNodes.length-1]);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        _recurConstructClonedTree(aNodes, aNodes.length-1, aNodes[aNodes.length-1], oClonedParentNode);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">return</span> {oStartContainer: oClonedStartContainer, oEndContainer: oClonedEndContainer};</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    },</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    cloneRange : <span class="keyword">function</span>(){</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">return</span> this._copyRange(<span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange(<span class="keyword">this</span>._document));</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    },</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    _copyRange : <span class="keyword">function</span>(oClonedRange){</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        oClonedRange.collapsed = this.collapsed;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        oClonedRange.commonAncestorContainer = this.commonAncestorContainer;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        oClonedRange.endContainer = this.endContainer;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        oClonedRange.endOffset = this.endOffset;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        oClonedRange.startContainer = this.startContainer;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        oClonedRange.startOffset = this.startOffset;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        oClonedRange._document = this._document;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">return</span> oClonedRange;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    },</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    collapse : <span class="keyword">function</span>(toStart){</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span>(toStart){</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            this.endContainer = this.startContainer;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            this.endOffset = this.startOffset;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            this.startContainer = this.endContainer;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            this.startOffset = this.endOffset;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        this._updateRangeInfo();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    },</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    compareBoundaryPoints : <span class="keyword">function</span>(how, sourceRange){</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">switch</span>(how){</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange.START_TO_START:</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordflow">return</span> this._compareEndPoint(this.startContainer, this.startOffset, sourceRange.startContainer, sourceRange.startOffset);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange.START_TO_END:</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="keywordflow">return</span> this._compareEndPoint(this.endContainer, this.endOffset, sourceRange.startContainer, sourceRange.startOffset);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange.END_TO_END:</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <span class="keywordflow">return</span> this._compareEndPoint(this.endContainer, this.endOffset, sourceRange.endContainer, sourceRange.endOffset);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange.END_TO_START:</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="keywordflow">return</span> this._compareEndPoint(this.startContainer, this.startOffset, sourceRange.endContainer, sourceRange.endOffset);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    },</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    _findBody : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span>(!oNode) <span class="keywordflow">return</span> <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">while</span>(oNode){</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">if</span>(oNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>) <span class="keywordflow">return</span> oNode;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            oNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNode);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    },</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    _compareEndPoint : <span class="keyword">function</span>(oContainerA, iOffsetA, oContainerB, iOffsetB){</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        var iIdxA, iIdxB;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">if</span>(!oContainerA || this._findBody(oContainerA) != this._document.body){</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            oContainerA = this._document.body;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            iOffsetA = 0;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">if</span>(!oContainerB || this._findBody(oContainerB) != this._document.body){</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            oContainerB = this._document.body;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            iOffsetB = 0;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        var compareIdx = <span class="keyword">function</span>(iIdxA, iIdxB){</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="comment">// iIdxX == -1 when the node is the commonAncestorNode</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="comment">// if iIdxA == -1</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="comment">// -&gt; [[&lt;nodeA&gt;...&lt;nodeB&gt;&lt;/nodeB&gt;]]...&lt;/nodeA&gt;</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="comment">// if iIdxB == -1</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="comment">// -&gt; &lt;nodeB&gt;...[[&lt;nodeA&gt;&lt;/nodeA&gt;...&lt;/nodeB&gt;]]</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordflow">if</span>(iIdxB == -1) iIdxB = iIdxA+1;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keywordflow">if</span>(iIdxA &lt; iIdxB) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordflow">if</span>(iIdxA == iIdxB) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        };</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        var oCommonAncestor = this._getCommonAncestorContainer(oContainerA, oContainerB);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">// ================================================================================================================================================</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">//  Move up both containers so that both containers are direct child nodes of the common ancestor node. From there, just compare the offset</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">// Add 0.5 for each contaienrs that has &quot;moved up&quot; since the actual node is wrapped by 1 or more parent nodes and therefore its position is somewhere between idx &amp; idx+1</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">// &lt;COMMON_ANCESTOR&gt;NODE1&lt;P&gt;NODE2&lt;/P&gt;NODE3&lt;/COMMON_ANCESTOR&gt;</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">// The position of NODE2 in COMMON_ANCESTOR is somewhere between after NODE1(idx1) and before NODE3(idx2), so we let that be 1.5</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">// container node A in common ancestor container</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        var oNodeA = oContainerA;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">if</span>(oNodeA != oCommonAncestor){</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="keywordflow">while</span>((oTmpNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNodeA)) != oCommonAncestor){oNodeA = oTmpNode;}</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            iIdxA = this._getPosIdx(oNodeA)+0.5;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        }<span class="keywordflow">else</span> iIdxA = iOffsetA;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="comment">// container node B in common ancestor container</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        var oNodeB = oContainerB;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">if</span>(oNodeB != oCommonAncestor){</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordflow">while</span>((oTmpNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNodeB)) != oCommonAncestor){oNodeB = oTmpNode;}</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            iIdxB = this._getPosIdx(oNodeB)+0.5;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        }<span class="keywordflow">else</span> iIdxB = iOffsetB;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">return</span> compareIdx(iIdxA, iIdxB);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    },</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    _getCommonAncestorContainer : <span class="keyword">function</span>(oNode1, oNode2){</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        var oComparingNode = oNode2;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordflow">while</span>(oNode1){</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">while</span>(oComparingNode){</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                <span class="keywordflow">if</span>(oNode1 == oComparingNode) <span class="keywordflow">return</span> oNode1;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                oComparingNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oComparingNode);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            oComparingNode = oNode2;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            oNode1 = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNode1);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">return</span> this._document.body;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    },</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    deleteContents : <span class="keyword">function</span>(){</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">if</span>(this.collapsed) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        this._splitTextEndNodesOfTheRange();</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        var aNodes = this._getNodesInRange();</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">if</span>(aNodes.length &lt; 1) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        var oPrevNode = aNodes[0].previousSibling;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">while</span>(oPrevNode &amp;&amp; this._isBlankTextNode(oPrevNode)) oPrevNode = oPrevNode.previousSibling;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        var oNewStartContainer, iNewOffset;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">if</span>(!oPrevNode){</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            oNewStartContainer = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(aNodes[0]);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            iNewOffset = 0;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;aNodes.length; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            var oNode = aNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>];</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordflow">if</span>(!oNode.firstChild){</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                <span class="keywordflow">if</span>(oNewStartContainer == oNode){</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                    iNewOffset = this._getPosIdx(oNewStartContainer);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                    oNewStartContainer = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNode);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNode).removeChild(oNode);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">if</span>(!oPrevNode){</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            this.setStart(oNewStartContainer, iNewOffset);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordflow">if</span>(oPrevNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>)</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                this.setStartBefore(oPrevNode);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                this.setStartAfter(oPrevNode);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        this.collapse(<span class="keyword">true</span>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    },</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    extractContents : <span class="keyword">function</span>(){</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        var oClonedContents = this.cloneContents();</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        this.deleteContents();</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">return</span> oClonedContents;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    },</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    insertNode : <span class="keyword">function</span>(newNode){</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        var oFirstNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        var oParentContainer;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">if</span>(this.startContainer.nodeType == <span class="stringliteral">&quot;3&quot;</span>){</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            oParentContainer = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(this.startContainer);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">if</span>(this.startContainer.nodeValue.length &lt;= <span class="keyword">this</span>.startOffset)</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                oFirstNode = this.startContainer.nextSibling;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                oFirstNode = this.startContainer.splitText(this.startOffset);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            oParentContainer = this.startContainer;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            oFirstNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(this.startContainer)[this.startOffset];</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">if</span>(!oFirstNode || !<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oFirstNode)) oFirstNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        oParentContainer.insertBefore(newNode, oFirstNode);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        this.setStartBefore(newNode);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    },</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    selectNode : <span class="keyword">function</span>(refNode){</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        this.setStartBefore(refNode);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        this.setEndAfter(refNode);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    },</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    selectNodeContents : <span class="keyword">function</span>(refNode){</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        this.setStart(refNode, 0);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        this.setEnd(refNode, <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(refNode).length);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    },</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    _endsNodeValidation : <span class="keyword">function</span>(oNode, iOffset){</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">if</span>(!oNode || this._findBody(oNode) != this._document.body) <span class="keywordflow">throw</span> <span class="keyword">new</span> Error(<span class="stringliteral">&quot;INVALID_NODE_TYPE_ERR oNode is not part of current document&quot;</span>);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">if</span>(oNode.nodeType == 3){</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordflow">if</span>(iOffset &gt; oNode.nodeValue.length) iOffset = oNode.nodeValue.length;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="keywordflow">if</span>(iOffset &gt; <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(oNode).length) iOffset = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(oNode).length;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">return</span> iOffset;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    },</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    setEnd : <span class="keyword">function</span>(refNode, <a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a>){</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a> = this._endsNodeValidation(refNode, <a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a>);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        this.endContainer = refNode;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        this.endOffset = <a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a>;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">if</span>(!this.startContainer || this._compareEndPoint(this.startContainer, this.startOffset, this.endContainer, this.endOffset) != -1) this.collapse(<span class="keyword">false</span>);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        this._updateRangeInfo();</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    },</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    setEndAfter : <span class="keyword">function</span>(refNode){</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">if</span>(!refNode) <span class="keywordflow">throw</span> <span class="keyword">new</span> Error(<span class="stringliteral">&quot;INVALID_NODE_TYPE_ERR in setEndAfter&quot;</span>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">if</span>(refNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>){</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            this.setEnd(refNode, <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(refNode).length);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        this.setEnd(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(refNode), this._getPosIdx(refNode)+1);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    },</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    setEndBefore : <span class="keyword">function</span>(refNode){</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordflow">if</span>(!refNode) <span class="keywordflow">throw</span> <span class="keyword">new</span> Error(<span class="stringliteral">&quot;INVALID_NODE_TYPE_ERR in setEndBefore&quot;</span>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">if</span>(refNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>){</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            this.setEnd(refNode, 0);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        this.setEnd(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(refNode), this._getPosIdx(refNode));</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    },</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    setStart : <span class="keyword">function</span>(refNode, <a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a>){</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a> = this._endsNodeValidation(refNode, <a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a>);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        this.startContainer = refNode;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        this.startOffset = <a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">if</span>(!this.endContainer || this._compareEndPoint(this.startContainer, this.startOffset, this.endContainer, this.endOffset) != -1) this.collapse(<span class="keyword">true</span>);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        this._updateRangeInfo();</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    },</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    setStartAfter : <span class="keyword">function</span>(refNode){</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keywordflow">if</span>(!refNode) <span class="keywordflow">throw</span> <span class="keyword">new</span> Error(<span class="stringliteral">&quot;INVALID_NODE_TYPE_ERR in setStartAfter&quot;</span>);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span>(refNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>){</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            this.setStart(refNode, <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(refNode).length);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        this.setStart(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(refNode), this._getPosIdx(refNode)+1);</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    },</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    setStartBefore : <span class="keyword">function</span>(refNode){</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">if</span>(!refNode) <span class="keywordflow">throw</span> <span class="keyword">new</span> Error(<span class="stringliteral">&quot;INVALID_NODE_TYPE_ERR in setStartBefore&quot;</span>);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">if</span>(refNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>){</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            this.setStart(refNode, 0);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        this.setStart(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(refNode), this._getPosIdx(refNode));</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    },</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    surroundContents : <span class="keyword">function</span>(newParent){</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        newParent.appendChild(this.extractContents());</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        this.insertNode(newParent);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        this.selectNode(newParent);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    },</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="diff__match__patch_8js.html#a5d4c58bc1e0a7de2e75ea206be2cbe94">toString</a> : <span class="keyword">function</span>(){</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        var oTmpContainer = this._document.createElement(<span class="stringliteral">&quot;DIV&quot;</span>);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        oTmpContainer.appendChild(this.cloneContents());</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keywordflow">return</span> oTmpContainer.textContent || oTmpContainer.innerText || <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    },</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    _isBlankTextNode : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">if</span>(oNode.nodeType == 3 &amp;&amp; oNode.nodeValue == <span class="stringliteral">&quot;&quot;</span>) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    },</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    _getPosIdx : <span class="keyword">function</span>(refNode){</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        var idx = 0;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">for</span>(var node = refNode.previousSibling; node; node = node.previousSibling) idx++;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">return</span> idx;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    },</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    _updateRangeInfo : <span class="keyword">function</span>(){</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">if</span>(!this.startContainer){</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            this.<a class="code" href="jquery-1_8x_8js.html#a4411a3d16c33c71210302860f22ba789">init</a>(this._document);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        this.collapsed = this._isCollapsed(this.startContainer, this.startOffset, this.endContainer, this.endOffset);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        this.commonAncestorContainer = this._getCommonAncestorContainer(this.startContainer, this.endContainer);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    },</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    _isCollapsed : <span class="keyword">function</span>(oStartContainer, iStartOffset, oEndContainer, iEndOffset){</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        var bCollapsed = <span class="keyword">false</span>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">if</span>(oStartContainer == oEndContainer &amp;&amp; iStartOffset == iEndOffset){</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            bCollapsed = <span class="keyword">true</span>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            var oActualStartNode = this._getActualStartNode(oStartContainer, iStartOffset);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            var oActualEndNode = this._getActualEndNode(oEndContainer, iEndOffset);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="comment">// Take the parent nodes on the same level for easier comparison when they&#39;re next to each other</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <span class="comment">// eg) From</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="comment">//  &lt;A&gt;</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="comment">//      &lt;B&gt;</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="comment">//          &lt;C&gt;</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="comment">//          &lt;/C&gt;</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="comment">//      &lt;/B&gt;</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="comment">//      &lt;D&gt;</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="comment">//          &lt;E&gt;</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="comment">//              &lt;F&gt;</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="comment">//              &lt;/F&gt;</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="comment">//          &lt;/E&gt;</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="comment">//      &lt;/D&gt;</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="comment">//  &lt;/A&gt;</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="comment">//  , it&#39;s easier to compare the position of B and D rather than C and F because they are siblings</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <span class="comment">// If the range were collapsed, oActualEndNode will precede oActualStartNode by doing this</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            oActualStartNode = this._getNextNode(this._getPrevNode(oActualStartNode));</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            oActualEndNode = this._getPrevNode(this._getNextNode(oActualEndNode));</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keywordflow">if</span>(oActualStartNode &amp;&amp; oActualEndNode &amp;&amp; oActualEndNode.tagName != <span class="stringliteral">&quot;BODY&quot;</span> &amp;&amp;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                (<span class="keyword">this</span>._getNextNode(oActualEndNode) == oActualStartNode || (oActualEndNode == oActualStartNode &amp;&amp; this._isBlankTextNode(oActualEndNode)))</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            )</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                bCollapsed = <span class="keyword">true</span>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">return</span> bCollapsed;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    },</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    _splitTextEndNodesOfTheRange : <span class="keyword">function</span>(){</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        var oEndPoints = this._splitTextEndNodes({oStartContainer: this.startContainer, iStartOffset: this.startOffset,</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                                    oEndContainer: this.endContainer, iEndOffset: this.endOffset});</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        this.startContainer = oEndPoints.oStartContainer;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        this.startOffset = oEndPoints.iStartOffset;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        this.endContainer = oEndPoints.oEndContainer;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        this.endOffset = oEndPoints.iEndOffset;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    },</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    _splitTextEndNodes : <span class="keyword">function</span>(oEndPoints){</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        oEndPoints = this._splitStartTextNode(oEndPoints);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        oEndPoints = this._splitEndTextNode(oEndPoints);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">return</span> oEndPoints;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    },</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    _splitStartTextNode : <span class="keyword">function</span>(oEndPoints){</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        var oStartContainer = oEndPoints.oStartContainer;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        var iStartOffset = oEndPoints.iStartOffset;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        var oEndContainer = oEndPoints.oEndContainer;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        var iEndOffset = oEndPoints.iEndOffset;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">if</span>(!oStartContainer) <span class="keywordflow">return</span> oEndPoints;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">if</span>(oStartContainer.nodeType != 3) <span class="keywordflow">return</span> oEndPoints;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">if</span>(iStartOffset == 0) <span class="keywordflow">return</span> oEndPoints;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">if</span>(oStartContainer.nodeValue.length &lt;= iStartOffset) <span class="keywordflow">return</span> oEndPoints;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        var oLastPart = oStartContainer.splitText(iStartOffset);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">if</span>(oStartContainer == oEndContainer){</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            iEndOffset -= iStartOffset;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            oEndContainer = oLastPart;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        }</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        oStartContainer = oLastPart;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        iStartOffset = 0;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordflow">return</span> {oStartContainer: oStartContainer, iStartOffset: iStartOffset, oEndContainer: oEndContainer, iEndOffset: iEndOffset};</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    },</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    _splitEndTextNode : <span class="keyword">function</span>(oEndPoints){</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        var oStartContainer = oEndPoints.oStartContainer;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        var iStartOffset = oEndPoints.iStartOffset;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        var oEndContainer = oEndPoints.oEndContainer;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        var iEndOffset = oEndPoints.iEndOffset;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keywordflow">if</span>(!oEndContainer) <span class="keywordflow">return</span> oEndPoints;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keywordflow">if</span>(oEndContainer.nodeType != 3) <span class="keywordflow">return</span> oEndPoints;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">if</span>(iEndOffset &gt;= oEndContainer.nodeValue.length) <span class="keywordflow">return</span> oEndPoints;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">if</span>(iEndOffset == 0) <span class="keywordflow">return</span> oEndPoints;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        oEndContainer.splitText(iEndOffset);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">return</span> {oStartContainer: oStartContainer, iStartOffset: iStartOffset, oEndContainer: oEndContainer, iEndOffset: iEndOffset};</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    },</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    _getNodesInRange : <span class="keyword">function</span>(){</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">if</span>(this.collapsed) <span class="keywordflow">return</span> [];</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        var oStartNode = this._getActualStartNode(this.startContainer, this.startOffset);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        var oEndNode = this._getActualEndNode(this.endContainer, this.endOffset);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">return</span> this._getNodesBetween(oStartNode, oEndNode);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    },</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    _getActualStartNode : <span class="keyword">function</span>(oStartContainer, iStartOffset){</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        var oStartNode = oStartContainer;;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keywordflow">if</span>(oStartContainer.nodeType == 3){</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="keywordflow">if</span>(iStartOffset &gt;= oStartContainer.nodeValue.length){</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                oStartNode = this._getNextNode(oStartContainer);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <span class="keywordflow">if</span>(oStartNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>) oStartNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                oStartNode = oStartContainer;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="keywordflow">if</span>(iStartOffset &lt; <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(oStartContainer).length){</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                oStartNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(oStartContainer)[iStartOffset];</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                oStartNode = this._getNextNode(oStartContainer);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <span class="keywordflow">if</span>(oStartNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>) oStartNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">return</span> oStartNode;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    },</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    _getActualEndNode : <span class="keyword">function</span>(oEndContainer, iEndOffset){</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        var oEndNode = oEndContainer;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">if</span>(iEndOffset == 0){</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            oEndNode = this._getPrevNode(oEndContainer);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <span class="keywordflow">if</span>(oEndNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>) oEndNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(oEndContainer.nodeType == 3){</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            oEndNode = oEndContainer;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            oEndNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(oEndContainer)[iEndOffset-1];</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        }</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordflow">return</span> oEndNode;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    },</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    _getNextNode : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordflow">if</span>(!oNode || oNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>) <span class="keywordflow">return</span> this._document.body;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">if</span>(oNode.nextSibling) <span class="keywordflow">return</span> oNode.nextSibling;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keywordflow">return</span> this._getNextNode(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNode));</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    },</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    _getPrevNode : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keywordflow">if</span>(!oNode || oNode.tagName == <span class="stringliteral">&quot;BODY&quot;</span>) <span class="keywordflow">return</span> this._document.body;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keywordflow">if</span>(oNode.previousSibling) <span class="keywordflow">return</span> oNode.previousSibling;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordflow">return</span> this._getPrevNode(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNode));</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    },</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">// includes partially selected</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="comment">// for &lt;div id=&quot;a&quot;&gt;&lt;div id=&quot;b&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div id=&quot;c&quot;&gt;&lt;/div&gt;, _getNodesBetween(b, c) will yield to b, &quot;a&quot; and c</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    _getNodesBetween : <span class="keyword">function</span>(oStartNode, oEndNode){</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        var aNodesBetween = [];</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        this._nNodesBetweenLen = 0;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordflow">if</span>(!oStartNode || !oEndNode) <span class="keywordflow">return</span> aNodesBetween;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        this._recurGetNextNodesUntil(oStartNode, oEndNode, aNodesBetween);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">return</span> aNodesBetween;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    },</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    _recurGetNextNodesUntil : <span class="keyword">function</span>(oNode, oEndNode, aNodesBetween){</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordflow">if</span>(!oNode) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">if</span>(!this._recurGetChildNodesUntil(oNode, oEndNode, aNodesBetween)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        var oNextToChk = oNode.nextSibling;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">while</span>(!oNextToChk){</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">if</span>(!(oNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNode))) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            aNodesBetween[this._nNodesBetweenLen++] = oNode;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="keywordflow">if</span>(oNode == oEndNode) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            oNextToChk = oNode.nextSibling;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        }</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="keywordflow">return</span> this._recurGetNextNodesUntil(oNextToChk, oEndNode, aNodesBetween);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    },</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    _recurGetChildNodesUntil : <span class="keyword">function</span>(oNode, oEndNode, aNodesBetween){</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordflow">if</span>(!oNode) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        var bEndFound = <span class="keyword">false</span>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        var oCurNode = oNode;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">if</span>(oCurNode.firstChild){</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            oCurNode = oCurNode.firstChild;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="keywordflow">while</span>(oCurNode){</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                <span class="keywordflow">if</span>(!this._recurGetChildNodesUntil(oCurNode, oEndNode, aNodesBetween)){</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                    bEndFound = <span class="keyword">true</span>;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                oCurNode = oCurNode.nextSibling;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        aNodesBetween[this._nNodesBetweenLen++] = oNode;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keywordflow">if</span>(bEndFound) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">if</span>(oNode == oEndNode) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;});</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno"><a class="line" href="Xpress__Editor_8js.html#a2a488ca0c54bef41cd94ae4334fca763">  878</a></span>&#160;<a class="code" href="namespacexe.html">xe</a>.W3CDOMRange.START_TO_START = 0;</div><div class="line"><a name="l00879"></a><span class="lineno"><a class="line" href="Xpress__Editor_8js.html#af2839fc42e9583ecad27de8c79c94551">  879</a></span>&#160;<a class="code" href="namespacexe.html">xe</a>.W3CDOMRange.START_TO_END = 1;</div><div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="Xpress__Editor_8js.html#a7514998df379a196147db35a4a4da555">  880</a></span>&#160;<a class="code" href="namespacexe.html">xe</a>.W3CDOMRange.END_TO_END = 2;</div><div class="line"><a name="l00881"></a><span class="lineno"><a class="line" href="Xpress__Editor_8js.html#a863e6d0bd8f47ce037b809e457a29c21">  881</a></span>&#160;<a class="code" href="namespacexe.html">xe</a>.W3CDOMRange.END_TO_START = 3;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<a class="code" href="namespacexe.html">xe</a>.XpressRange = $.Class({</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    setWindow : <span class="keyword">function</span>(win){</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        this._window = win;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        this._document = win.document;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    },</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    $init : <span class="keyword">function</span>(win){</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        this.HUSKY_BOOMARK_START_ID_PREFIX = <span class="stringliteral">&quot;xpress_bookmark_start_&quot;</span>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        this.HUSKY_BOOMARK_END_ID_PREFIX = <span class="stringliteral">&quot;xpress_bookmark_end_&quot;</span>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        this.sBlockElement = <span class="stringliteral">&quot;P|DIV|LI|H[1-6]|PRE&quot;</span>;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        this.sBlockContainer = <span class="stringliteral">&quot;BODY|TABLE|TH|TR|TD|UL|OL|BLOCKQUOTE|FORM&quot;</span>;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        this.rxBlockElement = <span class="keyword">new</span> RegExp(<span class="stringliteral">&quot;^(&quot;</span>+this.sBlockElement+<span class="stringliteral">&quot;)$&quot;</span>);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        this.rxBlockContainer = <span class="keyword">new</span> RegExp(<span class="stringliteral">&quot;^(&quot;</span>+this.sBlockContainer+<span class="stringliteral">&quot;)$&quot;</span>)</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        this.rxLineBreaker = <span class="keyword">new</span> RegExp(<span class="stringliteral">&quot;^(&quot;</span>+this.sBlockElement+<span class="stringliteral">&quot;|&quot;</span>+this.sBlockContainer+<span class="stringliteral">&quot;)$&quot;</span>)</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        this.setWindow(win);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        this.oSimpleSelection = <span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.SimpleSelection(this._window);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        this.selectionLoaded = this.oSimpleSelection.selectionLoaded;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        this.$super.$init(this._document);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    },</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    select : <span class="keyword">function</span>(){</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        this.oSimpleSelection.selectRange(<span class="keyword">this</span>);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    },</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    setFromSelection : <span class="keyword">function</span>(iNum){</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        this.setRange(this.oSimpleSelection.getRangeAt(iNum));</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    },</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    setRange : <span class="keyword">function</span>(oW3CRange){</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        this.setStart(oW3CRange.startContainer, oW3CRange.startOffset);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        this.setEnd(oW3CRange.endContainer, oW3CRange.endOffset);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    },</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    setEndNodes : <span class="keyword">function</span>(oSNode, oENode){</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        this.setEndAfter(oENode);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        this.setStartBefore(oSNode);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    },</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    splitTextAtBothEnds : <span class="keyword">function</span>(){</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        this._splitTextEndNodesOfTheRange();</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    },</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    getStartNode : <span class="keyword">function</span>(){</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">if</span>(this.collapsed){</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <span class="keywordflow">if</span>(this.startContainer.nodeType == 3){</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                <span class="keywordflow">if</span>(this.startOffset == 0) <span class="keywordflow">return</span> <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                <span class="keywordflow">if</span>(this.startContainer.nodeValue.length &lt;= <span class="keyword">this</span>.startOffset) <span class="keywordflow">return</span> <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <span class="keywordflow">return</span> this.startContainer;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">if</span>(this.startContainer.nodeType == 3){</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <span class="keywordflow">if</span>(this.startOffset &gt;= this.startContainer.nodeValue.length) <span class="keywordflow">return</span> this._getNextNode(this.startContainer);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            <span class="keywordflow">return</span> this.startContainer;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <span class="keywordflow">if</span>(this.startOffset &gt;= <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(<span class="keyword">this</span>.startContainer).length) <span class="keywordflow">return</span> this._getNextNode(this.startContainer);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(this.startContainer)[this.startOffset];</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    },</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    getEndNode : <span class="keyword">function</span>(){</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">if</span>(this.collapsed) <span class="keywordflow">return</span> this.getStartNode();</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keywordflow">if</span>(this.endContainer.nodeType == 3){</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="keywordflow">if</span>(this.endOffset == 0) <span class="keywordflow">return</span> this._getPrevNode(this.endContainer);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="keywordflow">return</span> this.endContainer;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <span class="keywordflow">if</span>(this.endOffset == 0) <span class="keywordflow">return</span> this._getPrevNode(this.endContainer);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(this.endContainer)[this.endOffset-1];</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    },</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    getNodeAroundRange : <span class="keyword">function</span>(bBefore, bStrict){</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="keywordflow">if</span>(this.collapsed &amp;&amp; this.startContainer &amp;&amp; this.startContainer.nodeType == 3) <span class="keywordflow">return</span> this.startContainer;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="keywordflow">if</span>(!this.collapsed || (this.startContainer &amp;&amp; this.startContainer.nodeType == 3)) <span class="keywordflow">return</span> this.getStartNode();</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        var oBeforeRange, oAfterRange, oResult;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">if</span>(this.startOffset &gt;= <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(<span class="keyword">this</span>.startContainer).length)</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            oAfterRange = this._getNextNode(this.startContainer);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            oAfterRange = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(this.startContainer)[this.startOffset];</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">if</span>(this.endOffset == 0)</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            oBeforeRange = this._getPrevNode(this.endContainer);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            oBeforeRange = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(this.endContainer)[this.endOffset-1];</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordflow">if</span>(bBefore){</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            oResult = oBeforeRange;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="keywordflow">if</span>(!oResult &amp;&amp; !bStrict) oResult = oAfterRange;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            oResult = oAfterRange;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="keywordflow">if</span>(!oResult &amp;&amp; !bStrict) oResult = oBeforeRange;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keywordflow">return</span> oResult;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    },</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    _getXPath : <span class="keyword">function</span>(elNode){</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        var sXPath = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keywordflow">while</span>(elNode &amp;&amp; elNode.nodeType == 1){</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            sXPath = <span class="stringliteral">&quot;/&quot;</span> + elNode.tagName+<span class="stringliteral">&quot;[&quot;</span>+this._getPosIdx4XPath(elNode)+<span class="stringliteral">&quot;]&quot;</span> + sXPath;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            elNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(elNode);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keywordflow">return</span> sXPath;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    },</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    _getPosIdx4XPath : <span class="keyword">function</span>(refNode){</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        var idx = 0;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordflow">for</span>(var node = refNode.previousSibling; node; node = node.previousSibling)</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <span class="keywordflow">if</span>(node.tagName == refNode.tagName) idx++;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="keywordflow">return</span> idx;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    },</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="comment">// this was written specifically for XPath Bookmark and it may not perform correctly for general purposes</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    _evaluateXPath : <span class="keyword">function</span>(sXPath, oDoc){</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        sXPath = sXPath.substring(1, sXPath.length-1);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        var aXPath = sXPath.split(/\<span class="comment">//);</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        var elNode = oDoc.body;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=2; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;aXPath.length &amp;&amp; elNode; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            aXPath[i].match(/([^\[]+)\[(\d+)/i);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            var sTagName = RegExp.$1;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            var nIdx = RegExp.$2;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            var aAllNodes = xe.DOMFix.childNodes(elNode);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            var aNodes = [];</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            var nLength = aAllNodes.length;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            var nCount = 0;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            for(var ii=0; ii&lt;nLength; ii++){</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                if(aAllNodes[ii].tagName == sTagName) aNodes[nCount++] = aAllNodes[ii];</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            }</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <span class="keywordflow">if</span>(aNodes.length &lt; nIdx)</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                elNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                elNode = aNodes[nIdx];</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        }</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="keywordflow">return</span> elNode;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    },</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    _evaluateXPathBookmark : <span class="keyword">function</span>(oBookmark){</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        var sXPath = oBookmark[<span class="stringliteral">&quot;sXPath&quot;</span>];</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        var nTextNodeIdx = oBookmark[<span class="stringliteral">&quot;nTextNodeIdx&quot;</span>];</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        var nOffset = oBookmark[<span class="stringliteral">&quot;nOffset&quot;</span>];</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        var elContainer = this._evaluateXPath(sXPath, this._document);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="keywordflow">if</span>(nTextNodeIdx &gt; -1 &amp;&amp; elContainer){</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            var aChildNodes = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(elContainer);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            var elNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            var nIdx = nTextNodeIdx;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            var nOffsetLeft = nOffset;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            <span class="keywordflow">while</span>((elNode = aChildNodes[nIdx]) &amp;&amp; elNode.nodeType == 3 &amp;&amp; elNode.nodeValue.length &lt; nOffsetLeft){</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                nOffsetLeft -= elNode.nodeValue.length;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                nIdx++;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            }</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            elContainer = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(elContainer)[nIdx];</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            nOffset = nOffsetLeft;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        }</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="keywordflow">if</span>(!elContainer){</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            elContainer = this._document.body;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            nOffset = 0;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        }</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">return</span> {elContainer: elContainer, nOffset: nOffset};</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    },</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">// this was written specifically for XPath Bookmark and it may not perform correctly for general purposes</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    getXPathBookmark : <span class="keyword">function</span>(){</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        var nTextNodeIdx1 = -1;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        var htEndPt1 = {elContainer: this.startContainer, nOffset: this.startOffset};</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        var elNode1 = this.startContainer;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="keywordflow">if</span>(elNode1.nodeType == 3){</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            htEndPt1 = this._getFixedStartTextNode();</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            nTextNodeIdx1 = this._getPosIdx(htEndPt1.elContainer);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            elNode1 = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(elNode1);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        }</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        var sXPathNode1 = this._getXPath(elNode1);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        var oBookmark1 = {sXPath:sXPathNode1, nTextNodeIdx:nTextNodeIdx1, nOffset: htEndPt1.nOffset};</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        var nTextNodeIdx2 = -1;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        var htEndPt2 = {elContainer: this.endContainer, nOffset: this.endOffset};</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        var elNode2 = this.endContainer;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordflow">if</span>(elNode2.nodeType == 3){</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            htEndPt2 = this._getFixedEndTextNode();</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            nTextNodeIdx2 = this._getPosIdx(htEndPt2.elContainer);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            elNode2 = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(elNode2);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        }</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        var sXPathNode2 = this._getXPath(elNode2);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        var oBookmark2 = {sXPath:sXPathNode2, nTextNodeIdx:nTextNodeIdx2, nOffset: htEndPt2.nOffset};</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="keywordflow">return</span> [oBookmark1, oBookmark2];</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    },</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    moveToXPathBookmark : <span class="keyword">function</span>(aBookmark){</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="keywordflow">if</span>(!aBookmark) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        var oBookmarkInfo1 = this._evaluateXPathBookmark(aBookmark[0]);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        var oBookmarkInfo2 = this._evaluateXPathBookmark(aBookmark[1]);</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="keywordflow">if</span>(!oBookmarkInfo1[<span class="stringliteral">&quot;elContainer&quot;</span>] || !oBookmarkInfo2[<span class="stringliteral">&quot;elContainer&quot;</span>]) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        this.startContainer = oBookmarkInfo1[<span class="stringliteral">&quot;elContainer&quot;</span>];</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        this.startOffset = oBookmarkInfo1[<span class="stringliteral">&quot;nOffset&quot;</span>];</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        this.endContainer = oBookmarkInfo2[<span class="stringliteral">&quot;elContainer&quot;</span>];</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        this.endOffset = oBookmarkInfo2[<span class="stringliteral">&quot;nOffset&quot;</span>];</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    },</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    _getFixedTextContainer : <span class="keyword">function</span>(elNode, nOffset){</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keywordflow">while</span>(elNode &amp;&amp; elNode.nodeType == 3 &amp;&amp; elNode.previousSibling &amp;&amp; elNode.previousSibling.nodeType == 3){</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            nOffset += elNode.previousSibling.nodeValue.length;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            elNode = elNode.previousSibling;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="keywordflow">return</span> {elContainer:elNode, nOffset:nOffset};</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    },</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    _getFixedStartTextNode : <span class="keyword">function</span>(){</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <span class="keywordflow">return</span> this._getFixedTextContainer(this.startContainer, this.startOffset);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    },</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    _getFixedEndTextNode : <span class="keyword">function</span>(){</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordflow">return</span> this._getFixedTextContainer(this.endContainer, this.endOffset);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    },</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    placeStringBookmark : <span class="keyword">function</span>(){</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        var sTmpId = (<span class="keyword">new</span> Date()).getTime();</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        var oInsertionPoint = this.cloneRange();</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        oInsertionPoint.collapseToEnd();</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        var oEndMarker = this._document.createElement(<span class="stringliteral">&quot;A&quot;</span>);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        oEndMarker.id = this.HUSKY_BOOMARK_END_ID_PREFIX+sTmpId;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        oInsertionPoint.insertNode(oEndMarker);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        var oInsertionPoint = this.cloneRange();</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        oInsertionPoint.collapseToStart();</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        var oStartMarker = this._document.createElement(<span class="stringliteral">&quot;A&quot;</span>);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        oStartMarker.id = this.HUSKY_BOOMARK_START_ID_PREFIX+sTmpId;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        oInsertionPoint.insertNode(oStartMarker);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        this.moveToBookmark(sTmpId);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">return</span> sTmpId;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    },</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    cloneRange : <span class="keyword">function</span>(){</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="keywordflow">return</span> this._copyRange(<span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.XpressRange(<span class="keyword">this</span>._window));</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    },</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    moveToBookmark : <span class="keyword">function</span>(vBookmark){</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keywordflow">if</span>(typeof(vBookmark) != <span class="stringliteral">&quot;object&quot;</span>)</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            this.moveToStringBookmark(vBookmark);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            this.moveToXPathBookmark(vBookmark);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    },</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    moveToStringBookmark : <span class="keyword">function</span>(sBookmarkID){</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        var oStartMarker = this._document.getElementById(this.HUSKY_BOOMARK_START_ID_PREFIX+sBookmarkID);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        var oEndMarker = this._document.getElementById(this.HUSKY_BOOMARK_END_ID_PREFIX+sBookmarkID);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="keywordflow">if</span>(!oStartMarker || !oEndMarker) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        this.setEndBefore(oEndMarker);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        this.setStartAfter(oStartMarker);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    },</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    removeStringBookmark : <span class="keyword">function</span>(sBookmarkID){</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        var oStartMarker = this._document.getElementById(this.HUSKY_BOOMARK_START_ID_PREFIX+sBookmarkID);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        var oEndMarker = this._document.getElementById(this.HUSKY_BOOMARK_END_ID_PREFIX+sBookmarkID);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="keywordflow">if</span>(oStartMarker) <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oStartMarker).removeChild(oStartMarker);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keywordflow">if</span>(oEndMarker) <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oEndMarker).removeChild(oEndMarker);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    },</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    collapseToStart : <span class="keyword">function</span>(){</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        this.collapse(<span class="keyword">true</span>);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    },</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    collapseToEnd : <span class="keyword">function</span>(){</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        this.collapse(<span class="keyword">false</span>);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    },</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    createAndInsertNode : <span class="keyword">function</span>(sTagName){</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        tmpNode = this._document.createElement(tagName);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        this.insertNode(tmpNode)</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="keywordflow">return</span> tmpNode</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    },</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    getNodes : <span class="keyword">function</span>(bSplitTextEndNodes, fnFilter){</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="keywordflow">if</span>(bSplitTextEndNodes) this._splitTextEndNodesOfTheRange();</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        var aAllNodes = this._getNodesInRange();</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        var aFilteredNodes = [];</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="keywordflow">if</span>(!fnFilter) <span class="keywordflow">return</span> aAllNodes;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;aAllNodes.length; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++)</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            <span class="keywordflow">if</span>(fnFilter(aAllNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>])) aFilteredNodes[aFilteredNodes.length] = aAllNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>];</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">return</span> aFilteredNodes;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    },</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    getTextNodes : <span class="keyword">function</span>(bSplitTextEndNodes){</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        var txtFilter = <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            <span class="keywordflow">if</span> (oNode.nodeType == 3 &amp;&amp; oNode.nodeValue != <span class="stringliteral">&quot;\n&quot;</span> &amp;&amp; oNode.nodeValue != <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        }</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="keywordflow">return</span> this.getNodes(bSplitTextEndNodes, txtFilter);</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    },</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    surroundContentsWithNewNode : <span class="keyword">function</span>(sTagName){</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        var oNewParent = this._document.createElement(sTagName);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        this.surroundContents(oNewParent);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="keywordflow">return</span> oNewParent;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    },</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    isRangeinRange : <span class="keyword">function</span>(oAnoterRange, bIncludePartlySelected){</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        var startToStart = this.compareBoundaryPoints(this.<a class="code" href="Xpress__Editor_8js.html#a2a488ca0c54bef41cd94ae4334fca763">START_TO_START</a>, oAnoterRange);</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        var startToEnd = this.compareBoundaryPoints(this.<a class="code" href="Xpress__Editor_8js.html#af2839fc42e9583ecad27de8c79c94551">START_TO_END</a>, oAnoterRange);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        var endToStart = this.compareBoundaryPoints(this.<a class="code" href="Xpress__Editor_8js.html#a863e6d0bd8f47ce037b809e457a29c21">END_TO_START</a>, oAnoterRange);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        var endToEnd = this.compareBoundaryPoints(this.<a class="code" href="Xpress__Editor_8js.html#a7514998df379a196147db35a4a4da555">END_TO_END</a>, oAnoterRange);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="keywordflow">if</span>(startToStart &lt;= 0 &amp;&amp; endToEnd &gt;= 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordflow">if</span>(bIncludePartlyIncluded){</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            <span class="keywordflow">if</span>(startToEnd == 1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            <span class="keywordflow">if</span>(endToStart == -1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        }</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    },</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    isNodeInRange : <span class="keyword">function</span>(oNode, bIncludePartlySelected, bContentOnly){</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        var oTmpRange = <span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.XpressRange(this._window);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="keywordflow">if</span>(bContentOnly &amp;&amp; oNode.firstChild){</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            oTmpRange.setStartBefore(oNode.firstChild);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            oTmpRange.setEndAfter(oNode.lastChild);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            oTmpRange.selectNode(oNode);</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        }</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">return</span> isRangeInRange(oTmpRange, bIncludePartlySelected);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    },</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    pasteHTML : <span class="keyword">function</span>(sHTML){</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordflow">if</span>(sHTML == <span class="stringliteral">&quot;&quot;</span>){</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            this.deleteContents();</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        }</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        var oTmpDiv = this._document.createElement(<span class="stringliteral">&quot;DIV&quot;</span>);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        oTmpDiv.innerHTML = sHTML;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        var oFirstNode = oTmpDiv.firstChild;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        var oLastNode = oTmpDiv.lastChild;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        var clone = this.cloneRange();</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        var sBM = clone.placeStringBookmark();</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">while</span>(oTmpDiv.lastChild) this.insertNode(oTmpDiv.lastChild);</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        this.setEndNodes(oFirstNode, oLastNode);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="comment">// delete the content later as deleting it first may mass up the insertion point</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="comment">// eg) &lt;p&gt;[A]BCD&lt;/p&gt; ---paste O---&gt; O&lt;p&gt;BCD&lt;/p&gt;</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        clone.moveToBookmark(sBM);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        clone.deleteContents();</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        clone.removeStringBookmark(sBM);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    },</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <a class="code" href="diff__match__patch_8js.html#a5d4c58bc1e0a7de2e75ea206be2cbe94">toString</a> : <span class="keyword">function</span>(){</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        this.<a class="code" href="diff__match__patch_8js.html#a5d4c58bc1e0a7de2e75ea206be2cbe94">toString</a> = <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange.prototype.toString;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keywordflow">return</span> this.<a class="code" href="diff__match__patch_8js.html#a5d4c58bc1e0a7de2e75ea206be2cbe94">toString</a>();</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    },</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    toHTMLString : <span class="keyword">function</span>(){</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        var oTmpContainer = this._document.createElement(<span class="stringliteral">&quot;DIV&quot;</span>);</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        oTmpContainer.appendChild(this.cloneContents());</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <span class="keywordflow">return</span> oTmpContainer.innerHTML;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    },</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    findAncestorByTagName : <span class="keyword">function</span>(sTagName){</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        var oNode = this.commonAncestorContainer;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <span class="keywordflow">while</span>(oNode &amp;&amp; oNode.tagName != sTagName) oNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNode);</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">return</span> oNode;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    },</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    selectNodeContents : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keywordflow">if</span>(!oNode) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        var oFirstNode = oNode.firstChild?oNode.firstChild:oNode;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        var oLastNode = oNode.lastChild?oNode.lastChild:oNode;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordflow">if</span>(oFirstNode.nodeType == 3)</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            this.setStart(oFirstNode, 0);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            this.setStartBefore(oFirstNode);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">if</span>(oLastNode.nodeType == 3)</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            this.setEnd(oLastNode, oLastNode.nodeValue.length);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            this.setEndAfter(oLastNode);</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    },</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    styleRange : <span class="keyword">function</span>(oStyle, oAttribute, sNewSpanMarker){</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        var aStyleParents = this._getStyleParentNodes(sNewSpanMarker);</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <span class="keywordflow">if</span>(aStyleParents.length &lt; 1) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        var sName, sValue;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;aStyleParents.length; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            <span class="keywordflow">for</span>(var <a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a> in oStyle){</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                sName = <a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a>;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                sValue = oStyle[sName];</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                <span class="keywordflow">if</span>(typeof sValue != <span class="stringliteral">&quot;string&quot;</span>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                aStyleParents[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].style[sName] = sValue;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            }</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            <span class="keywordflow">if</span>(!oAttribute) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="keywordflow">for</span>(var <a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a> in oAttribute){</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                sName = <a class="code" href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a>;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                sValue = oAttribute[sName];</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                <span class="keywordflow">if</span>(typeof sValue != <span class="stringliteral">&quot;string&quot;</span>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                <span class="keywordflow">if</span>(sName == <span class="stringliteral">&quot;class&quot;</span>){</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                    $(aStyleParents[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>]).addClass(sValue);</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                    aStyleParents[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].setAttribute(sName, sValue);</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                }</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            }</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        }</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        this.setStartBefore(aStyleParents[0]);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        this.setEndAfter(aStyleParents[aStyleParents.length-1]);</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    },</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    _getStyleParentNodes : <span class="keyword">function</span>(sNewSpanMarker){</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        this._splitTextEndNodesOfTheRange();</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        var oSNode = this.getStartNode();</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        var oENode = this.getEndNode();</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        var aAllNodes = this._getNodesInRange();</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        var aResult = [];</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        var nResult = 0;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        var oNode, oTmpNode, iStartRelPos, iEndRelPos, oSpan, iSIdx, iEIdx, oParentNode;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        var nInitialLength  = aAllNodes.length;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        var arAllBottmNodes = $(aAllNodes).filter(<span class="keyword">function</span>(){ <span class="keywordflow">return</span> !!this.childNodes.length });</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;nInitialLength; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            oNode = aAllNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>];</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            <span class="keywordflow">if</span>(!oNode || oNode.nodeType != 3 || oNode.nodeValue == <span class="stringliteral">&#39;&#39;</span>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            </div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            oParentNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oNode);</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            <span class="keywordflow">if</span>(oParentNode.tagName == <span class="stringliteral">&quot;SPAN&quot;</span>){</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                var parentText = $(oParentNode).<a class="code" href="JSSpec_8js.html#a28141bc89afb42a8f39e596105992271">html</a>();</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                <span class="comment">// check if the SPAN element is fully contained</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                <span class="comment">// do quick checks before trying indexOf() because indexOf() function is very slow</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                oTmpNode = this._getVeryFirstRealChild(oParentNode);</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                <span class="keywordflow">if</span>(oTmpNode == oNode) iSIdx = 1;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                <span class="keywordflow">else</span> iSIdx = parentText.indexOf(oTmpNode);</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                </div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                <span class="keywordflow">if</span>(iSIdx != -1){</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                    oTmpNode = this._getVeryLastRealChild(oParentNode);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                    <span class="keywordflow">if</span>(oTmpNode == oNode) iEIdx = 1;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                    <span class="keywordflow">else</span> iEIdx = parentText.indexOf(oTmpNode);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                }</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                <span class="keywordflow">if</span>(iSIdx != -1 &amp;&amp; iEIdx != -1){</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                    aResult[nResult++] = oParentNode;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                }</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;            oSpan = this._document.createElement(<span class="stringliteral">&quot;SPAN&quot;</span>);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            oParentNode.insertBefore(oSpan, oNode);</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            oSpan.appendChild(oNode);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            aResult[nResult++] = oSpan;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            <span class="keywordflow">if</span>(sNewSpanMarker) oSpan.setAttribute(sNewSpanMarker, <span class="stringliteral">&quot;true&quot;</span>);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        this.setStartBefore(oSNode);</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        this.setEndAfter(oENode);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <span class="keywordflow">return</span> aResult;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    },</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    _getVeryFirstChild : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        <span class="keywordflow">if</span>(oNode.firstChild) <span class="keywordflow">return</span> this._getVeryFirstChild(oNode.firstChild);</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="keywordflow">return</span> oNode;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    },</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    _getVeryLastChild : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="keywordflow">if</span>(oNode.lastChild) <span class="keywordflow">return</span> this._getVeryLastChild(oNode.lastChild);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <span class="keywordflow">return</span> oNode;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    },</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    _getFirstRealChild : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        var oFirstNode = oNode.firstChild;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="keywordflow">while</span>(oFirstNode &amp;&amp; oFirstNode.nodeType == 3 &amp;&amp; oFirstNode.nodeValue == <span class="stringliteral">&quot;&quot;</span>) oFirstNode = oFirstNode.nextSibling;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">return</span> oFirstNode;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    },</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    _getLastRealChild : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        var oLastNode = oNode.lastChild;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <span class="keywordflow">while</span>(oLastNode &amp;&amp; oLastNode.nodeType == 3 &amp;&amp; oLastNode.nodeValue == <span class="stringliteral">&quot;&quot;</span>) oLastNode = oLastNode.previousSibling;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <span class="keywordflow">return</span> oLastNode;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    },</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    _getVeryFirstRealChild : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        var oFirstNode = this._getFirstRealChild(oNode);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="keywordflow">if</span>(oFirstNode) <span class="keywordflow">return</span> this._getVeryFirstRealChild(oFirstNode);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <span class="keywordflow">return</span> oNode;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    },</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    _getVeryLastRealChild : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        var oLastNode = this._getLastRealChild(oNode);</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="keywordflow">if</span>(oLastNode) <span class="keywordflow">return</span> this._getVeryLastChild(oLastNode);</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <span class="keywordflow">return</span> oNode;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    },</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    _getLineStartInfo : <span class="keyword">function</span>(node){</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        var frontEndFinal = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        var frontEnd = node;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        var lineBreaker = node;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        var bParentBreak = <span class="keyword">true</span>;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        var rxLineBreaker = this.rxLineBreaker;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="comment">// vertical(parent) search</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="keyword">function</span> getLineStart(node){</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <span class="keywordflow">if</span>(!node) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            <span class="keywordflow">if</span>(frontEndFinal) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            <span class="keywordflow">if</span>(rxLineBreaker.test(node.tagName)){</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                lineBreaker = node;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                frontEndFinal = frontEnd;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                bParentBreak = <span class="keyword">true</span>;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                frontEnd = node;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            }</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            getFrontEnd(node.previousSibling);</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;            <span class="keywordflow">if</span>(frontEndFinal) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            getLineStart(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(node));</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        }</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="comment">// horizontal(sibling) search</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <span class="keyword">function</span> getFrontEnd(node){</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            <span class="keywordflow">if</span>(!node) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            <span class="keywordflow">if</span>(frontEndFinal) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            <span class="keywordflow">if</span>(rxLineBreaker.test(node.tagName)){</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                lineBreaker = node;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                frontEndFinal = frontEnd;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                bParentBreak = <span class="keyword">false</span>;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            }</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            <span class="keywordflow">if</span>(node.firstChild &amp;&amp; node.tagName != <span class="stringliteral">&quot;TABLE&quot;</span>){</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                var curNode = node.lastChild;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                <span class="keywordflow">while</span>(curNode &amp;&amp; !frontEndFinal){</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                    getFrontEnd(curNode);</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                    curNode = curNode.previousSibling;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                }</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                frontEnd = node;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            }</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            <span class="keywordflow">if</span>(!frontEndFinal){</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                getFrontEnd(node.previousSibling);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            }</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        }</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        getLineStart(node);</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <span class="keywordflow">return</span> {oNode: frontEndFinal, oLineBreaker: lineBreaker, bParentBreak: bParentBreak};</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    },</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    _getLineEndInfo : <span class="keyword">function</span>(node){</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        var backEndFinal = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        var backEnd = node;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        var lineBreaker = node;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        var bParentBreak = <span class="keyword">true</span>;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        var rxLineBreaker = this.rxLineBreaker;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="comment">// vertical(parent) search</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="keyword">function</span> getLineEnd(node){</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            <span class="keywordflow">if</span>(!node) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            <span class="keywordflow">if</span>(backEndFinal) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            <span class="keywordflow">if</span>(rxLineBreaker.test(node.tagName)){</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                lineBreaker = node;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                backEndFinal = backEnd;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                bParentBreak = <span class="keyword">true</span>;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                backEnd = node;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            }</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            getBackEnd(node.nextSibling);</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            <span class="keywordflow">if</span>(backEndFinal) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            getLineEnd(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(node));</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        }</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <span class="comment">// horizontal(sibling) search</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <span class="keyword">function</span> getBackEnd(node){</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            <span class="keywordflow">if</span>(!node) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            <span class="keywordflow">if</span>(backEndFinal) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            <span class="keywordflow">if</span>(rxLineBreaker.test(node.tagName)){</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                lineBreaker = node;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                backEndFinal = backEnd;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                bParentBreak = <span class="keyword">false</span>;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            }</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            <span class="keywordflow">if</span>(node.firstChild &amp;&amp; node.tagName != <span class="stringliteral">&quot;TABLE&quot;</span>){</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                var curNode = node.firstChild;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                <span class="keywordflow">while</span>(curNode &amp;&amp; !backEndFinal){</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                    getBackEnd(curNode);</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                    curNode = curNode.nextSibling;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                }</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                backEnd = node;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            }</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            <span class="keywordflow">if</span>(!backEndFinal){</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                getBackEnd(node.nextSibling);</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            }</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        }</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        getLineEnd(node);</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keywordflow">return</span> {oNode: backEndFinal, oLineBreaker: lineBreaker, bParentBreak: bParentBreak};</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    },</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    getLineInfo : <span class="keyword">function</span>(){</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        var oSNode = this.getStartNode();</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        var oENode = this.getEndNode();</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <span class="comment">// the range is currently collapsed</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <span class="keywordflow">if</span>(!oSNode) oSNode = this.getNodeAroundRange(<span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        <span class="keywordflow">if</span>(!oENode) oENode = this.getNodeAroundRange(<span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        var oStart = this._getLineStartInfo(oSNode);</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        var oStartNode = oStart.oNode;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        var oEnd = this._getLineEndInfo(oENode);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        var oEndNode = oEnd.oNode;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        var iRelativeStartPos = this._compareEndPoint(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oStartNode), this._getPosIdx(oStartNode), this.endContainer, this.endOffset);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        var iRelativeEndPos = this._compareEndPoint(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oEndNode), this._getPosIdx(oEndNode)+1, this.startContainer, this.startOffset);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        <span class="keywordflow">if</span>(!(iRelativeStartPos &lt;= 0 &amp;&amp; iRelativeEndPos &gt;= 0)){</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            oSNode = this.getNodeAroundRange(<span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            oENode = this.getNodeAroundRange(<span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            oStart = this._getLineStartInfo(oSNode);</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;            oEnd = this._getLineEndInfo(oENode);</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        }</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        <span class="keywordflow">return</span> {oStart: oStart, oEnd: oEnd};</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    }</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;}).<a class="code" href="jquery_8js.html#a84ade6b4c0a71f54664069487f2526dc">extend</a>(<a class="code" href="namespacexe.html">xe</a>.W3CDOMRange);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<a class="code" href="namespacexe.html">xe</a>.SimpleSelection = <span class="keyword">function</span>(win){</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    this.<a class="code" href="jquery-1_8x_8js.html#a4411a3d16c33c71210302860f22ba789">init</a> = <span class="keyword">function</span>(win){</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        this._window = win || <a class="code" href="jquery-1_8x_8js.html#ad55530ae1e5978df8e721017c1fc8466">window</a>;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        this._document = this._window.document;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    };</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    this.<a class="code" href="jquery-1_8x_8js.html#a4411a3d16c33c71210302860f22ba789">init</a>(win);</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">if</span>($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie)</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        <a class="code" href="namespacexe.html">xe</a>.SimpleSelectionImpl_IE.apply(<span class="keyword">this</span>);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        <a class="code" href="namespacexe.html">xe</a>.SimpleSelectionImpl_FF.apply(<span class="keyword">this</span>);</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    this.selectRange = <span class="keyword">function</span>(oRng){</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        this.selectNone();</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        this.addRange(oRng);</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    };</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    this.selectionLoaded = <span class="keyword">true</span>;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="keywordflow">if</span>(!this._oSelection) this.selectionLoaded = <span class="keyword">false</span>;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;};</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<a class="code" href="namespacexe.html">xe</a>.SimpleSelectionImpl_FF = <span class="keyword">function</span>(){</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    this._oSelection = this._window.getSelection();</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    this.getRangeAt = <span class="keyword">function</span>(iNum){</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        iNum = iNum || 0;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <span class="keywordflow">try</span>{</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            var oFFRange = this._oSelection.getRangeAt(iNum);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        }<span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){<span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange(this._document);}</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="keywordflow">return</span> this._FFRange2W3CRange(oFFRange);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    };</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    this.addRange = <span class="keyword">function</span>(oW3CRange){</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        var oFFRange = this._W3CRange2FFRange(oW3CRange);</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        this._oSelection.addRange(oFFRange);</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    };</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    this.selectNone = <span class="keyword">function</span>(){</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        this._oSelection.removeAllRanges();</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    };</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    this._FFRange2W3CRange = <span class="keyword">function</span>(oFFRange){</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        var oW3CRange = <span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange(this._document);</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        oW3CRange.setStart(oFFRange.startContainer, oFFRange.startOffset);</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        oW3CRange.setEnd(oFFRange.endContainer, oFFRange.endOffset);</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        <span class="keywordflow">return</span> oW3CRange;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    };</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    this._W3CRange2FFRange = <span class="keyword">function</span>(oW3CRange){</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        var oFFRange = this._document.createRange();</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        oFFRange.setStart(oW3CRange.startContainer, oW3CRange.startOffset);</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        oFFRange.setEnd(oW3CRange.endContainer, oW3CRange.endOffset);</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        <span class="keywordflow">return</span> oFFRange;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    };</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;};</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<a class="code" href="namespacexe.html">xe</a>.SimpleSelectionImpl_IE = <span class="keyword">function</span>(){</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    this._oSelection = this._document.selection;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    this.getRangeAt = <span class="keyword">function</span>(iNum){</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        iNum = iNum || 0;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="keywordflow">if</span>(this._oSelection.type == <span class="stringliteral">&quot;Control&quot;</span>){</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            var oW3CRange = <span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange(this._document);</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            var oSelectedNode = this._oSelection.createRange().item(iNum);</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;            <span class="comment">// if the selction occurs in a different document, ignore</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            <span class="keywordflow">if</span>(!oSelectedNode || oSelectedNode.ownerDocument != <span class="keyword">this</span>._document) <span class="keywordflow">return</span> oW3CRange;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            oW3CRange.selectNode(oSelectedNode);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;            <span class="keywordflow">return</span> oW3CRange;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            var oSelectedNode = this._oSelection.createRangeCollection().item(iNum).parentElement();</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            <span class="comment">// if the selction occurs in a different document, ignore</span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            <span class="keywordflow">if</span>(!oSelectedNode || oSelectedNode.ownerDocument != <span class="keyword">this</span>._document){</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                var oW3CRange = <span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange(this._document);</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                <span class="keywordflow">return</span> oW3CRange;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            }</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;            <span class="keywordflow">return</span> this._IERange2W3CRange(this._oSelection.createRangeCollection().item(iNum));</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        }</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    };</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    this.addRange = <span class="keyword">function</span>(oW3CRange){</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        var oIERange = this._W3CRange2IERange(oW3CRange);</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        oIERange.select();</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    };</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    this.selectNone = <span class="keyword">function</span>(){</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        this._oSelection.empty();</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    };</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    this._W3CRange2IERange = <span class="keyword">function</span>(oW3CRange){</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        var oStartIERange = this._getIERangeAt(oW3CRange.startContainer, oW3CRange.startOffset);</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        var oEndIERange = this._getIERangeAt(oW3CRange.endContainer, oW3CRange.endOffset);</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        oStartIERange.setEndPoint(<span class="stringliteral">&quot;EndToEnd&quot;</span>, oEndIERange);</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="keywordflow">return</span> oStartIERange;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    };</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    this._getIERangeAt = <span class="keyword">function</span>(oW3CContainer, iW3COffset){</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        var oIERange = this._document.body.createTextRange();</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        var oEndPointInfoForIERange = this._getSelectableNodeAndOffsetForIE(oW3CContainer, iW3COffset);</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        var oSelectableNode = oEndPointInfoForIERange.oSelectableNodeForIE;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        var iIEOffset = oEndPointInfoForIERange.iOffsetForIE;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        oIERange.moveToElementText(oSelectableNode);</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        oIERange.collapse(oEndPointInfoForIERange.bCollapseToStart);</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        oIERange.moveStart(<span class="stringliteral">&quot;character&quot;</span>, iIEOffset);</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keywordflow">return</span> oIERange;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    };</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    this._getSelectableNodeAndOffsetForIE = <span class="keyword">function</span>(oW3CContainer, iW3COffset){</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        var oIERange = this._document.body.createTextRange();</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        var oNonTextNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        var aChildNodes =  <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        var iNumOfLeftNodesToCount = 0;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="keywordflow">if</span>(oW3CContainer.nodeType == 3){</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            oNonTextNode = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(oW3CContainer);</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            aChildNodes = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(oNonTextNode);</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            iNumOfLeftNodesToCount = aChildNodes.length;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            oNonTextNode = oW3CContainer;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            aChildNodes = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(oNonTextNode);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            iNumOfLeftNodesToCount = iW3COffset;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        }</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        var oNodeTester = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        var iResultOffset = 0;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        var bCollapseToStart = <span class="keyword">true</span>;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;iNumOfLeftNodesToCount; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            oNodeTester = aChildNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>];</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            <span class="keywordflow">if</span>(oNodeTester.nodeType == 3){</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                <span class="keywordflow">if</span>(oNodeTester == oW3CContainer) <span class="keywordflow">break</span>;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                iResultOffset += oNodeTester.nodeValue.length;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                oIERange.moveToElementText(oNodeTester);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                oNonTextNode = oNodeTester;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                iResultOffset = 0;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                bCollapseToStart = <span class="keyword">false</span>;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;            }</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        }</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <span class="keywordflow">if</span>(oW3CContainer.nodeType == 3) iResultOffset += iW3COffset;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <span class="keywordflow">return</span> {oSelectableNodeForIE:oNonTextNode, iOffsetForIE: iResultOffset, bCollapseToStart: bCollapseToStart};</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    };</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    this._IERange2W3CRange = <span class="keyword">function</span>(oIERange){</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        var oW3CRange = <span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.W3CDOMRange(this._document);</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        var oIEPointRange = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        var oPosition = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        oIEPointRange = oIERange.duplicate();</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        oIEPointRange.collapse(<span class="keyword">true</span>);</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        oPosition = this._getW3CContainerAndOffset(oIEPointRange, <span class="keyword">true</span>);</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        oW3CRange.setStart(oPosition.oContainer, oPosition.iOffset);</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        var oCollapsedChecker = oIERange.duplicate();</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        oCollapsedChecker.collapse(<span class="keyword">true</span>);</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <span class="keywordflow">if</span>(oCollapsedChecker.isEqual(oIERange)){</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            oW3CRange.collapse(<span class="keyword">true</span>);</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            oIEPointRange = oIERange.duplicate();</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            oIEPointRange.collapse(<span class="keyword">false</span>);</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            oPosition = this._getW3CContainerAndOffset(oIEPointRange);</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            oW3CRange.setEnd(oPosition.oContainer, oPosition.iOffset);</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        }</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        <span class="keywordflow">return</span> oW3CRange;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    };</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    this._getW3CContainerAndOffset = <span class="keyword">function</span>(oIEPointRange, bStartPt){</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        var oRgOrigPoint = oIEPointRange;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        var oContainer = oRgOrigPoint.parentElement();</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        var <a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a> = -1;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        var oRgTester = this._document.body.createTextRange();</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        var aChildNodes = <a class="code" href="namespacexe.html">xe</a>.DOMFix.childNodes(oContainer);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        var oPrevNonTextNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        var pointRangeIdx = 0;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0;<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;aChildNodes.length;<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;            <span class="keywordflow">if</span>(aChildNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].nodeType == 3) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            oRgTester.moveToElementText(aChildNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>]);</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="keywordflow">if</span>(oRgTester.compareEndPoints(<span class="stringliteral">&quot;StartToStart&quot;</span>, oIEPointRange)&gt;=0) <span class="keywordflow">break</span>;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            oPrevNonTextNode = aChildNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>];</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        }</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        var pointRangeIdx = <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        <span class="keywordflow">if</span>(pointRangeIdx != 0 &amp;&amp; aChildNodes[pointRangeIdx-1].nodeType == 3){</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            var oRgTextStart = this._document.body.createTextRange();</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            var oCurTextNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            <span class="keywordflow">if</span>(oPrevNonTextNode){</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                oRgTextStart.moveToElementText(oPrevNonTextNode);</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                oRgTextStart.collapse(<span class="keyword">false</span>);</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                oCurTextNode = oPrevNonTextNode.nextSibling;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                oRgTextStart.moveToElementText(oContainer);</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                oRgTextStart.collapse(<span class="keyword">true</span>);</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                oCurTextNode = oContainer.firstChild;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            }</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            var oRgTextsUpToThePoint = oRgOrigPoint.duplicate();</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            oRgTextsUpToThePoint.setEndPoint(<span class="stringliteral">&quot;StartToStart&quot;</span>, oRgTextStart);</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            var textCount = oRgTextsUpToThePoint.text.length</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            <span class="keywordflow">while</span>(textCount &gt; oCurTextNode.nodeValue.length &amp;&amp; oCurTextNode.nextSibling){</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                textCount -= oCurTextNode.nodeValue.length;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                oCurTextNode = oCurTextNode.nextSibling;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            }</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            <span class="comment">// this will enforce IE to re-reference oCurTextNode</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            var oTmp = oCurTextNode.nodeValue;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <span class="keywordflow">if</span>(bStartPt &amp;&amp; oCurTextNode.nextSibling &amp;&amp; oCurTextNode.nextSibling.nodeType == 3 &amp;&amp; textCount == oCurTextNode.nodeValue.length){</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                textCount -= oCurTextNode.nodeValue.length;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                oCurTextNode = oCurTextNode.nextSibling;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            }</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            oContainer = oCurTextNode;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            offset = textCount;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            oContainer = oRgOrigPoint.parentElement();</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            offset = pointRangeIdx;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        }</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        <span class="keywordflow">return</span> {<span class="stringliteral">&quot;oContainer&quot;</span> : oContainer, <span class="stringliteral">&quot;iOffset&quot;</span> : offset};</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    };</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;}</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<a class="code" href="namespacexe.html">xe</a>.DOMFix = <span class="keyword">new</span> ($.Class({</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    $init : <span class="keyword">function</span>(){</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <span class="keywordflow">if</span>($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie || $.browser.opera){</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            this.childNodes = this._childNodes_Fix;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            this.parentNode = this._parentNode_Fix;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            this.childNodes = this._childNodes_Native;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            this.parentNode = this._parentNode_Native;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        }</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    },</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    _parentNode_Native : <span class="keyword">function</span>(elNode){</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        <span class="keywordflow">return</span> elNode.parentNode;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    },</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    _parentNode_Fix : <span class="keyword">function</span>(elNode){</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        <span class="keywordflow">if</span>(!elNode) <span class="keywordflow">return</span> elNode;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <span class="keywordflow">while</span>(elNode.previousSibling){elNode = elNode.previousSibling;}</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        <span class="keywordflow">return</span> elNode.parentNode;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    },</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    _childNodes_Native : <span class="keyword">function</span>(elNode){</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <span class="keywordflow">return</span> elNode.childNodes;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    },</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    _childNodes_Fix : <span class="keyword">function</span>(elNode){</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        var aResult = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        var nCount = 0;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <span class="keywordflow">if</span>(elNode){</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;            var aResult = [];</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            elNode = elNode.firstChild;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            <span class="keywordflow">while</span>(elNode){</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                aResult[nCount++] = elNode;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                elNode=elNode.nextSibling;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            }</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        }</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <span class="keywordflow">return</span> aResult;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    }</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;}))();</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<a class="code" href="namespacexe.html">xe</a>.DraggableLayer = $.Class({</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    $init : <span class="keyword">function</span>(oLayer, oOptions){</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        this.oOptions = $.extend({</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;            bModal : <span class="stringliteral">&quot;false&quot;</span>,</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            oHandle : oLayer,</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;            iMinX : -999999,</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;            iMinY : -999999,</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            iMaxX : 999999,</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;            iMaxY : 999999</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        }, oOptions);</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        this.oHandle = this.oOptions.oHandle;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        oLayer.style.display = <span class="stringliteral">&quot;block&quot;</span>;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        oLayer.style.position = <span class="stringliteral">&quot;absolute&quot;</span>;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        oLayer.style.zIndex = <span class="stringliteral">&quot;9999&quot;</span>;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        this.aBasePosition = this.getBaseOffset(oLayer);</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="comment">// &quot;number-ize&quot; the position and set it as inline style. (the position could&#39;ve been set as &quot;auto&quot; or set  by css, not inline style)</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        oLayer.style.top = (this.toInt($(oLayer).<a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a>().top) - this.aBasePosition.top)+<span class="stringliteral">&quot;px&quot;</span>;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        oLayer.style.left = (this.toInt($(oLayer).<a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a>().left) - this.aBasePosition.left)+<span class="stringliteral">&quot;px&quot;</span>;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        this.$FnMouseDown = $.fnBind(this._mousedown, <span class="keyword">this</span>, oLayer);</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        this.$FnMouseMove = $.fnBind(this._mousemove, <span class="keyword">this</span>, oLayer);</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        this.$FnMouseUp = $.fnBind(this._mouseup, <span class="keyword">this</span>, oLayer);</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        $(this.oHandle).bind(<span class="stringliteral">&quot;mousedown&quot;</span>, this.$FnMouseDown);</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    },</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    _mousedown : <span class="keyword">function</span>(oLayer, oEvent){</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keywordflow">if</span>(oEvent.target.tagName == <span class="stringliteral">&quot;INPUT&quot;</span>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        this.MouseOffsetY = (oEvent.pageY-this.toInt(oLayer.style.top)-this.aBasePosition[<span class="stringliteral">&#39;top&#39;</span>]);</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        this.MouseOffsetX = (oEvent.pageX-this.toInt(oLayer.style.left)-this.aBasePosition[<span class="stringliteral">&#39;left&#39;</span>]);</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        $(oLayer).bind(<span class="stringliteral">&quot;mousemove&quot;</span>, this.$FnMouseMove);</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        $(oLayer).bind(<span class="stringliteral">&quot;mouseup&quot;</span>, this.$FnMouseUp);</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    },</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    _mousemove : <span class="keyword">function</span>(oLayer, oEvent){</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        var iTop = (oEvent.pageY-this.MouseOffsetY-this.aBasePosition[<span class="stringliteral">&#39;top&#39;</span>]);</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        var iLeft = (oEvent.pageX-this.MouseOffsetX-this.aBasePosition[<span class="stringliteral">&#39;left&#39;</span>]);</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <span class="keywordflow">if</span>(iTop&lt;this.oOptions.iMinY) iTop = this.oOptions.iMinY;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="keywordflow">if</span>(iTop&gt;this.oOptions.iMaxY) iTop = this.oOptions.iMaxY;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        <span class="keywordflow">if</span>(iLeft&lt;this.oOptions.iMinX) iLeft = this.oOptions.iMinX;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <span class="keywordflow">if</span>(iLeft&gt;this.oOptions.iMaxX) iLeft = this.oOptions.iMaxX;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        oLayer.style.top = iTop + <span class="stringliteral">&quot;px&quot;</span>;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        oLayer.style.left = iLeft + <span class="stringliteral">&quot;px&quot;</span>;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    },</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    _mouseup : <span class="keyword">function</span>(oLayer, oEvent){</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        $(oLayer).unbind(<span class="stringliteral">&quot;mousemove&quot;</span>, this.$FnMouseMove);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        $(oLayer).unbind(<span class="stringliteral">&quot;mouseup&quot;</span>, this.$FnMouseUp);</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    },</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    toInt : <span class="keyword">function</span>(num){</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        var result = parseInt(num);</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        <span class="keywordflow">return</span> result || 0;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    },</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    findNonStatic : <span class="keyword">function</span>(oEl){</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <span class="keywordflow">if</span>(!oEl) <span class="keywordflow">return</span> <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <span class="keywordflow">if</span>(oEl.tagName == <span class="stringliteral">&quot;BODY&quot;</span>) <span class="keywordflow">return</span> oEl;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="keywordflow">if</span>($(oEl).css(<span class="stringliteral">&quot;position&quot;</span>).match(/absolute|relative/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>)) <span class="keywordflow">return</span> oEl;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="keywordflow">return</span> this.findNonStatic(oEl.offsetParent);</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    },</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    getBaseOffset : <span class="keyword">function</span>(oEl){</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        var oBase = this.findNonStatic(oEl.offsetParent);</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        var tmp = $(oBase).<a class="code" href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a>();</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="keywordflow">return</span> {top: tmp.top, left: tmp.left};</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    }</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;});</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.CorePlugin = $.Class({</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;CorePlugin&quot;</span>,</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    $init : <span class="keyword">function</span>(funcOnReady){</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        this.funcOnReady = funcOnReady;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    },</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    $AFTER_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;EXEC_ON_READY_FUNCTION&quot;</span>, []);</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    },</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    $ON_ADD_APP_PROPERTY : <span class="keyword">function</span>(sPropertyName, oProperty){</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        this.oApp[sPropertyName] = oProperty;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    },</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    $ON_REGISTER_BROWSER_EVENT : <span class="keyword">function</span>(obj, sEvent, sCMD, aParams, nDelay){</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        this.oApp.registerBrowserEvent(obj, sEvent, sCMD, aParams, nDelay);</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    },</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    $ON_DISABLE_COMMAND : <span class="keyword">function</span>(sCommand){</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        this.oApp.disableCommand(sCommand, <span class="keyword">true</span>);</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    },</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    $ON_ENABLE_COMMAND : <span class="keyword">function</span>(sCommand){</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        this.oApp.disableCommand(sCommand, <span class="keyword">false</span>);</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    },</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    $ON_EXEC_ON_READY_FUNCTION : <span class="keyword">function</span>(){</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        <span class="keywordflow">if</span>(typeof this.funcOnReady == <span class="stringliteral">&quot;function&quot;</span>) this.funcOnReady();</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    }</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;});</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment"></span> <a class="code" href="namespacexe.html">xe</a>.Utils = $.Class({</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;Utils&quot;</span>,</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    $init : <span class="keyword">function</span>(){</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        <span class="keywordflow">if</span>($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie &amp;&amp; $.browser.nVersion == 6){</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;            <span class="keywordflow">try</span>{</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                <a class="code" href="classdocument.html">document</a>.execCommand(<span class="stringliteral">&#39;BackgroundImageCache&#39;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;            }<span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){}</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        }</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    },</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    $ON_ATTACH_HOVER_EVENTS : <span class="keyword">function</span>(aElms, sHoverClass){</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        sHoverClass = sHoverClass || <span class="stringliteral">&quot;hover&quot;</span>;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        <span class="keywordflow">if</span>(!aElms) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        $(aElms).hover(</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;            <span class="keyword">function</span>(){$(<span class="keyword">this</span>).addClass(sHoverClass)},</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;            <span class="keyword">function</span>(){$(<span class="keyword">this</span>).removeClass(sHoverClass)}</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        );</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    }</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;});</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XpressRangeManager = $.Class({</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XpressRangeManager&quot;</span>,</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    oWindow : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    $init : <span class="keyword">function</span>(win){</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        this.oWindow = win || <a class="code" href="jquery-1_8x_8js.html#ad55530ae1e5978df8e721017c1fc8466">window</a>;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    },</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    $BEFORE_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        <span class="keywordflow">if</span>(this.oWindow &amp;&amp; this.oWindow.tagName == <span class="stringliteral">&quot;IFRAME&quot;</span>)</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;            this.oWindow = this.oWindow.contentWindow;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;getSelection&quot;</span>, $.fnBind(this.<a class="code" href="xpresseditor_8min_8js.html#a35285773512637248aba162f229c8949">getSelection</a>, <span class="keyword">this</span>)]);</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;getEmptySelection&quot;</span>, $.fnBind(this.getEmptySelection, <span class="keyword">this</span>)]);</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    },</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    $ON_SET_EDITING_WINDOW : <span class="keyword">function</span>(oWindow){</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        this.oWindow = oWindow;</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    },</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    getEmptySelection : <span class="keyword">function</span>(){</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        var oXpressRange = <span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.XpressRange(this.oWindow);</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        <span class="keywordflow">return</span> oXpressRange;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    },</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <a class="code" href="xpresseditor_8min_8js.html#a35285773512637248aba162f229c8949">getSelection</a> : <span class="keyword">function</span>(){</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RESTORE_IE_SELECTION&quot;</span>, []);</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        var oXpressRange = this.getEmptySelection();</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <span class="comment">// this may throw an exception if the selected is area is not yet shown</span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="keywordflow">try</span>{</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            oXpressRange.setFromSelection();</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        }<span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){}</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        <span class="keywordflow">return</span> oXpressRange;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    }</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;});</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<a class="code" href="namespacexe.html">xe</a>.Hotkey = $.Class({</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;Hotkey&quot;</span>,</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    storage : {},</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    keyhash : {},</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    $init : <span class="keyword">function</span>(){</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        this.storage = {};</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        this.keyhash = {</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            backspace : 8,</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            tab       : 9,</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;            enter     : 13,</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;            shift    : 16,</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            ctrl      : 17,</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            alt    : 18,</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;            meta      : 224,</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            esc       : 27,</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            space     : 32,</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            pageup    : 33,</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;            pagedown  : 34,</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            end       : 35,</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            home      : 36,</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;            left      : 37,</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            up        : 38,</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            right     : 39,</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            down      : 40,</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            del       : 46,</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            comma     : 188,<span class="comment">//(,)</span></div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            period    : 190,<span class="comment">//(.)</span></div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            slash     : 191,<span class="comment">//(/)</span></div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            hyphen  : 109,</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            equal    : 61</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        };</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        <span class="keywordflow">if</span> ($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie || $.browser.safari) {</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            this.keyhash.hyphen = 189; <span class="comment">// (-)</span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            this.keyhash.equal = 187;  <span class="comment">// (=)</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            this.keyhash.meta  = 91;   <span class="comment">// meta</span></div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        }</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    },</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        $(this.oApp.getWYSIWYGDocument() || <a class="code" href="html5_8js.html#aa14f8e0338cced6720590fd2ea13bd4b">document</a>).keydown($.fnBind(this.keydown, <span class="keyword">this</span>));</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    },</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    $ON_REGISTER_HOTKEY : <span class="keyword">function</span>(sHotkey, sCMD, sArgs){</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        <span class="keywordflow">if</span>(!sArgs) sArgs = [];</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        var func = $.fnBind(this.oApp.exec, <span class="keyword">this</span>.oApp, sCMD, sArgs);</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        sHotkey = this.normalize(sHotkey);</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        <span class="keywordflow">if</span> (!sHotkey) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        this.<a class="code" href="jquery-1_8x_8js.html#a638fd10c6d2f5e258459b1abfa3b94ea">add</a>(sHotkey, func);</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    },</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <a class="code" href="jquery-1_8x_8js.html#a638fd10c6d2f5e258459b1abfa3b94ea">add</a> : <span class="keyword">function</span>(sHotkey, func) {</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        <span class="keywordflow">if</span> (typeof this.storage[sHotkey] == <span class="stringliteral">&#39;undefined&#39;</span>) {</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;            this.storage[sHotkey] = [func];</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            this.storage[sHotkey].push(func);</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        }</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    },</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    keydown : <span class="keyword">function</span>(event) {</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;        var key  = [], kh = this.keyhash;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        <span class="keywordflow">if</span> ($.inArray(event.keyCode, [kh.shift, kh.ctrl, kh.alt, kh.meta]) &gt;= 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        <span class="keywordflow">if</span> (event.shiftKey) key.push(<span class="stringliteral">&#39;shift&#39;</span>);</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        <span class="keywordflow">if</span> (event.altKey)   key.push(<span class="stringliteral">&#39;alt&#39;</span>);</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        <span class="keywordflow">if</span> (event.ctrlKey)  key.push(<span class="stringliteral">&#39;ctrl&#39;</span>);</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        <span class="keywordflow">if</span> (event.metaKey)  key.push(<span class="stringliteral">&#39;meta&#39;</span>);</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        <span class="keywordflow">if</span> (!key.length) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;        <span class="keywordflow">if</span> (key.length == 1 &amp;&amp; event.metaKey) key = [<span class="stringliteral">&#39;ctrl&#39;</span>, <span class="stringliteral">&#39;meta&#39;</span>];</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        key.push(event.keyCode);</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        key = key.join(<span class="charliteral">&#39;+&#39;</span>);</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        <span class="keywordflow">if</span> (!this.storage[key]) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        $.each(this.storage[key], <span class="keyword">function</span>(){ <span class="keyword">this</span>(); });</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    },</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    normalize : <span class="keyword">function</span>(sHotkey) {</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        var shift, ctrl, alt, meta, key, keys = (sHotkey||<span class="stringliteral">&quot;&quot;</span>).toLowerCase().split(<span class="charliteral">&#39;+&#39;</span>);</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        shift = ctrl = alt = meta = key = <span class="keyword">false</span>;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        $.each(keys, <span class="keyword">function</span>(){</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            var <a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a> = <span class="stringliteral">&quot;&quot;</span>+<span class="keyword">this</span>;</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            <span class="keywordflow">switch</span>(s) {</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;shift&#39;</span>: shift = <span class="keyword">true</span>;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;alt&#39;</span>  : alt   = <span class="keyword">true</span>;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;ctrl&#39;</span> : ctrl  = <span class="keyword">true</span>;</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;meta&#39;</span> : meta  = <span class="keyword">true</span>;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                <span class="keywordflow">default</span>:</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                    key = <a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            }</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        });</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        <span class="keywordflow">if</span> (!key) <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        keys = [];</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        <span class="keywordflow">if</span> (shift) keys.push(<span class="stringliteral">&#39;shift&#39;</span>);</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        <span class="keywordflow">if</span> (alt) keys.push(<span class="stringliteral">&#39;alt&#39;</span>);</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <span class="keywordflow">if</span> (ctrl) keys.push(<span class="stringliteral">&#39;ctrl&#39;</span>);</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <span class="keywordflow">if</span> (meta || (ctrl &amp;&amp; !shift &amp;&amp; !alt)) keys.push(<span class="stringliteral">&#39;meta&#39;</span>);</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        keys.push(this.keyhash[key] || key.toUpperCase().charCodeAt(0));</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <span class="keywordflow">return</span> keys.join(<span class="charliteral">&#39;+&#39;</span>);</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    }</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;});</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.DialogLayerManager = $.Class({</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;DialogLayerManager&quot;</span>,</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    aMadeDraggable : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    aOpenedLayers : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    $init : <span class="keyword">function</span>(){</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        this.aMadeDraggable = [];</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        this.aOpenedLayers = [];</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    },</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    $ON_SHOW_DIALOG_LAYER : <span class="keyword">function</span>(oLayer, bModal){</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        oLayer = $.$(oLayer);</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        bModal = $.$(bModal) || <span class="keyword">false</span>;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        <span class="keywordflow">if</span>(!oLayer) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        <span class="keywordflow">if</span>($.inArray(oLayer, this.aOpenedLayers) != -1) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;POSITION_DIALOG_LAYER&quot;</span>, [oLayer]);</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        this.aOpenedLayers[this.aOpenedLayers.length] = oLayer;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        <span class="keywordflow">if</span>($.inArray(oLayer, this.aMadeDraggable) == -1){</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            <span class="keyword">new</span> <a class="code" href="namespacexe.html">xe</a>.DraggableLayer(oLayer, {bModal: bModal, iMinY: 0});</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            this.aMadeDraggable[this.aMadeDraggable.length] = oLayer;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;            oLayer.style.display = <span class="stringliteral">&quot;block&quot;</span>;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        }</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    },</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    $ON_HIDE_LAST_DIALOG_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_DIALOG_LAYER&quot;</span>, [this.aOpenedLayers[this.aOpenedLayers.length-1]]);</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    },</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    $ON_HIDE_ALL_DIALOG_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=this.aOpenedLayers.length-1; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&gt;=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>--)</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;HIDE_DIALOG_LAYER&quot;</span>, [this.aOpenedLayers[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>]]);</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    },</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    $ON_HIDE_DIALOG_LAYER : <span class="keyword">function</span>(oLayer){</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        oLayer = $.$(oLayer);</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        <span class="keywordflow">if</span>(oLayer) oLayer.style.display = <span class="stringliteral">&quot;none&quot;</span>;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        this.aOpenedLayers = $.grep(this.aOpenedLayers, <span class="keyword">function</span>(a){<span class="keywordflow">return</span> a!=oLayer});</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    },</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    $ON_SET_DIALOG_LAYER_POSITION : <span class="keyword">function</span>(oLayer, iTop, iLeft){</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;        oLayer.style.top = iTop;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        oLayer.style.left = iLeft;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    }</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;});</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.ActiveLayerManager = $.Class({</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;ActiveLayerManager&quot;</span>,</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    oCurrentLayer : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    $ON_TOGGLE_ACTIVE_LAYER : <span class="keyword">function</span>(oLayer, sOnOpenCmd, aOnOpenParam, sOnCloseCmd, aOnCloseParam){</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        <span class="keywordflow">if</span>(oLayer == this.oCurrentLayer){</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>, []);</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;SHOW_ACTIVE_LAYER&quot;</span>, [oLayer, sOnCloseCmd, aOnCloseParam]);</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            <span class="keywordflow">if</span>(sOnOpenCmd) this.oApp.exec(sOnOpenCmd, aOnOpenParam);</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        }</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    },</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    $ON_SHOW_ACTIVE_LAYER : <span class="keyword">function</span>(oLayer, sOnCloseCmd, aOnCloseParam){</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        oLayer = $.$(oLayer);</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        this.sOnCloseCmd = sOnCloseCmd;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        this.aOnCloseParam = aOnCloseParam;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        var oPrevLayer = this.oCurrentLayer;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        <span class="keywordflow">if</span>(oLayer == oPrevLayer) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>, []);</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        oLayer.style.display = <span class="stringliteral">&quot;block&quot;</span>;</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        this.oCurrentLayer = oLayer;</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    },</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    $ON_HIDE_ACTIVE_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        var oLayer = this.oCurrentLayer;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        <span class="keywordflow">if</span>(!oLayer) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        oLayer.style.display = <span class="stringliteral">&quot;none&quot;</span>;</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        this.oCurrentLayer = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        <span class="keywordflow">if</span>(this.sOnCloseCmd)</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;            this.oApp.exec(this.sOnCloseCmd, this.aOnCloseParam);</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    },</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="comment">// for backward compatibility only.</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="comment">// use HIDE_ACTIVE_LAYER instead!</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    $ON_HIDE_CURRENT_ACTIVE_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>, []);</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    },</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    $ON_EVENT_EDITING_AREA_KEYDOWN : <span class="keyword">function</span>(){</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>, []);</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    },</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    $ON_EVENT_EDITING_AREA_MOUSEDOWN : <span class="keyword">function</span>(){</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>, []);</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    }</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;});</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.StringConverterManager = $.Class({</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;StringConverterManager&quot;</span>,</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    oConverters : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    $init : <span class="keyword">function</span>(){</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        this.oConverters = {};</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    },</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    $BEFORE_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;applyConverter&quot;</span>, $.fnBind(this.applyConverter, <span class="keyword">this</span>)]);</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;addConverter&quot;</span>, $.fnBind(this.addConverter, <span class="keyword">this</span>)]);</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    },</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    applyConverter : <span class="keyword">function</span>(sRuleName, sContent){</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        var aConverters = this.oConverters[sRuleName];</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        <span class="keywordflow">if</span>(!aConverters) <span class="keywordflow">return</span> sContent;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;aConverters.length; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++) sContent = aConverters[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>](sContent);</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        <span class="keywordflow">return</span> sContent;</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    },</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    addConverter : <span class="keyword">function</span>(sRuleName, funcConverter){</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        var aConverters = this.oConverters[sRuleName];</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        <span class="keywordflow">if</span>(!aConverters) this.oConverters[sRuleName] = [];</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        this.oConverters[sRuleName][this.oConverters[sRuleName].length] = funcConverter;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    }</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;});</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.MessageManager = $.Class({</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;MessageManager&quot;</span>,</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    oMessageMap : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    $init : <span class="keyword">function</span>(oMessageMap){</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        this.oMessageMap = oMessageMap;</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    },</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    $BEFORE_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;$MSG&quot;</span>, $.fnBind(this.getMessage, <span class="keyword">this</span>)]);</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    },</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    getMessage : <span class="keyword">function</span>(sMsg){</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        <span class="keywordflow">if</span>(this.oMessageMap[sMsg]) <span class="keywordflow">return</span> <a class="code" href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a>(this.oMessageMap[sMsg]);</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <span class="keywordflow">return</span> sMsg;</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    }</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;});</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_Toolbar = $.Class({</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_Toolbar&quot;</span>,</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    toolbarArea : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    toolbarButton : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    uiNameTag : <span class="stringliteral">&quot;uiName&quot;</span>,</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    sUIClassPrefix : <span class="stringliteral">&quot;xpress_xeditor_ui_&quot;</span>,</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    aUICmdMap : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    $init : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        this.htUIList = {};</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;        this.aUICmdMap = {};</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;        this._assignHTMLObjects(oAppContainer);</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    },</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        oAppContainer = $.$(oAppContainer) || <a class="code" href="classdocument.html">document</a>;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        this.toolbarArea = $(<span class="stringliteral">&quot;.tool&quot;</span>, oAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        this.welToolbarArea = $(this.toolbarArea);</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        this.aAllButtons = $(<span class="stringliteral">&quot;BUTTON&quot;</span>, this.toolbarArea).<span class="keyword">get</span>();</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        var aAllLi = this.toolbarArea.getElementsByTagName(<span class="stringliteral">&quot;LI&quot;</span>);</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        var nCount = aAllLi.length;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        var rxUI = <span class="keyword">new</span> RegExp(this.sUIClassPrefix+<span class="stringliteral">&quot;([^ ]+)&quot;</span>);</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;nCount; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            <span class="keywordflow">if</span>(rxUI.test(aAllLi[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].className)){</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                var sUIName = RegExp.$1;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                <span class="keywordflow">if</span>(this.htUIList[sUIName] != <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                this.htUIList[sUIName] = $(<span class="stringliteral">&quot;&gt;*:first-child&quot;</span>, aAllLi[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>]).<span class="keyword">get</span>(0);</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            }</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        }</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    },</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;        this.oApp.registerBrowserEvent(this.toolbarArea, <span class="stringliteral">&quot;mouseover&quot;</span>, <span class="stringliteral">&quot;EVENT_TOOLBAR_MOUSEOVER&quot;</span>, []);</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        this.oApp.registerBrowserEvent(this.toolbarArea, <span class="stringliteral">&quot;mouseout&quot;</span>, <span class="stringliteral">&quot;EVENT_TOOLBAR_MOUSEOUT&quot;</span>, []);</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;getToolbarButtonByUIName&quot;</span>, $.fnBind(this.getToolbarButtonByUIName, <span class="keyword">this</span>)]);</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    },</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    $ON_EVENT_TOOLBAR_MOUSEOVER : <span class="keyword">function</span>(weEvent){</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        <span class="keywordflow">if</span>(weEvent.target.tagName == <span class="stringliteral">&quot;BUTTON&quot;</span>) $(weEvent.target).addClass(<span class="stringliteral">&quot;hover&quot;</span>).parent(<span class="stringliteral">&quot;span&quot;</span>).addClass(<span class="stringliteral">&quot;hover&quot;</span>);</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    },</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    $ON_EVENT_TOOLBAR_MOUSEOUT : <span class="keyword">function</span>(weEvent){</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        <span class="keywordflow">if</span>(weEvent.target.tagName == <span class="stringliteral">&quot;BUTTON&quot;</span>) $(weEvent.target).removeClass(<span class="stringliteral">&quot;hover&quot;</span>).parent(<span class="stringliteral">&quot;span&quot;</span>).removeClass(<span class="stringliteral">&quot;hover&quot;</span>);</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    },</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    $ON_TOGGLE_TOOLBAR_ACTIVE_LAYER : <span class="keyword">function</span>(oLayer, oBtn, sOpenCmd, aOpenArgs, sCloseCmd, aCloseArgs){</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;TOGGLE_ACTIVE_LAYER&quot;</span>, [oLayer, <span class="stringliteral">&quot;MSG_TOOLBAR_LAYER_SHOWN&quot;</span>, [oLayer, oBtn, sOpenCmd, aOpenArgs], sCloseCmd, aCloseArgs]);</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    },</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    $ON_MSG_TOOLBAR_LAYER_SHOWN : <span class="keyword">function</span>(oLayer, oBtn, aOpenCmd, aOpenArgs){</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;POSITION_TOOLBAR_LAYER&quot;</span>, [oLayer, oBtn]);</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        <span class="keywordflow">if</span>(aOpenCmd) this.oApp.exec(aOpenCmd, aOpenArgs);</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    },</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    $ON_SHOW_TOOLBAR_ACTIVE_LAYER : <span class="keyword">function</span>(oLayer, sCmd, aArgs, oBtn){</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SHOW_ACTIVE_LAYER&quot;</span>, [oLayer, sCmd, aArgs]);</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;POSITION_TOOLBAR_LAYER&quot;</span>, [oLayer, oBtn]);</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    },</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    $ON_ENABLE_UI : <span class="keyword">function</span>(sUIName){</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        var elUI = this.htUIList[sUIName];</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;        <span class="keywordflow">if</span>(!elUI) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        $(elUI).removeClass(<span class="stringliteral">&quot;off&quot;</span>);</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        elUI.disabled = <span class="keyword">false</span>;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        <span class="comment">// enable related commands</span></div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        var sCmd = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        <span class="keywordflow">if</span>(this.aUICmdMap[sUIName]){</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;this.aUICmdMap[sUIName].length;<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                sCmd = this.aUICmdMap[sUIName][<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>];</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                this.oApp.exec(<span class="stringliteral">&quot;ENABLE_COMMAND&quot;</span>, [sCmd]);</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;            }</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        }</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    },</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    $ON_DISABLE_UI : <span class="keyword">function</span>(sUIName){</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        var elUI = this.htUIList[sUIName];</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        <span class="keywordflow">if</span>(!elUI) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        $(elUI).addClass(<span class="stringliteral">&quot;off&quot;</span>);</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;        $(elUI).removeClass(<span class="stringliteral">&quot;hover&quot;</span>).parent(<span class="stringliteral">&quot;span&quot;</span>).removeClass(<span class="stringliteral">&quot;hover&quot;</span>);</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;        elUI.disabled = <span class="keyword">true</span>;</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        <span class="comment">// disable related commands</span></div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;        var sCmd = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        <span class="keywordflow">if</span>(this.aUICmdMap[sUIName]){</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;            <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;this.aUICmdMap[sUIName].length;<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                sCmd = this.aUICmdMap[sUIName][<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>];</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                this.oApp.exec(<span class="stringliteral">&quot;DISABLE_COMMAND&quot;</span>, [sCmd]);</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            }</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        }</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    },</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    $ON_SELECT_UI : <span class="keyword">function</span>(sUIName){</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        var elUI = this.htUIList[sUIName];</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        <span class="keywordflow">if</span>(!elUI) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        $(elUI).addClass(<span class="stringliteral">&quot;active&quot;</span>);</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    },</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    $ON_DESELECT_UI : <span class="keyword">function</span>(sUIName){</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;        var elUI = this.htUIList[sUIName];</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        <span class="keywordflow">if</span>(!elUI) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        $(elUI).removeClass(<span class="stringliteral">&quot;active&quot;</span>);</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    },</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    $ON_ENABLE_ALL_UI : <span class="keyword">function</span>(){</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        var sUIName, className;</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        <span class="keywordflow">for</span>(var sUIName in this.htUIList){</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;            <span class="keywordflow">if</span>(sUIName) this.oApp.exec(<span class="stringliteral">&quot;ENABLE_UI&quot;</span>, [sUIName]);</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        }</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        $(this.toolbarArea).removeClass(<span class="stringliteral">&quot;off&quot;</span>);</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    },</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    $ON_DISABLE_ALL_UI : <span class="keyword">function</span>(){</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        var sUIName;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        <span class="keywordflow">for</span>(var sUIName in this.htUIList){</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;            <span class="keywordflow">if</span>(sUIName) this.oApp.exec(<span class="stringliteral">&quot;DISABLE_UI&quot;</span>, [sUIName]);</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        }</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        $(this.toolbarArea).addClass(<span class="stringliteral">&quot;off&quot;</span>);</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>,[]);</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    },</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    $ON_MSG_STYLE_CHANGED : <span class="keyword">function</span>(sAttributeName, attributeValue){</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        <span class="keywordflow">if</span>(attributeValue == 1)</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;SELECT_UI&quot;</span>, [sAttributeName]);</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;DESELECT_UI&quot;</span>, [sAttributeName]);</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    },</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    $ON_REGISTER_UI_EVENT : <span class="keyword">function</span>(sUIName, sEvent, sCmd, aParams){</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        <span class="comment">// map cmd &amp; ui</span></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        <span class="keywordflow">if</span>(!this.aUICmdMap[sUIName]){this.aUICmdMap[sUIName] = [];}</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        this.aUICmdMap[sUIName][this.aUICmdMap[sUIName].length] = sCmd;</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        var elUI = this.htUIList[sUIName];</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="keywordflow">if</span>(!elUI) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        this.oApp.registerBrowserEvent(elUI, sEvent, sCmd, aParams);</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    },</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    $ON_POSITION_TOOLBAR_LAYER : <span class="keyword">function</span>(oLayer, oBtn){</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        oLayer = $.$(oLayer);</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        oBtn = $.$(oBtn);</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        <span class="keywordflow">if</span>(!oLayer) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        <span class="keywordflow">if</span>(oBtn &amp;&amp; oBtn.tagName &amp;&amp; oBtn.tagName == <span class="stringliteral">&quot;BUTTON&quot;</span>) oBtn.parentNode.appendChild(oLayer);</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        oLayer.style.left = <span class="stringliteral">&quot;0&quot;</span>;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        var welLayer = $(oLayer);</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;        var nLayerLeft = welLayer.offset().left;</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        nLayerLeft += oLayer.offsetWidth;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        var nToolbarLeft = this.welToolbarArea.offset().left;</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        nToolbarLeft += this.toolbarArea.offsetWidth;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        <span class="keywordflow">if</span>(nLayerLeft &gt; nToolbarLeft) oLayer.style.left = (nToolbarLeft-nLayerLeft-5)+<span class="stringliteral">&quot;px&quot;</span>;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    },</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    getToolbarButtonByUIName : <span class="keyword">function</span>(sUIName){</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        <span class="keywordflow">return</span> this.htUIList[sUIName];</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    }</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;});</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_EditingAreaManager = $.Class({</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_EditingAreaManager&quot;</span>,</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    <span class="comment">// Currently active plugin instance(XE_EditingArea_???)</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    oActivePlugin : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <span class="comment">// Intermediate Representation of the content being edited.</span></div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="comment">// This should be a textarea element.</span></div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    oIRField : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    bIsDirty : <span class="keyword">false</span>,</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    $init : <span class="keyword">function</span>(sInitialMode, oIRField, oDimension, fOnBeforeUnload, oAppContainer){</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        this.sInitialMode = sInitialMode;</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        this.oIRField = $.$(oIRField);</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        this._assignHTMLObjects(oAppContainer);</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        this.fOnBeforeUnload = fOnBeforeUnload;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        this.oEditingMode = {};</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        this.elEditingAreaContainer.style.height = parseInt(oDimension.nHeight || <span class="keyword">this</span>.elEditingAreaContainer.offsetHeight)+<span class="stringliteral">&quot;px&quot;</span>;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        this.nMinHeight = oDimension.nMinHeight || 10;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        this.niMinWidth = oDimension.nMinWidth || 10;</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    },</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        oAppContainer = $.$(oAppContainer) || <a class="code" href="classdocument.html">document</a>;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        this.elEditingAreaContainer = $(<span class="stringliteral">&quot;DIV.xpress_xeditor_editing_area_container&quot;</span>, oAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        this.elEditingAreaSkipUI = $(<span class="stringliteral">&quot;A.skip&quot;</span>, oAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    },</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    $BEFORE_MSG_APP_READY : <span class="keyword">function</span>(msg){</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;elEditingAreaContainer&quot;</span>, this.elEditingAreaContainer]);</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;getIR&quot;</span>, $.fnBind(this.getIR, <span class="keyword">this</span>)]);</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;setIR&quot;</span>, this.setIR]);</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;getEditingMode&quot;</span>, $.fnBind(this.getEditingMode, <span class="keyword">this</span>)]);</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    },</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;CHANGE_EDITING_MODE&quot;</span>, [this.sInitialMode, <span class="keyword">true</span>]);</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;LOAD_IR_FIELD&quot;</span>, [<span class="keyword">false</span>]);</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;        this.oApp.registerBrowserEvent(this.elEditingAreaSkipUI, <span class="stringliteral">&quot;focus&quot;</span>, <span class="stringliteral">&quot;MSG_EDITING_AREA_SIZE_CHANGED&quot;</span>, [], 50);</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        this.oApp.registerBrowserEvent(this.elEditingAreaSkipUI, <span class="stringliteral">&quot;blur&quot;</span>, <span class="stringliteral">&quot;MSG_EDITING_AREA_SIZE_CHANGED&quot;</span>, [], 50);</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="comment">//      var fOnBeforeUnload = this.fOnBeforeUnload||function(){if(this.getIR() != this.oIRField.value || this.bIsDirty) return this.oApp.$MSG(&quot;XE_EditingAreaManager.onExit&quot;)};</span></div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="comment">//      $(window).bind(&quot;beforeunload&quot;, $.fnBind(fOnBeforeUnload, this));</span></div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    },</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    $AFTER_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;UPDATE_IR_FIELD&quot;</span>, []);</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    },</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    $ON_LOAD_IR_FIELD : <span class="keyword">function</span>(bDontAddUndo){</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;        this.oApp.setIR(this.oIRField.value, bDontAddUndo);</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    },</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    $ON_UPDATE_IR_FIELD : <span class="keyword">function</span>(){</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;        this.oIRField.value = this.oApp.getIR();</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    },</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    $BEFORE_CHANGE_EDITING_MODE : <span class="keyword">function</span>(sMode){</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        this._oPrevActivePlugin = this.oActivePlugin;</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        this.oActivePlugin = this.oEditingMode[sMode];</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    },</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    $AFTER_CHANGE_EDITING_MODE : <span class="keyword">function</span>(sMode, bNoFocus){</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        <span class="keywordflow">if</span>(this._oPrevActivePlugin){</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;            var sIR = this._oPrevActivePlugin.getIR();</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;SET_IR&quot;</span>, [sIR]);</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;ENABLE_UI&quot;</span>, [this._oPrevActivePlugin.sMode]);</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;            this._setEditingAreaDimension();</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        }</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;DISABLE_UI&quot;</span>, [this.oActivePlugin.sMode]);</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;        <span class="keywordflow">if</span>(!bNoFocus){</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;FOCUS&quot;</span>, []);</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        }</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    },</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    $ON_SET_IS_DIRTY : <span class="keyword">function</span>(bIsDirty){</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        this.bIsDirty = bIsDirty;</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    },</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    $ON_FOCUS : <span class="keyword">function</span>(){</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        <span class="keywordflow">if</span>(!this.oActivePlugin || typeof this.oActivePlugin.setIR != <span class="stringliteral">&quot;function&quot;</span>) <span class="keywordflow">return</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        this.oActivePlugin.focus();</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    },</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    $BEFORE_SET_IR : <span class="keyword">function</span>(sIR, bDontAddUndoHistory){</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;        bDontAddUndoHistory = bDontAddUndoHistory || <span class="keyword">false</span>;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;        <span class="keywordflow">if</span>(!bDontAddUndoHistory) this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_ACTION&quot;</span>, [<span class="stringliteral">&quot;SET CONTENTS&quot;</span>]);</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    },</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    $ON_SET_IR : <span class="keyword">function</span>(sIR){</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        <span class="keywordflow">if</span>(!this.oActivePlugin || typeof this.oActivePlugin.setIR != <span class="stringliteral">&quot;function&quot;</span>) <span class="keywordflow">return</span></div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        this.oActivePlugin.setIR(sIR);</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    },</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    $AFTER_SET_IR : <span class="keyword">function</span>(sIR, bDontAddUndoHistory){</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;        bDontAddUndoHistory = bDontAddUndoHistory || <span class="keyword">false</span>;</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;        <span class="keywordflow">if</span>(!bDontAddUndoHistory) this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_ACTION&quot;</span>, [<span class="stringliteral">&quot;SET CONTENTS&quot;</span>]);</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    },</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    $ON_REGISTER_EDITING_AREA : <span class="keyword">function</span>(oEditingAreaPlugin){</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        this.oEditingMode[oEditingAreaPlugin.sMode] = oEditingAreaPlugin;</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        this.attachDocumentEvents(oEditingAreaPlugin.oEditingArea);</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    },</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    $ON_MSG_EDITING_AREA_RESIZE_STARTED : <span class="keyword">function</span>(){</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        this.oActivePlugin.elEditingArea.style.display = <span class="stringliteral">&quot;none&quot;</span>;</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        this.iStartingHeight = parseInt(this.elEditingAreaContainer.style.height);</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    },</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    $ON_RESIZE_EDITING_AREA: <span class="keyword">function</span>(ipNewWidth, ipNewHeight){</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        var iNewWidth = parseInt(ipNewWidth);</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        var iNewHeight = parseInt(ipNewHeight);</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <span class="keywordflow">if</span>(iNewWidth &lt; this.niMinWidth) iNewWidth = this.niMinWidth;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        <span class="keywordflow">if</span>(iNewHeight &lt; this.nMinHeight) iNewHeight = this.nMinHeight;</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        <span class="keywordflow">if</span>(ipNewWidth) this.elEditingAreaContainer.style.width = iNewWidth + <span class="stringliteral">&quot;px&quot;</span>;</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;        <span class="keywordflow">if</span>(ipNewHeight) this.elEditingAreaContainer.style.height = iNewHeight + <span class="stringliteral">&quot;px&quot;</span>;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    },</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    $ON_RESIZE_EDITING_AREA_BY : <span class="keyword">function</span>(ipWidthChange, ipHeightChange){</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        var iWidthChange = parseInt(ipWidthChange);</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        var iHeightChange = parseInt(ipHeightChange);</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        var iWidth = this.elEditingAreaContainer.style.width?parseInt(this.elEditingAreaContainer.style.width)+iWidthChange:<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        var iHeight = this.elEditingAreaContainer.style.height?this.iStartingHeight+iHeightChange:<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RESIZE_EDITING_AREA&quot;</span>, [iWidth, iHeight]);</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    },</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    $ON_MSG_EDITING_AREA_RESIZE_ENDED : <span class="keyword">function</span>(FnMouseDown, FnMouseMove, FnMouseUp){</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        this.oActivePlugin.elEditingArea.style.display = <span class="stringliteral">&quot;block&quot;</span>;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;        this._setEditingAreaDimension();</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    },</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    _setEditingAreaDimension : <span class="keyword">function</span>(){</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        this.oActivePlugin.elEditingArea.style.height = this.elEditingAreaContainer.style.height;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        this.oActivePlugin.elEditingArea.style.width = this.elEditingAreaContainer.style.width;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    },</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    attachDocumentEvents : <span class="keyword">function</span>(doc){</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        this.oApp.registerBrowserEvent(doc, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EVENT_EDITING_AREA_CLICK&quot;</span>);</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        this.oApp.registerBrowserEvent(doc, <span class="stringliteral">&quot;mousedown&quot;</span>, <span class="stringliteral">&quot;EVENT_EDITING_AREA_MOUSEDOWN&quot;</span>);</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        this.oApp.registerBrowserEvent(doc, <span class="stringliteral">&quot;mousemove&quot;</span>, <span class="stringliteral">&quot;EVENT_EDITING_AREA_MOUSEMOVE&quot;</span>);</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;        this.oApp.registerBrowserEvent(doc, <span class="stringliteral">&quot;mouseup&quot;</span>, <span class="stringliteral">&quot;EVENT_EDITING_AREA_MOUSEUP&quot;</span>);</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        this.oApp.registerBrowserEvent(doc, <span class="stringliteral">&quot;keydown&quot;</span>, <span class="stringliteral">&quot;EVENT_EDITING_AREA_KEYDOWN&quot;</span>);</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;        this.oApp.registerBrowserEvent(doc, <span class="stringliteral">&quot;keypress&quot;</span>, <span class="stringliteral">&quot;EVENT_EDITING_AREA_KEYPRESS&quot;</span>);</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;        this.oApp.registerBrowserEvent(doc, <span class="stringliteral">&quot;keyup&quot;</span>, <span class="stringliteral">&quot;EVENT_EDITING_AREA_KEYUP&quot;</span>);</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    },</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    getIR : <span class="keyword">function</span>(){</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        <span class="keywordflow">return</span> this.oActivePlugin.getIR();</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    },</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    setIR : <span class="keyword">function</span>(sIR, bDontAddUndo){</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SET_IR&quot;</span>, [sIR, bDontAddUndo]);</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    },</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    getEditingMode : <span class="keyword">function</span>(){</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        <span class="keywordflow">return</span> this.oActivePlugin.sMode;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    }</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;});</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_EditingArea_HTMLSrc = $.Class({</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_EditingArea_HTMLSrc&quot;</span>,</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    sMode : <span class="stringliteral">&quot;HTMLSrc&quot;</span>,</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    textarea : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    $init : <span class="keyword">function</span>(textarea){</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        this.textarea = $.$(textarea);</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        this.elEditingArea = this.textarea;</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    },</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    $BEFORE_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        this.oEditingArea = this.textarea;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_EDITING_AREA&quot;</span>, [<span class="keyword">this</span>]);</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    },</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    $ON_CHANGE_EDITING_MODE : <span class="keyword">function</span>(sMode, bNoFocus){</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        <span class="keywordflow">if</span>(sMode == this.sMode){</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;            this.textarea.style.display = <span class="stringliteral">&quot;block&quot;</span>;</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;            this.textarea.style.display = <span class="stringliteral">&quot;none&quot;</span>;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;        }</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    },</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    $ON_PASTE_HTML : <span class="keyword">function</span>(sHTML, oPSelection){</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        <span class="keywordflow">if</span>(this.oApp.getEditingMode() != this.sMode) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        var <a class="code" href="jquery-1_8x_8min_8js.html#a400dc8109620963da8314d4bdfa14f83">o</a> = <span class="keyword">new</span> TextRange(this.textarea);</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        o.paste(sHTML);</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        this.textarea.focus();</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    },</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    getIR : <span class="keyword">function</span>(){</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        var sIR;</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        var sContent = this.textarea.value;</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        <span class="keywordflow">if</span>(this.oApp.applyConverter)</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;            sIR = this.oApp.applyConverter(this.sMode+<span class="stringliteral">&quot;_TO_IR&quot;</span>, sContent);</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;            sIR = sContent;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <span class="keywordflow">return</span> sIR;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    },</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    setIR : <span class="keyword">function</span>(sIR){</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;        var sContent;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        <span class="keywordflow">if</span>(this.oApp.applyConverter)</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;            sContent = this.oApp.applyConverter(<span class="stringliteral">&quot;IR_TO_&quot;</span>+this.sMode, sIR);</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;            sContent = sIR;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        this.textarea.value = sContent;</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    },</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <a class="code" href="layouts_2xedition_2js_2layout_8js.html#a3a1f4f7d234c54c60d004099251de877">focus</a> : <span class="keyword">function</span>(){</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;        this.textarea.focus();</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    }</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;});</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;var TextRange = <span class="keyword">function</span>(oEl) {</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    this._o = oEl;</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;};</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;TextRange.prototype.getSelection = <span class="keyword">function</span>() {</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    var obj = this._o;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    var ret = [ -1, -1 ];</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    <span class="keywordflow">if</span> (isNaN(this._o.selectionStart)) {</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;        obj.focus();</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;        <span class="comment">// textarea support added by nagoon97</span></div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;        var range = <a class="code" href="classdocument.html">document</a>.body.createTextRange();</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;        var rangeField = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;        rangeField = <a class="code" href="classdocument.html">document</a>.selection.createRange().duplicate();</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;        range.moveToElementText(obj);</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        rangeField.collapse(<span class="keyword">true</span>);</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        range.setEndPoint(<span class="stringliteral">&quot;EndToEnd&quot;</span>, rangeField);</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;        ret[0] = range.text.length;</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        rangeField = <a class="code" href="classdocument.html">document</a>.selection.createRange().duplicate();</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        range.moveToElementText(obj);</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;        rangeField.collapse(<span class="keyword">false</span>);</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;        range.setEndPoint(<span class="stringliteral">&quot;EndToEnd&quot;</span>, rangeField);</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        ret[1] = range.text.length;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        obj.blur();</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        ret[0] = obj.selectionStart;</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;        ret[1] = obj.selectionEnd;</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    }</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;};</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;TextRange.prototype.setSelection = <span class="keyword">function</span>(<a class="code" href="jquery-1_8x_8js.html#aef10902ffededd983608fdb8dbfc441a">start</a>, end) {</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    var obj = this._o;</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    <span class="keywordflow">if</span> (typeof end == <span class="stringliteral">&#39;undefined&#39;</span>) end = <a class="code" href="jquery-1_8x_8js.html#aef10902ffededd983608fdb8dbfc441a">start</a>;</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    <span class="keywordflow">if</span> (obj.setSelectionRange) {</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;        obj.setSelectionRange(<a class="code" href="jquery-1_8x_8js.html#aef10902ffededd983608fdb8dbfc441a">start</a>, end);</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (obj.createTextRange) {</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        var range = obj.createTextRange();</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        range.collapse(<span class="keyword">true</span>);</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        range.moveStart(<span class="stringliteral">&quot;character&quot;</span>, <a class="code" href="jquery-1_8x_8js.html#aef10902ffededd983608fdb8dbfc441a">start</a>);</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;        range.moveEnd(<span class="stringliteral">&quot;character&quot;</span>, end - <a class="code" href="jquery-1_8x_8js.html#aef10902ffededd983608fdb8dbfc441a">start</a>);</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        range.select();</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        obj.blur();</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    }</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;};</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;TextRange.prototype.copy = <span class="keyword">function</span>() {</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    var r = this.<a class="code" href="xpresseditor_8min_8js.html#a35285773512637248aba162f229c8949">getSelection</a>();</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <span class="keywordflow">return</span> this._o.value.substring(r[0], r[1]);</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;};</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;TextRange.prototype.paste = <span class="keyword">function</span>(sStr) {</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    var obj = this._o;</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    var sel = this.<a class="code" href="xpresseditor_8min_8js.html#a35285773512637248aba162f229c8949">getSelection</a>();</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    var <a class="code" href="jquery-1_8x_8js.html#abe5393d870043cf6aaa1d5ad5fce755c">value</a> = obj.value;</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    var pre = value.substr(0, sel[0]);</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    var post = value.substr(sel[1]);</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    value = pre + sStr + post;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    obj.value = <a class="code" href="jquery-1_8x_8js.html#abe5393d870043cf6aaa1d5ad5fce755c">value</a>;</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    var <a class="code" href="jquery-1_8x_8min_8js.html#afc984c4f6c68ce30a0af99006f5f8d27">n</a> = 0;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="keywordflow">if</span> ( typeof <a class="code" href="classdocument.html">document</a>.body.style.maxHeight == <span class="stringliteral">&quot;undefined&quot;</span> ) {</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        var a = pre.match( /\n/gi );</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;        n = ( a != <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a> ? a.length : 0 );</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    }</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    this.<a class="code" href="xpresseditor_8min_8js.html#a252592379bc934b27218ace911e55c34">setSelection</a>(sel[0] + sStr.length - n );</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;};</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;TextRange.prototype.cut = <span class="keyword">function</span>() {</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    var r = this.<a class="code" href="xpresseditor_8min_8js.html#abe32dbc1f360937030a749861db6c5fc">copy</a>();</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    this.<a class="code" href="xpresseditor_8min_8js.html#ab483765d900d3be44fd88e28e03c1d56">paste</a>(<span class="stringliteral">&#39;&#39;</span>);</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="keywordflow">return</span> r;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;};</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_EditingArea_WYSIWYG = $.Class({</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_EditingArea_WYSIWYG&quot;</span>,</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    status : <a class="code" href="namespacexe.html">xe</a>.PLUGIN_STATUS[<span class="stringliteral">&quot;NOT_READY&quot;</span>],</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    sMode : <span class="stringliteral">&quot;WYSIWYG&quot;</span>,</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    iframe : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    doc : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    iLastUndoRecorded : 0,</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    iMinUndoInterval : 3000,</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    _nIFrameReadyCount : 50,</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    $init : <span class="keyword">function</span>(iframe){</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        this.iframe = $.$(iframe);</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;        this.initIframe();</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;        this.elEditingArea = iframe;</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    },</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    $BEFORE_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        this.oEditingArea = this.doc;</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_EDITING_AREA&quot;</span>, [<span class="keyword">this</span>]);</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;getWYSIWYGWindow&quot;</span>, $.fnBind(this.<a class="code" href="jquery-1_8x_8js.html#ab8e6e1fb3b8b51b6afe437c63df0e09f">getWindow</a>, <span class="keyword">this</span>)]);</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;getWYSIWYGDocument&quot;</span>, $.fnBind(this.getDocument, <span class="keyword">this</span>)]);</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    },</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        <span class="comment">// uncomment this line if you wish to use the IE-style cursor in FF</span></div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;        <span class="comment">// this.getDocument().body.style.cursor = &quot;text&quot;;</span></div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        <span class="keywordflow">if</span>($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie){</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;            $(this.doc)</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                .unbind(<span class="stringliteral">&#39;keydown.ea&#39;</span>)</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                .bind(<span class="stringliteral">&#39;keydown.ea&#39;</span>, $.fnBind(</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;                    <span class="keyword">function</span>(weEvent){</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;                        <span class="keywordflow">if</span>(this.doc.selection.type.toLowerCase() == <span class="stringliteral">&#39;control&#39;</span> &amp;&amp; weEvent.keyCode == 8)  {</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                            this.oApp.exec(<span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&#39;delete&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]);</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;                            weEvent.preventDefault(); weEvent.stopPropagation();</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                        }</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;                    }</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;                , <span class="keyword">this</span>));</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;            $(this.doc.body)</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;                .unbind(<span class="stringliteral">&#39;mousedown.ea&#39;</span>)</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;                .bind(<span class="stringliteral">&#39;mousedown.ea&#39;</span>, $.fnBind(</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;                    <span class="keyword">function</span>(weEvent){</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;                        this._oIERange = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                        this._bIERangeReset = <span class="keyword">true</span>;</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;                    }</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;                , <span class="keyword">this</span>))</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;                .unbind(<span class="stringliteral">&#39;beforedeactivate.ea&#39;</span>)</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                .bind(<span class="stringliteral">&#39;beforedeactivate.ea&#39;</span>, $.fnBind(</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;                    <span class="keyword">function</span>(weEvent){</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;                        <span class="comment">// without this, cursor won&#39;t make it inside a table.</span></div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                        <span class="comment">// mousedown(_oIERange gets reset) -&gt; beforedeactivate(gets fired for table) -&gt; RESTORE_IE_SELECTION</span></div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                        <span class="keywordflow">if</span>(this._bIERangeReset) <span class="keywordflow">return</span>;</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                        var tmpRange = this.getDocument().selection.createRange(0);</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                        <span class="comment">// Control range does not have parentElement</span></div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;                        <span class="keywordflow">if</span>(tmpRange.parentElement &amp;&amp; tmpRange.parentElement() &amp;&amp; tmpRange.parentElement().tagName == <span class="stringliteral">&quot;INPUT&quot;</span>){</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                            this._oIERange = this._oPrevIERange;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                            this._oIERange = tmpRange;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                        }</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                    }</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                , <span class="keyword">this</span>))</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                .unbind(<span class="stringliteral">&#39;mouseup.ea&#39;</span>)</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                .bind(<span class="stringliteral">&#39;mouseup.ea&#39;</span>, $.fnBind( <span class="keyword">function</span>(weEvent){ this._bIERangeReset = <span class="keyword">false</span>;}, <span class="keyword">this</span>));</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;        }</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    },</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    $ON_CHANGE_EDITING_MODE : <span class="keyword">function</span>(sMode, bNoFocus){</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        <span class="keywordflow">if</span>(sMode == this.sMode){</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;            this.iframe.style.display = <span class="stringliteral">&quot;block&quot;</span>;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;REFRESH_WYSIWYG&quot;</span>, []);</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;SET_EDITING_WINDOW&quot;</span>, [this.<a class="code" href="jquery-1_8x_8js.html#ab8e6e1fb3b8b51b6afe437c63df0e09f">getWindow</a>()]);</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;            this.iframe.style.display = <span class="stringliteral">&quot;none&quot;</span>;</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        }</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    },</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    $AFTER_CHANGE_EDITING_MODE : <span class="keyword">function</span>(sMode, bNoFocus){</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        this._oIERange = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    },</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    $ON_REFRESH_WYSIWYG : <span class="keyword">function</span>(){</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        <span class="keywordflow">if</span>(!$.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.mozilla) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        this._disableWYSIWYG();</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        this._enableWYSIWYG();</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    },</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    $ON_ENABLE_WYSIWYG : <span class="keyword">function</span>(){</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        this._enableWYSIWYG();</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    },</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    $ON_DISABLE_WYSIWYG : <span class="keyword">function</span>(){</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;        this._disableWYSIWYG();</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    },</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    $ON_EVENT_EDITING_AREA_KEYDOWN : <span class="keyword">function</span>(oEvent) {</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;        <span class="comment">// ctrl-left/right add/remove indent</span></div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        <span class="keywordflow">if</span>(!oEvent.ctrlKey) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        <span class="keywordflow">switch</span>(oEvent.keyCode) {</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;            <span class="comment">// outdent</span></div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;            <span class="keywordflow">case</span> 37 :</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                    this.oApp.exec(<span class="stringliteral">&quot;EXECCOMMAND&quot;</span>,  [<span class="stringliteral">&quot;outdent&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]);</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;            <span class="comment">// indent</span></div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;            <span class="keywordflow">case</span> 39 :</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                    this.oApp.exec(<span class="stringliteral">&quot;EXECCOMMAND&quot;</span>,  [<span class="stringliteral">&quot;indent&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]);</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;            <span class="comment">// h1 ~ h6, normal</span></div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;            <span class="keywordflow">case</span> 49 :</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;            <span class="keywordflow">case</span> 50 :</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;            <span class="keywordflow">case</span> 51 :</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;            <span class="keywordflow">case</span> 52 :</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;            <span class="keywordflow">case</span> 53 :</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;            <span class="keywordflow">case</span> 54 :</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;                    this.oApp.exec(<span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;FormatBlock&quot;</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&lt;h&#39;</span>+(oEvent.keyCode-48)+<span class="charliteral">&#39;&gt;&#39;</span>]);</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;            <span class="keywordflow">default</span> :</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        }</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        oEvent.preventDefault(); oEvent.stopPropagation();</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    },</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    $ON_EVENT_EDITING_AREA_KEYUP : <span class="keyword">function</span>(oEvent){</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        <span class="comment">// 33, 34: page up/down, 35,36: end/home, 37,38,39,40: left, up, right, down</span></div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;        <span class="keywordflow">if</span>(oEvent.keyCode == 229 || oEvent.keyCode == 13 || oEvent.altKey || oEvent.ctrlKey || (oEvent.keyCode &gt;= 33 &amp;&amp; oEvent.keyCode &lt;= 40) || oEvent.keyCode == 16) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;        this._recordUndo(oEvent);</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    },</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    $ON_PASTE_HTML : <span class="keyword">function</span>(sHTML, oPSelection){</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;        <span class="keywordflow">if</span>(this.oApp.getEditingMode() != this.sMode) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        var oSelection = oPSelection || this.oApp.getSelection();</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;        oSelection.pasteHTML(sHTML);</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;        <span class="comment">// every browser except for IE may modify the innerHTML when it is inserted</span></div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        <span class="keywordflow">if</span>(!$.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie){</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;            var sTmpBookmark = oSelection.placeStringBookmark();</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;            this.oApp.getWYSIWYGDocument().body.innerHTML = this.oApp.getWYSIWYGDocument().body.innerHTML;</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;            oSelection.moveToBookmark(sTmpBookmark);</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;            oSelection.collapseToEnd();</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;            oSelection.select();</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;            oSelection.removeStringBookmark(sTmpBookmark);</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        }</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_ACTION&quot;</span>, [<span class="stringliteral">&quot;INSERT HTML&quot;</span>]);</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    },</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    $AFTER_MSG_EDITING_AREA_RESIZE_ENDED : <span class="keyword">function</span>(FnMouseDown, FnMouseMove, FnMouseUp){</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REFRESH_WYSIWYG&quot;</span>, []);</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    },</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    $ON_RESTORE_IE_SELECTION : <span class="keyword">function</span>(){</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;        <span class="keywordflow">if</span>(this._oIERange){</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;            this._oIERange.select();</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;            this._oPrevIERange = this._oIERange;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;            this._oIERange = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        }</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    },</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    initIframe : <span class="keyword">function</span>(){</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;            this.doc = this.iframe.contentWindow.document;</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;            <span class="keywordflow">if</span> (this.doc == <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a> || this.doc.location.href == <span class="stringliteral">&#39;about:blank&#39;</span>) {</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> Error(<span class="stringliteral">&#39;Access denied&#39;</span>);</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;            }</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;            this._enableWYSIWYG();</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;            this.status = <a class="code" href="namespacexe.html">xe</a>.PLUGIN_STATUS[<span class="stringliteral">&quot;READY&quot;</span>];</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;        } <span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>) {</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;            <span class="keywordflow">if</span>(this._nIFrameReadyCount-- &gt; 0){</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                setTimeout($.fnBind(this.initIframe, <span class="keyword">this</span>), 100);</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;                <span class="keywordflow">throw</span>(<span class="stringliteral">&quot;iframe for WYSIWYG editing mode can&#39;t be initialized. Please check if the iframe document exists and is also accessable(cross-domain issues). &quot;</span>);</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;            }</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;        }</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    },</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;    getIR : <span class="keyword">function</span>(){</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;        var sContent = this.doc.body.innerHTML;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        var sIR;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;        <span class="keywordflow">if</span>(this.oApp.applyConverter)</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;            sIR = this.oApp.applyConverter(this.sMode+<span class="stringliteral">&quot;_TO_IR&quot;</span>, sContent);</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;            sIR = sContent;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        <span class="keywordflow">return</span> sIR;</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;    },</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    setIR : <span class="keyword">function</span>(sIR){</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        var sContent;</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        <span class="keywordflow">if</span>(this.oApp.applyConverter)</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;            sContent = this.oApp.applyConverter(<span class="stringliteral">&quot;IR_TO_&quot;</span>+this.sMode, sIR);</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;            sContent = sIR;</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        this.doc.body.innerHTML = sContent;</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;        <span class="keywordflow">if</span>($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.mozilla){</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;            <span class="keywordflow">if</span>(this.doc.body.innerHTML == <span class="stringliteral">&quot;&quot;</span>) this.doc.body.innerHTML = <span class="stringliteral">&quot;&lt;br&gt;&quot;</span>;</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        }</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    },</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;    <a class="code" href="jquery-1_8x_8js.html#ab8e6e1fb3b8b51b6afe437c63df0e09f">getWindow</a> : <span class="keyword">function</span>(){</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;        <span class="keywordflow">return</span> this.iframe.contentWindow;</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    },</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;    getDocument : <span class="keyword">function</span>(){</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;        <span class="keywordflow">return</span> this.iframe.contentWindow.document;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    },</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    <a class="code" href="layouts_2xedition_2js_2layout_8js.html#a3a1f4f7d234c54c60d004099251de877">focus</a> : <span class="keyword">function</span>(){</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        <span class="comment">//this.getWindow().focus();</span></div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        <span class="comment">//this.oApp.exec(&quot;RESTORE_IE_SELECTION&quot;, []);</span></div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    },</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    _recordUndo : <span class="keyword">function</span>(oKeyInfo){</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        var curTime = <span class="keyword">new</span> Date();</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;        <span class="keywordflow">if</span>(curTime-this.iLastUndoRecorded &lt; this.iMinUndoInterval) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_ACTION&quot;</span>, [<span class="stringliteral">&quot;KEYPRESS&quot;</span>]);</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        this.iLastUndoRecorded = <span class="keyword">new</span> Date();</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;        this.prevKeyCode = oKeyInfo.keyCode;</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    },</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    _enableWYSIWYG : <span class="keyword">function</span>(){</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;        <span class="keywordflow">if</span> ($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie){</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;            this.doc.body.disabled = <span class="keyword">true</span>;</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;            this.doc.body.contentEditable = <span class="keyword">true</span>;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;            this.doc.body.removeAttribute(<span class="stringliteral">&#39;disabled&#39;</span>);</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;            this.doc.designMode = <span class="stringliteral">&quot;on&quot;</span>;</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        }</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    },</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    _disableWYSIWYG : <span class="keyword">function</span>(){</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;        <span class="keywordflow">if</span> ($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie){</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;            this.doc.body.contentEditable = <span class="keyword">false</span>;</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;            this.doc.designMode = <span class="stringliteral">&quot;off&quot;</span>;</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        }</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    }</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;});</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_EditingAreaVerticalResizer = $.Class({</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_EditingAreaVerticalResizer&quot;</span>,</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    oResizeGrip : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    $init : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;        this._assignHTMLObjects(oAppContainer);</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        this.$FnMouseDown = $.fnBind(this._mousedown, <span class="keyword">this</span>);</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        this.$FnMouseMove = $.fnBind(this._mousemove, <span class="keyword">this</span>);</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        this.$FnMouseUp = $.fnBind(this._mouseup, <span class="keyword">this</span>);</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;        $(this.oResizeGrip).bind(<span class="stringliteral">&quot;mousedown&quot;</span>, this.$FnMouseDown);</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    },</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;        oAppContainer = $.$(oAppContainer) || <a class="code" href="classdocument.html">document</a>;</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;        this.oResizeGrip = $(<span class="stringliteral">&quot;.xpress_xeditor_editingArea_verticalResizer&quot;</span>, oAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    },</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    _mousedown : <span class="keyword">function</span>(oEvent){</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;        this.iStartHeight = oEvent.clientY;</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        $(<a class="code" href="html5_8js.html#aa14f8e0338cced6720590fd2ea13bd4b">document</a>).bind(<span class="stringliteral">&quot;mousemove&quot;</span>, this.$FnMouseMove);</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        $(<a class="code" href="html5_8js.html#aa14f8e0338cced6720590fd2ea13bd4b">document</a>).bind(<span class="stringliteral">&quot;mouseup&quot;</span>, this.$FnMouseUp);</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;MSG_EDITING_AREA_RESIZE_STARTED&quot;</span>, [this.$FnMouseDown, this.$FnMouseMove, this.$FnMouseUp]);</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    },</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    _mousemove : <span class="keyword">function</span>(oEvent){</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        var iHeightChange = oEvent.clientY - this.iStartHeight;</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RESIZE_EDITING_AREA_BY&quot;</span>, [0, iHeightChange]);</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    },</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    _mouseup : <span class="keyword">function</span>(oEvent){</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;        $(<a class="code" href="html5_8js.html#aa14f8e0338cced6720590fd2ea13bd4b">document</a>).unbind(<span class="stringliteral">&quot;mousemove&quot;</span>, this.$FnMouseMove);</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;        $(<a class="code" href="html5_8js.html#aa14f8e0338cced6720590fd2ea13bd4b">document</a>).unbind(<span class="stringliteral">&quot;mouseup&quot;</span>, this.$FnMouseUp);</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;MSG_EDITING_AREA_RESIZE_ENDED&quot;</span>, [this.$FnMouseDown, this.$FnMouseMove, this.$FnMouseUp]);</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    }</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;});</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_ExecCommand = $.Class({</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_ExecCommand&quot;</span>,</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    oEditingArea : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    $init : <span class="keyword">function</span>(oEditingArea){</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;        this.oEditingArea = oEditingArea;</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;    },</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;    $BEFORE_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        <span class="comment">// the right document will be available only when the src is completely loaded</span></div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        <span class="keywordflow">if</span>(this.oEditingArea &amp;&amp; this.oEditingArea.tagName == <span class="stringliteral">&quot;IFRAME&quot;</span>)</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;            this.oEditingArea = this.oEditingArea.contentWindow.document;</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    },</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_HOTKEY&quot;</span>, [<span class="stringliteral">&quot;ctrl+b&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;bold&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_HOTKEY&quot;</span>, [<span class="stringliteral">&quot;ctrl+u&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;underline&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_HOTKEY&quot;</span>, [<span class="stringliteral">&quot;ctrl+i&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;italic&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_HOTKEY&quot;</span>, [<span class="stringliteral">&quot;ctrl+d&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;strikethrough&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;bold&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;bold&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;underline&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;underline&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;italic&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;italic&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;lineThrough&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;strikethrough&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;superscript&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;superscript&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;subscript&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;subscript&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;justifyleft&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;justifyleft&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;justifycenter&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;justifycenter&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;justifyright&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;justifyright&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;justifyfull&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;justifyfull&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;orderedlist&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;insertorderedlist&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;unorderedlist&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;insertunorderedlist&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;outdent&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;outdent&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;indent&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;indent&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>]]);</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    },</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    $BEFORE_EXECCOMMAND : <span class="keyword">function</span>(sCommand, bUserInterface, vValue){</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;        this._bOnlyCursorChanged = <span class="keyword">false</span>;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;FOCUS&quot;</span>, []);</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;        <span class="keywordflow">if</span>(sCommand.match(/^bold|underline|italic|strikethrough|superscript|subscript$/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>)){</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;            var oSelection = this.oApp.getSelection();</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;            <span class="keywordflow">if</span>(oSelection.collapsed) this._bOnlyCursorChanged = <span class="keyword">true</span>;</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        }</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;        <span class="keywordflow">if</span>(!this._bOnlyCursorChanged){</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_BEFORE_ACTION&quot;</span>, [sCommand]);</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;        }</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    },</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    $ON_EXECCOMMAND : <span class="keyword">function</span>(sCommand, bUserInterface, vValue){</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;        bUserInterface = (bUserInterface == <span class="stringliteral">&quot;&quot;</span> || bUserInterface)?bUserInterface:<span class="keyword">false</span>;</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;        vValue = (vValue == <span class="stringliteral">&quot;&quot;</span> || vValue)?vValue:<span class="keyword">false</span>;</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;        this.oEditingArea.execCommand(sCommand, bUserInterface, vValue);</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;    },</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    $AFTER_EXECCOMMAND : <span class="keyword">function</span>(sCommand, bUserInterface, vValue){</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;        <span class="keywordflow">if</span>(!this._bOnlyCursorChanged){</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_AFTER_ACTION&quot;</span>, [sCommand]);</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;        }</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []);</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    }</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;});</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_WYSIWYGEnterKey = $.Class({</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_WYSIWYGEnterKey&quot;</span>,</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <span class="comment">// IE/Opera do not need this</span></div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;    unsupportedBrowser : [<span class="stringliteral">&#39;ie&#39;</span>, <span class="stringliteral">&#39;opera&#39;</span>],</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    oEditingArea : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    $init : <span class="keyword">function</span>(oEditingArea){</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;        this.oEditingArea = oEditingArea;</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    },</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    $BEFORE_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;        <span class="comment">// the right document will be available only when the src is completely loaded</span></div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;        <span class="keywordflow">if</span>(this.oEditingArea &amp;&amp; this.oEditingArea.tagName == <span class="stringliteral">&quot;IFRAME&quot;</span>)</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;            this.oEditingArea = this.oEditingArea.contentWindow.document;</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    },</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    $ON_EVENT_EDITING_AREA_KEYDOWN : <span class="keyword">function</span>(oEvent){</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;        <span class="keywordflow">if</span>(this.oApp.getEditingMode() != <span class="stringliteral">&quot;WYSIWYG&quot;</span>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;        <span class="keywordflow">if</span>(oEvent.shiftKey) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;        <span class="keywordflow">if</span>(oEvent.keyCode == 13){</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;            var oSelection = this.oApp.getSelection();</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;            var sBM = oSelection.placeStringBookmark();</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;            var oLineInfo = oSelection.getLineInfo();</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;            var oStart = oLineInfo.oStart;</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;            var oEnd = oLineInfo.oEnd;</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;            <span class="comment">//top.document.title = oStart.oNode.tagName+&quot;:&quot;+oStart.oNode.nodeValue+&quot;, &quot;+oEnd.oNode.tagName+&quot;:&quot;+oEnd.oNode.nodeValue+&quot;::&quot;+oStart.bParentBreak+&quot;, &quot;+oStart.oLineBreaker.tagName;</span></div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;            <span class="comment">// line broke by sibling</span></div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;            <span class="comment">// or</span></div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;            <span class="comment">// the parent line breaker is just a block container</span></div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;            <span class="keywordflow">if</span>(!oStart.bParentBreak || oSelection.rxBlockContainer.test(oStart.oLineBreaker.tagName)){</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;                oEvent.stopPropagation();</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;                oEvent.preventDefault();</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                var oSWrapper = this.oEditingArea.createElement(<span class="stringliteral">&quot;P&quot;</span>);</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                oSelection.moveToBookmark(sBM);</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;                oSelection.setStartBefore(oStart.oNode);</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;                oSelection.surroundContents(oSWrapper);</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                oSelection.collapseToEnd();</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;                var oEWrapper = this.oEditingArea.createElement(<span class="stringliteral">&quot;P&quot;</span>);</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;                oSelection.setEndAfter(oEnd.oNode);</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;                oSelection.surroundContents(oEWrapper);</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;                oSelection.removeStringBookmark(sBM);</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;                <span class="keywordflow">if</span>(oSWrapper.innerHTML == <span class="stringliteral">&quot;&quot;</span>) oSWrapper.innerHTML = <span class="stringliteral">&quot;&lt;br&gt;&quot;</span>;</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                <span class="keywordflow">if</span>(oEWrapper.innerHTML == <span class="stringliteral">&quot;&quot;</span>) oEWrapper.innerHTML = <span class="stringliteral">&quot;&lt;br&gt;&quot;</span>;</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;                <span class="keywordflow">if</span>(oEWrapper.nextSibling &amp;&amp; oEWrapper.nextSibling.tagName == <span class="stringliteral">&quot;BR&quot;</span>) oEWrapper.parentNode.removeChild(oEWrapper.nextSibling);</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;                oSelection.selectNodeContents(oEWrapper);</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;                oSelection.collapseToStart();</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;                oSelection.select();</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;                this.oApp.exec(<span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []);</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                oSelection.removeStringBookmark(sBM);</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;            }</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        }</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;    }</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;});</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_WYSIWYGStyler = $.Class({</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_WYSIWYGStyler&quot;</span>,</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    $PRECONDITION : <span class="keyword">function</span>(sFullCommand, aArgs){</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;        <span class="keywordflow">return</span> (this.oApp.getEditingMode() == <span class="stringliteral">&quot;WYSIWYG&quot;</span>);</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    },</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;    $ON_SET_WYSIWYG_STYLE : <span class="keyword">function</span>(oStyles){</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;        var oSelection = this.oApp.getSelection();</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;        <span class="comment">// style cursor</span></div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;        <span class="keywordflow">if</span>(oSelection.collapsed){</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;            var oSpan = this.oApp.getWYSIWYGDocument().createElement(<span class="stringliteral">&quot;SPAN&quot;</span>);</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;            oSelection.insertNode(oSpan);</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;            oSpan.innerHTML = <a class="code" href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a>(<span class="stringliteral">&quot;%uFEFF&quot;</span>);</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;            var sValue;</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;            <span class="keywordflow">for</span>(var sName in oStyles){</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;                sValue = oStyles[sName];</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                <span class="keywordflow">if</span>(typeof sValue != <span class="stringliteral">&quot;string&quot;</span>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                oSpan.style[sName] = sValue;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;            }</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;            oSelection.selectNodeContents(oSpan);</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;            oSelection.collapseToEnd();</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;            oSelection._window.focus();</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;            oSelection._window.document.body.focus();</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;            oSelection.select();</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;            <span class="comment">// FF3 will actually display %uFEFF when it is followed by a number AND certain font-family is used(like Gulim), so remove the chcaracter for FF3</span></div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            <span class="keywordflow">if</span>($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.mozilla &amp;&amp; $.browser.nVersion == 3)</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;                oSpan.innerHTML = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;        }</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_BEFORE_ACTION&quot;</span>, [<span class="stringliteral">&quot;FONT STYLE&quot;</span>]);</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;        oSelection.styleRange(oStyles);</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;        oSelection._window.focus();</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;        oSelection.select();</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_AFTER_ACTION&quot;</span>, [<span class="stringliteral">&quot;FONT STYLE&quot;</span>]);</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    }</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;});</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_WYSIWYGStyleGetter = $.Class({</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_WYSIWYGStyleGetter&quot;</span>,</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    hKeyUp : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;    getStyleInterval : 200,</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;    oStyleMap : {</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;        fontFamily : {</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;            type : <span class="stringliteral">&quot;Value&quot;</span>,</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;            <a class="code" href="admin_2tpl_2js_2jquery_8jstree_8js.html#afba6effcee365bc3169e58b1b3627ee9">css</a> : <span class="stringliteral">&quot;fontFamily&quot;</span></div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;        },</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;        fontSize : {</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;            type : <span class="stringliteral">&quot;Value&quot;</span>,</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;            <a class="code" href="admin_2tpl_2js_2jquery_8jstree_8js.html#afba6effcee365bc3169e58b1b3627ee9">css</a> : <span class="stringliteral">&quot;fontSize&quot;</span></div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;        },</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;        lineHeight : {</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;            type : <span class="stringliteral">&quot;Value&quot;</span>,</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;            <a class="code" href="admin_2tpl_2js_2jquery_8jstree_8js.html#afba6effcee365bc3169e58b1b3627ee9">css</a> : <span class="stringliteral">&quot;lineHeight&quot;</span>,</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;            converter : <span class="keyword">function</span>(sValue, oStyle){</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                <span class="keywordflow">if</span>(!sValue.match(/px$/)) <span class="keywordflow">return</span> sValue;</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;                <span class="keywordflow">return</span> Math.ceil((parseInt(sValue)/parseInt(oStyle.fontSize))*10)/10;</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;            }</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;        },</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;        bold : {</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;            command : <span class="stringliteral">&quot;bold&quot;</span></div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;        },</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;        underline : {</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;            command : <span class="stringliteral">&quot;underline&quot;</span></div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;        },</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;        italic : {</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;            command : <span class="stringliteral">&quot;italic&quot;</span></div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;        },</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;        lineThrough : {</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;            command : <span class="stringliteral">&quot;strikethrough&quot;</span></div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;        },</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;        superscript : {</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;            command : <span class="stringliteral">&quot;superscript&quot;</span></div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;        },</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        subscript : {</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;            command : <span class="stringliteral">&quot;subscript&quot;</span></div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        },</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;        justifyleft : {</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;            command : <span class="stringliteral">&quot;justifyleft&quot;</span></div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        },</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;        justifycenter : {</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;            command : <span class="stringliteral">&quot;justifycenter&quot;</span></div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;        },</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;        justifyright : {</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;            command : <span class="stringliteral">&quot;justifyright&quot;</span></div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        },</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        justifyfull : {</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;            command : <span class="stringliteral">&quot;justifyfull&quot;</span></div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        },</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        orderedlist : {</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;            command : <span class="stringliteral">&quot;insertorderedlist&quot;</span></div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;        },</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        unorderedlist : {</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;            command : <span class="stringliteral">&quot;insertunorderedlist&quot;</span></div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;        }</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    },</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;    $init : <span class="keyword">function</span>(){</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;        this.oStyle = this._getBlankStyle();</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    },</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;    $PRECONDITION : <span class="keyword">function</span>(){</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;        <span class="keywordflow">if</span>(this.oApp.getEditingMode() != <span class="stringliteral">&quot;WYSIWYG&quot;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    },</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;        this.oDocument = this.oApp.getWYSIWYGDocument();</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;getCurrentStyle&quot;</span>, $.fnBind(this.getCurrentStyle, <span class="keyword">this</span>)]);</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    },</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;    $ON_EVENT_EDITING_AREA_MOUSEUP : <span class="keyword">function</span>(oEvnet){</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;        <span class="keywordflow">if</span>(this.hKeyUp) clearTimeout(this.hKeyUp);</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []);</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    },</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;    $ON_EVENT_EDITING_AREA_KEYUP : <span class="keyword">function</span>(oEvent){</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="comment">        backspace 8</span></div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="comment">        page up 33</span></div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="comment">        page down 34</span></div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;<span class="comment">        end 35</span></div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="comment">        home 36</span></div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;<span class="comment">        left arrow 37</span></div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;<span class="comment">        up arrow 38</span></div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;<span class="comment">        right arrow 39</span></div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;<span class="comment">        down arrow 40</span></div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;<span class="comment">        insert 45</span></div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;<span class="comment">        delete 46</span></div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        <span class="keywordflow">if</span>(!(oEvent.keyCode == 8 || (oEvent.keyCode &gt;= 33 &amp;&amp; oEvent.keyCode &lt;= 40) || oEvent.keyCode == 45 || oEvent.keyCode == 46)) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;        <span class="keywordflow">if</span>(this.hKeyUp) clearTimeout(this.hKeyUp);</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;        this.hKeyUp = setTimeout($.fnBind(this.oApp.exec, <span class="keyword">this</span>.oApp, <span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []), <span class="keyword">this</span>.getStyleInterval);</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;    },</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;    $ON_CHECK_STYLE_CHANGE : <span class="keyword">function</span>(){</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;        this._getStyle();</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    },</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;    $ON_RESET_STYLE_STATUS : <span class="keyword">function</span>(){</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        var oBlankStyle = this._getBlankStyle();</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;        <span class="keywordflow">for</span>(var sAttributeName in oBlankStyle)</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;SET_STYLE_STATUS&quot;</span>, [sAttributeName, oBlankStyle[sAttributeName]]);</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;    },</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    getCurrentStyle : <span class="keyword">function</span>(){</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;        <span class="keywordflow">return</span> this.oStyle;</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;    },</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    _check_style_change : <span class="keyword">function</span>(){</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []);</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;    },</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    _getBlankStyle : <span class="keyword">function</span>(){</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        var oBlankStyle = {};</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;        <span class="keywordflow">for</span>(var attributeName in this.oStyleMap){</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;            <span class="keywordflow">if</span>(this.oStyleMap[attributeName].type == <span class="stringliteral">&quot;Value&quot;</span>)</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;                oBlankStyle[attributeName] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;                oBlankStyle[attributeName] = 0;</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;        }</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;        <span class="keywordflow">return</span> oBlankStyle;</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    },</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    _getStyle : <span class="keyword">function</span>(){</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;        var oSelection = this.oApp.getSelection();</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;        var funcFilter = <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;            <span class="keywordflow">if</span> (!oNode.childNodes || oNode.childNodes.length == 0)</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;        }</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;        var aBottomNodes = oSelection.getNodes(<span class="keyword">false</span>, funcFilter);</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;        var oStyle, oBaseStyle, oTmpStyle, attributeName;</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;        <span class="keywordflow">if</span>(aBottomNodes.length == 0){</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;            oStyle = this._getStyleOf(oSelection.commonAncestorContainer);</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;            oStyle = this._getStyleOf(aBottomNodes[0]);</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;        }</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;        <span class="keywordflow">for</span>(attributeName in oStyle){</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;            <span class="keywordflow">if</span>(this.oStyleMap[attributeName].converter){</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;                oStyle[attributeName] = this.oStyleMap[attributeName].converter(oStyle[attributeName], oStyle);</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;            }</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;            <span class="keywordflow">if</span>(this.oStyle[attributeName] != oStyle[attributeName])</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;                this.oApp.exec(<span class="stringliteral">&quot;MSG_STYLE_CHANGED&quot;</span>, [attributeName, oStyle[attributeName]]);</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;        }</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;        this.oStyle = oStyle;</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    },</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    _getStyleOf : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;        var oStyle = this._getBlankStyle();</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;        <span class="comment">// this must not happen</span></div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;        <span class="keywordflow">if</span>(!oNode) <span class="keywordflow">return</span> oStyle;</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;        <span class="keywordflow">if</span>(oNode.nodeType == 3) oNode = oNode.parentNode;</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;        var welNode = $(oNode);</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;        var attribute, cssName;</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;        <span class="keywordflow">for</span>(var styleName in this.oStyle){</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;            attribute = this.oStyleMap[styleName];</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;            <span class="keywordflow">if</span>(attribute.type &amp;&amp; attribute.type == <span class="stringliteral">&quot;Value&quot;</span>){</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                <span class="keywordflow">if</span>(attribute.css){</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;                    var sValue = welNode.css(attribute.css);</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                    <span class="keywordflow">if</span>(styleName == <span class="stringliteral">&quot;fontFamily&quot;</span>){</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;                        sValue = sValue.split(/,/)[0];</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                    }</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;                    oStyle[styleName] = sValue;</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;                }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;                    <span class="keywordflow">if</span>(attribute.command){</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;                        <span class="keywordflow">try</span>{</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;                            oStyle[styleName] = this.oDocument.queryCommandState(attribute.command);</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;                        }<span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){}</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;                    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;                        <span class="comment">// todo</span></div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;                    }</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;                }</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                <span class="keywordflow">if</span>(attribute.command){</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;                    <span class="keywordflow">try</span>{</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;                        <span class="keywordflow">if</span>(this.oDocument.queryCommandState(attribute.command)){</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;                            oStyle[styleName] = 1;</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;                        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                            oStyle[styleName] = 0;</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                        }</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                    }<span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){}</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;                }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;                    <span class="comment">// todo</span></div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;                }</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;            }</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;        }</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;        <span class="keywordflow">return</span> oStyle;</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;    }</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;});</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_FontSizeWithSelectUI = $.Class({</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_FontSizeWithSelectUI&quot;</span>,</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    $init : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;        this._assignHTMLObjects(elAppContainer);</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    },</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;        this.elFontSizeSelect = $(<span class="stringliteral">&quot;SELECT.xpress_xeditor_ui_fontSize_select&quot;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;    },</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;        this.oApp.registerBrowserEvent(this.elFontSizeSelect, <span class="stringliteral">&quot;change&quot;</span>, <span class="stringliteral">&quot;SET_FONTSIZE_FROM_SELECT_UI&quot;</span>);</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;        this.elFontSizeSelect.selectedIndex = 0;</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;    },</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    $ON_MSG_STYLE_CHANGED : <span class="keyword">function</span>(sAttributeName, sAttributeValue){</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;        <span class="keywordflow">if</span>(sAttributeName == <span class="stringliteral">&quot;fontSize&quot;</span>){</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;            this.elFontSizeSelect.value = sAttributeValue;</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;            <span class="keywordflow">if</span>(this.elFontSizeSelect.selectedIndex &lt; 0) this.elFontSizeSelect.selectedIndex = 0;</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;        }</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;    },</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;    $ON_SET_FONTSIZE_FROM_SELECT_UI : <span class="keyword">function</span>(){</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;        var sFontSize = this.elFontSizeSelect.value;</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;        <span class="keywordflow">if</span>(!sFontSize) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SET_WYSIWYG_STYLE&quot;</span>, [{<span class="stringliteral">&quot;fontSize&quot;</span>:sFontSize}]);</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []);</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;    }</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;});</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_FontNameWithSelectUI = $.Class({</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_FontNameWithSelectUI&quot;</span>,</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;    $init : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;        this._assignHTMLObjects(elAppContainer);</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    },</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;        this.elFontNameSelect = $(<span class="stringliteral">&quot;SELECT.xpress_xeditor_ui_fontName_select&quot;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    },</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;        this.oApp.registerBrowserEvent(this.elFontNameSelect, <span class="stringliteral">&quot;change&quot;</span>, <span class="stringliteral">&quot;SET_FONTNAME_FROM_SELECT_UI&quot;</span>);</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;        this.elFontNameSelect.selectedIndex = 0;</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;    },</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;    $ON_MSG_STYLE_CHANGED : <span class="keyword">function</span>(sAttributeName, sAttributeValue){</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;        <span class="keywordflow">if</span>(sAttributeName == <span class="stringliteral">&quot;fontFamily&quot;</span>){</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;            this.elFontNameSelect.value = sAttributeValue.toLowerCase();</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;            <span class="keywordflow">if</span>(this.elFontNameSelect.selectedIndex &lt; 0) this.elFontNameSelect.selectedIndex = 0;</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;        }</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;    },</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;    $ON_SET_FONTNAME_FROM_SELECT_UI : <span class="keyword">function</span>(){</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;        var sFontName = this.elFontNameSelect.value;</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;        <span class="keywordflow">if</span>(!sFontName) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SET_WYSIWYG_STYLE&quot;</span>, [{<span class="stringliteral">&quot;fontFamily&quot;</span>:sFontName}]);</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []);</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    }</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;});</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_LineHeight = $.Class({</div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_LineHeight&quot;</span>,</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;    $init : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        this._assignHTMLObjects(oAppContainer);</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    },</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    },</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    $ON_SET_LINEHEIGHT : <span class="keyword">function</span>(nLineHeight){</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;        this.setLineHeight(nLineHeight);</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;    },</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    getLineHeight : <span class="keyword">function</span>(){</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        var nodes = this._getSelectedNodes(<span class="keyword">false</span>);</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;        var curWrapper, prevWrapper;</div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;        var iCurHeight, iHeight;</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;        <span class="keywordflow">if</span>(nodes.length == 0) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;        var iLength = nodes.length;</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;        <span class="keywordflow">if</span>(iLength == 0){</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;            iHeight = -1;</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;            prevWrapper = this._getLineWrapper(nodes[0]);</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;            iHeight = this._getWrapperLineheight(prevWrapper);</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;        }</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;        var firstNode = this.oSelection.getStartNode();</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;        <span class="keywordflow">if</span>(iHeight &gt; 0){</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;            <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=1; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;iLength; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;                <span class="keywordflow">if</span>(this._isChildOf(nodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>], curWrapper)) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;                <span class="keywordflow">if</span>(!nodes[i]) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;                curWrapper = this._getLineWrapper(nodes[i]);</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;                <span class="keywordflow">if</span>(curWrapper == prevWrapper) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;                curHeight = this._getWrapperLineheight(curWrapper);</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;                <span class="keywordflow">if</span>(curHeight != iHeight){</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;                    iHeight = -1;</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;                }</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;                prevWrapper = curWrapper;</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;            }</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;        }</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;        curWrapper = this._getLineWrapper(nodes[iLength-1]);</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;        var lastNode = this.oSelection.getEndNode();</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;        selectText = $.fnBind(<span class="keyword">function</span>(firstNode, lastNode){</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;            this.oSelection.setEndNodes(firstNode, lastNode);</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;            this.oSelection.select();</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;        }, <span class="keyword">this</span>, firstNode, lastNode);</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;        setTimeout(selectText, 100);</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;        <span class="keywordflow">return</span> iHeight;</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;    },</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;    <span class="comment">// height in percentage. For example pass 1 to set the line height to 100% and 1.5 to set it to 150%</span></div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;    setLineHeight : <span class="keyword">function</span>(height) {</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;        thisRef = <span class="keyword">this</span>;</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;        <span class="keyword">function</span> _setLineheight(div, height){</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;            <span class="keywordflow">if</span>(!div){</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;                <span class="comment">// try to wrap with P first</span></div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;                <span class="keywordflow">try</span>{</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;                    div = thisRef.oSelection.surroundContentsWithNewNode(<span class="stringliteral">&quot;P&quot;</span>);</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;                <span class="comment">// if the range contains a block-level tag, wrap it with a DIV</span></div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;                }<span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;                    div = thisRef.oSelection.surroundContentsWithNewNode(<span class="stringliteral">&quot;DIV&quot;</span>);</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;                }</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;            }</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;            div.style.lineHeight = height;</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;            <span class="keywordflow">return</span> div;</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;        }</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;        <span class="keyword">function</span> isInBody(node){</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;            <span class="keywordflow">while</span>(node &amp;&amp; node.tagName != <span class="stringliteral">&quot;BODY&quot;</span>){</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;                node = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(node);</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;            }</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;            <span class="keywordflow">if</span>(!node) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;        }</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;        var nodes = this._getSelectedNodes(<span class="keyword">false</span>);</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;        <span class="keywordflow">if</span>(nodes.length == 0){</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;        }</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;        var curWrapper, prevWrapper;</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;        var iLength = nodes.length;</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_BEFORE_ACTION&quot;</span>, [<span class="stringliteral">&quot;LINEHEIGHT&quot;</span>]);</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;        prevWrapper = this._getLineWrapper(nodes[0]);</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;        prevWrapper = _setLineheight(prevWrapper, height);</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;        var startNode = prevWrapper;</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;        var endNode = prevWrapper;</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=1; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;iLength; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;            <span class="comment">// Skip the node if a copy of the node were wrapped and the actual node no longer exists within the document.</span></div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;            <span class="keywordflow">try</span>{</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;                <span class="keywordflow">if</span>(!isInBody(<a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(nodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>]))) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;            }<span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){<span class="keywordflow">continue</span>;}</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;            <span class="keywordflow">if</span>(this._isChildOf(nodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>], curWrapper)) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;            curWrapper = this._getLineWrapper(nodes[i]);</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;            <span class="keywordflow">if</span>(curWrapper == prevWrapper) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;            curWrapper = _setLineheight(curWrapper, height);</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;            prevWrapper = curWrapper;</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;        }</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;        endNode = curWrapper || startNode;</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;        setTimeout($.fnBind(<span class="keyword">function</span>(startNode, endNode){</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;            this.oSelection.setEndNodes(startNode, endNode);</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;            this.oSelection.select();</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_AFTER_ACTION&quot;</span>, [<span class="stringliteral">&quot;LINEHEIGHT&quot;</span>]);</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;        }, <span class="keyword">this</span>, startNode, endNode), 100);</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;    },</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;    _getSelectedNodes : <span class="keyword">function</span>(bDontUpdate){</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;        <span class="keywordflow">if</span>(!bDontUpdate)</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;            this.oSelection = this.oApp.getSelection();</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;        <span class="keywordflow">if</span>(this.oSelection.collapsed) this.oSelection.selectNode(this.oSelection.commonAncestorContainer);</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;        var nodes = this.oSelection.getTextNodes();</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;        <span class="keywordflow">if</span>(nodes.length == 0){</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;            var tmp = this.oSelection.getStartNode();</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;            <span class="keywordflow">if</span>(tmp){</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;                nodes[0] = tmp;</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;                nodes = [];</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;            }</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;        }</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;        <span class="keywordflow">return</span> nodes;</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;    },</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;    _getWrapperLineheight : <span class="keyword">function</span>(div){</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;        var iLineHeight = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;        <span class="keywordflow">if</span>(div &amp;&amp; div.style.lineHeight){</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;            iLineHeight = div.style.lineHeight;</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;            div = this.oSelection.commonAncesterContainer;</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;            <span class="keywordflow">while</span>(div &amp;&amp; !this.oSelection.rxLineBreaker.test(div.tagName)){</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;                <span class="keywordflow">if</span>(div &amp;&amp; div.style.lineHeight){</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;                    iLineHeight = div.style.lineHeight;</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;                }</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;                div = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(div);</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;            }</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;        }</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;        <span class="keywordflow">return</span> iLineHeight;</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;    },</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;    _isChildOf : <span class="keyword">function</span>(node, container){</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;        <span class="keywordflow">while</span>(node &amp;&amp; node.tagName != <span class="stringliteral">&quot;BODY&quot;</span>){</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;            <span class="keywordflow">if</span>(node == container) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;            node = <a class="code" href="namespacexe.html">xe</a>.DOMFix.parentNode(node);</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;        }</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    },</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    _getLineWrapper : <span class="keyword">function</span>(node){</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;        var oTmpSelection = this.oApp.getEmptySelection();</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;        oTmpSelection.selectNode(node);</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;        var oLineInfo = oTmpSelection.getLineInfo();</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;        var oStart = oLineInfo.oStart;</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;        var oEnd = oLineInfo.oEnd;</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;        var <a class="code" href="modernizr_8min_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a>, <a class="code" href="jquery-1_8x_8min_8js.html#a14e11a60aa3603727bb80abf8f71a4d5">b</a>;</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        var breakerA, breakerB;</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;        var div = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        a = oStart.oNode;</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;        breakerA = oStart.oLineBreaker;</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        b = oEnd.oNode;</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        breakerB = oEnd.oLineBreaker;</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;        this.oSelection.setEndNodes(a, b);</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;        <span class="keywordflow">if</span>(breakerA == breakerB){</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;            <span class="keywordflow">if</span>(breakerA.tagName == <span class="stringliteral">&quot;P&quot;</span> || breakerA.tagName == <span class="stringliteral">&quot;DIV&quot;</span>){</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;                div = breakerA;</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;                this.oSelection.setEndNodes(breakerA.firstChild, breakerA.lastChild);</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;            }</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        }</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;        <span class="keywordflow">return</span> div;</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;    }</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160; });</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_LineHeightWithSelectUI = $.Class({</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_LineHeightWithSelectUI&quot;</span>,</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;        this.elLineHeightSelect = $(<span class="stringliteral">&quot;SELECT.xpress_xeditor_ui_lineHeight_select&quot;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;    },</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;        this.oApp.registerBrowserEvent(this.elLineHeightSelect, <span class="stringliteral">&quot;change&quot;</span>, <span class="stringliteral">&quot;SET_LINEHEIGHT_FROM_SELECT_UI&quot;</span>);</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;        this.elLineHeightSelect.selectedIndex = 0;</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    },</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;    $ON_MSG_STYLE_CHANGED : <span class="keyword">function</span>(sAttributeName, sAttributeValue){</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;        <span class="keywordflow">if</span>(sAttributeName == <span class="stringliteral">&quot;lineHeight&quot;</span>){</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;            this.elLineHeightSelect.value = sAttributeValue;</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;            <span class="keywordflow">if</span>(this.elLineHeightSelect.selectedIndex &lt; 0) this.elLineHeightSelect.selectedIndex = 0;</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;        }</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;    },</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;    $ON_SET_LINEHEIGHT_FROM_SELECT_UI : <span class="keyword">function</span>(){</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;        var nLineHeight = this.elLineHeightSelect.value;</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;        <span class="keywordflow">if</span>(!nLineHeight) <span class="keywordflow">return</span>;</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;        this.elLineHeightSelect.selectedIndex = 0;</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SET_LINEHEIGHT&quot;</span>, [nLineHeight]);</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []);</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;    }</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;}).<a class="code" href="jquery_8js.html#a84ade6b4c0a71f54664069487f2526dc">extend</a>(<a class="code" href="namespacexe.html">xe</a>.XE_LineHeight);</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;<span class="comment"></span> <a class="code" href="namespacexe.html">xe</a>.XE_ColorPalette = $.Class({</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_ColorPalette&quot;</span>,</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    rxRGBColorPattern : /rgb\((<a class="code" href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">\d</a>+), ?(\<a class="code" href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">d</a>+), ?(<a class="code" href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">\d</a>+)\)/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>,</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;    $init : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;        this._assignHTMLObjects(oAppContainer);</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;    },</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;        this.elColorPaletteLayer = $(<span class="stringliteral">&quot;UL.xpress_xeditor_color_palette&quot;</span>, oAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;    },</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;        this.oApp.registerBrowserEvent(this.elColorPaletteLayer, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EVENT_MOUSEUP_COLOR_PALETTE&quot;</span>);</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;    },</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;    $ON_SHOW_COLOR_PALETTE : <span class="keyword">function</span>(sCallbackCmd, oLayerContainer){</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;        this.sCallbackCmd = sCallbackCmd;</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;        this.oLayerContainer = oLayerContainer;</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;        this.oLayerContainer.insertBefore(this.elColorPaletteLayer, <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>);</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;        this.elColorPaletteLayer.style.display = <span class="stringliteral">&quot;block&quot;</span>;</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    },</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    $ON_HIDE_COLOR_PALETTE : <span class="keyword">function</span>(){</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;        this.elColorPaletteLayer.style.display = <span class="stringliteral">&quot;none&quot;</span>;</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    },</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    $ON_COLOR_PALETTE_APPLY_COLOR : <span class="keyword">function</span>(sColorCode){</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;        <span class="keywordflow">if</span>(this.rxRGBColorPattern.test(sColorCode)){</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;            <span class="keyword">function</span> dec2Hex(sDec){</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;                var sTmp = parseInt(sDec).toString(16);</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;                <span class="keywordflow">if</span>(sTmp.length&lt;2) sTmp = <span class="stringliteral">&quot;0&quot;</span>+sTmp;</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;                <span class="keywordflow">return</span> sTmp.toUpperCase();</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;            }</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;            var sR = dec2Hex(RegExp.$1);</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;            var sG = dec2Hex(RegExp.$2);</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;            var sB = dec2Hex(RegExp.$3);</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;            sColorCode = <span class="stringliteral">&quot;#&quot;</span>+sR+sG+sB;</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;        }</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        this.oApp.exec(this.sCallbackCmd, [sColorCode]);</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;    },</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;    $ON_EVENT_MOUSEUP_COLOR_PALETTE : <span class="keyword">function</span>(oEvent){</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;        var elButton = oEvent.target;</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        <span class="keywordflow">if</span>(! elButton.style.backgroundColor) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;COLOR_PALETTE_APPLY_COLOR&quot;</span>, [elButton.style.backgroundColor]);</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    }</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;});</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_FontColor = $.Class({</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_FontColor&quot;</span>,</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;    rxColorPattern : /^#?[0-9a-fA-F]{6}$|^rgb\(<a class="code" href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">\d</a>+, ?<a class="code" href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">\d</a>+, ?\d+\)$/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>,</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;    $init : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        this._assignHTMLObjects(elAppContainer);</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;    },</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;        this.elDropdownLayer = $(<span class="stringliteral">&quot;DIV.xpress_xeditor_fontcolor_layer&quot;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;    },</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;fontColor&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;TOGGLE_FONTCOLOR_LAYER&quot;</span>]);</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;    },</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;    $ON_TOGGLE_FONTCOLOR_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;TOGGLE_TOOLBAR_ACTIVE_LAYER&quot;</span>, [this.elDropdownLayer, <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, <span class="stringliteral">&quot;SHOW_COLOR_PALETTE&quot;</span>, [<span class="stringliteral">&quot;APPLY_FONTCOLOR&quot;</span>, this.elDropdownLayer]]);</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    },</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    $ON_APPLY_FONTCOLOR : <span class="keyword">function</span>(sFontColor){</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;        <span class="keywordflow">if</span>(!this.rxColorPattern.test(sFontColor)){</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;            alert(this.oApp.$MSG(<span class="stringliteral">&quot;XE_FontColor.invalidColorCode&quot;</span>));</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;        }</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SET_WYSIWYG_STYLE&quot;</span>, [{<span class="stringliteral">&quot;color&quot;</span>:sFontColor}]);</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>);</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    }</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;});</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_BGColor = $.Class({</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_BGColor&quot;</span>,</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;    rxColorPattern : /^#?[0-9a-fA-F]{6}$|^rgb\(<a class="code" href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">\d</a>+, ?<a class="code" href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">\d</a>+, ?\d+\)$/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>,</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;    $init : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;        this._assignHTMLObjects(elAppContainer);</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    },</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;        this.elDropdownLayer = $(<span class="stringliteral">&quot;DIV.xpress_xeditor_bgcolor_layer&quot;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    },</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;bgColor&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;TOGGLE_BGCOLOR_LAYER&quot;</span>]);</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;        this.oApp.registerBrowserEvent(this.elDropdownLayer, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EVENT_APPLY_BGCOLOR&quot;</span>, []);</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;    },</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;    $ON_TOGGLE_BGCOLOR_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;TOGGLE_TOOLBAR_ACTIVE_LAYER&quot;</span>, [this.elDropdownLayer, <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, <span class="stringliteral">&quot;SHOW_COLOR_PALETTE&quot;</span>, [<span class="stringliteral">&quot;APPLY_BGCOLOR&quot;</span>, this.elDropdownLayer]]);</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;    },</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;    $ON_EVENT_APPLY_BGCOLOR : <span class="keyword">function</span>(weEvent){</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;        var elButton = weEvent.target;</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;        <span class="comment">// Safari/Chrome/Opera may capture the event on Span</span></div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;        <span class="keywordflow">if</span>(elButton.tagName == <span class="stringliteral">&quot;SPAN&quot;</span>) elButton = elButton.parentNode;</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;        <span class="keywordflow">if</span>(elButton.tagName != <span class="stringliteral">&quot;BUTTON&quot;</span>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;        var sBGColor, sFontColor;</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;        sBGColor = elButton.style.backgroundColor;</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;        sFontColor = elButton.style.color;</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;APPLY_BGCOLOR&quot;</span>, [sBGColor, sFontColor]);</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;    },</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;    $ON_APPLY_BGCOLOR : <span class="keyword">function</span>(sBGColor, sFontColor){</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;        <span class="keywordflow">if</span>(!this.rxColorPattern.test(sBGColor)){</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;            alert(this.oApp.$MSG(<span class="stringliteral">&quot;XE_BGColor.invalidColorCode&quot;</span>));</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;        }</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;        var oStyle = {<span class="stringliteral">&quot;backgroundColor&quot;</span>: sBGColor}</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;        <span class="keywordflow">if</span>(sFontColor) oStyle.color = sFontColor;</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SET_WYSIWYG_STYLE&quot;</span>, [oStyle]);</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>);</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;    }</div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;});</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_Quote = $.Class({</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_Quote&quot;</span>,</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    $init : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;        this._assignHTMLObjects(elAppContainer);</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;    },</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;        this.elDropdownLayer = $(<span class="stringliteral">&quot;DIV.xpress_xeditor_blockquote_layer&quot;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;    },</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;    $ON_MSG_APP_READY: <span class="keyword">function</span>(){</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;quote&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;TOGGLE_BLOCKQUOTE_LAYER&quot;</span>]);</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;        this.oApp.registerBrowserEvent(this.elDropdownLayer, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EVENT_APPLY_SEDITOR_BLOCKQUOTE&quot;</span>, []);</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;    },</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;    $ON_TOGGLE_BLOCKQUOTE_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;TOGGLE_TOOLBAR_ACTIVE_LAYER&quot;</span>, [this.elDropdownLayer]);</div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;    },</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;    $ON_EVENT_APPLY_SEDITOR_BLOCKQUOTE : <span class="keyword">function</span>(weEvent){</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;        var elButton = weEvent.target;</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;        <span class="keywordflow">if</span>(elButton.tagName != <span class="stringliteral">&quot;BUTTON&quot;</span>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;        var sClass = elButton.parentNode.className;</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;        <span class="keywordflow">if</span>(sClass != <span class="stringliteral">&quot;q8&quot;</span>)</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;            this._wrapBlock(<span class="stringliteral">&quot;BLOCKQUOTE&quot;</span>, sClass);</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;            this._unwrapBlock(<span class="stringliteral">&quot;BLOCKQUOTE&quot;</span>);</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>, []);</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;    },</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;    _unwrapBlock : <span class="keyword">function</span>(<a class="code" href="classtag.html">tag</a>){</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;        var oSelection = this.oApp.getSelection();</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;        var oC = oSelection.commonAncestorContainer;</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;        <span class="keywordflow">while</span>(oC &amp;&amp; oC.tagName != <a class="code" href="classtag.html">tag</a>) oC = oC.parentNode;</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;        <span class="keywordflow">if</span>(!oC) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;        <span class="keywordflow">while</span>(oC.firstChild) oC.parentNode.insertBefore(oC.firstChild, oC);</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;        oC.parentNode.removeChild(oC);</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    },</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    _wrapBlock : <span class="keyword">function</span>(<a class="code" href="classtag.html">tag</a>, className){</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;        var oSelection = this.oApp.getSelection();</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;        var oLineInfo = oSelection.getLineInfo();</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;        var oStart = oLineInfo.oStart;</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;        var oEnd = oLineInfo.oEnd;</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;        var rxDontUseAsWhole = /BODY|TD|LI/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>;</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;        var oStartNode, oEndNode;</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;        <span class="keywordflow">if</span>(oStart.bParentBreak &amp;&amp; !rxDontUseAsWhole.test(oStart.oLineBreaker.tagName)) oStartNode = oStart.oNode.parentNode;</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;        <span class="keywordflow">else</span> oStartNode = oStart.oNode;</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;        <span class="keywordflow">if</span>(oEnd.bParentBreak &amp;&amp; !rxDontUseAsWhole.test(oEnd.oLineBreaker.tagName)) oEndNode = oEnd.oNode.parentNode;</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;        <span class="keywordflow">else</span> oEndNode = oEnd.oNode;</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;        oSelection.setStartBefore(oStartNode);</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;        oSelection.setEndAfter(oEndNode);</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;        var oNode = this._expandToTableStart(oSelection, oEndNode);</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;        <span class="keywordflow">if</span>(oNode){</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;            oEndNode = oNode;</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;            oSelection.setEndAfter(oNode);</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;        }</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;        oNode = this._expandToTableStart(oSelection, oStartNode);</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;        <span class="keywordflow">if</span>(oNode){</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;            oStartNode = oNode;</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;            oSelection.setStartBefore(oNode);</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;        }</div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;        oNode = oStartNode;</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;        var oC = oSelection.commonAncestorContainer;</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;        <span class="comment">// find the insertion position for the formatting tag right beneath the common ancestor container</span></div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;        <span class="keywordflow">while</span>(oNode &amp;&amp; oNode != oC &amp;&amp; oNode.parentNode != oC) oNode = oNode.parentNode;</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;        oFormattingNode = oSelection._document.createElement(<a class="code" href="classtag.html">tag</a>);</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;        <span class="keywordflow">if</span>(className) oFormattingNode.className = className;</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;        <span class="keywordflow">if</span>(oNode == oC){</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;            oC.insertBefore(oFormattingNode, oC.firstChild);</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;            oC.insertBefore(oFormattingNode, oNode);</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;        }</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;        oSelection.setStartAfter(oFormattingNode);</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;        oSelection.setEndAfter(oEndNode);</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;        oSelection.surroundContents(oFormattingNode);</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;        var aNodes = oFormattingNode.childNodes;</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;        var oInsertionPoint;</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=aNodes.length-1; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&gt;=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>--){</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;            <span class="keywordflow">if</span>(aNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].nodeType == 3 || aNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].tagName == <span class="stringliteral">&quot;BR&quot;</span>){</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;                var oP = oSelection._document.createElement(<span class="stringliteral">&quot;P&quot;</span>);</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                oInsertionPoint = aNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].nextSibling;</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                <span class="keywordflow">while</span>(<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&gt;=0 &amp;&amp; aNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>] &amp;&amp; (aNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].nodeType == 3 || aNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].tagName == <span class="stringliteral">&quot;BR&quot;</span>)){</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;                    oP.insertBefore(aNodes[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>--], oP.firstChild);</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;                }</div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;                oFormattingNode.insertBefore(oP, oInsertionPoint);</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;                <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++;</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;            }</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;        }</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;        <span class="keywordflow">if</span>(oFormattingNode &amp;&amp; oFormattingNode.parentNode){</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;            var oP = oSelection._document.createElement(<span class="stringliteral">&quot;P&quot;</span>);</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;            oP.innerHTML = <a class="code" href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a>(<span class="stringliteral">&quot;&lt;br/&gt;&quot;</span>);</div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;            oFormattingNode.parentNode.insertBefore(oP, oFormattingNode.nextSibling);</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;        }</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_ACTION&quot;</span>, [<span class="stringliteral">&quot;Block Quote&quot;</span>]);</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;        <span class="keywordflow">return</span> oFormattingNode;</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;    },</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;    _expandToTableStart : <span class="keyword">function</span>(oSelection, oNode){</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;        var oC = oSelection.commonAncestorContainer;</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;        var oResultNode = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;        var bLastIteration = <span class="keyword">false</span>;</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;        <span class="keywordflow">while</span>(oNode &amp;&amp; !bLastIteration){</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;            <span class="keywordflow">if</span>(oNode == oC) bLastIteration = <span class="keyword">true</span>;</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;            <span class="keywordflow">if</span>(/TBODY|TFOOT|THEAD|TR/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>.test(oNode.tagName)){</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;                oResultNode = this._getTableRoot(oNode);</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;            }</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;            oNode = oNode.parentNode;</div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;        }</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;        <span class="keywordflow">return</span> oResultNode;</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;    },</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;    _getTableRoot : <span class="keyword">function</span>(oNode){</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;        <span class="keywordflow">while</span>(oNode &amp;&amp; oNode.tagName != <span class="stringliteral">&quot;TABLE&quot;</span>) oNode = oNode.parentNode;</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;        <span class="keywordflow">return</span> oNode;</div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;    }</div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;});</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_SCharacter = $.Class({</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_SCharacter&quot;</span>,</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;    $init : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;        this.bIE = $.browser.msie;</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;        this._assignHTMLObjects(oAppContainer);</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;        this.charSet = [];</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;        this.charSet[0] = <a class="code" href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a>(<span class="stringliteral">&#39;FF5B FF5D 3014 3015 3008 3009 300A 300B 300C 300D 300E 300F 3010 3011 2018 2019 201C 201D 3001 3002 %B7 2025 2026 %A7 203B 2606 2605 25CB 25CF 25CE 25C7 25C6 25A1 25A0 25B3 25B2 25BD 25BC 25C1 25C0 25B7 25B6 2664 2660 2661 2665 2667 2663 2299 25C8 25A3 25D0 25D1 2592 25A4 25A5 25A8 25A7 25A6 25A9 %B1 %D7 %F7 2260 2264 2265 221E 2234 %B0 2032 2033 2220 22A5 2312 2202 2261 2252 226A 226B 221A 223D 221D 2235 222B 222C 2208 220B 2286 2287 2282 2283 222A 2229 2227 2228 FFE2 21D2 21D4 2200 2203 %B4 FF5E 02C7 02D8 02DD 02DA 02D9 %B8 02DB %A1 %BF 02D0 222E 2211 220F 266D 2669 266A 266C 327F 2192 2190 2191 2193 2194 2195 2197 2199 2196 2198 321C 2116 33C7 2122 33C2 33D8 2121 2668 260F 260E 261C 261E %B6 2020 2021 %AE %AA %BA 2642 2640&#39;</span>).replace(/(\<a class="code" href="jquery-1_8x_8min_8js.html#a8bab16140cede5f71c657e8dc46c1887">S</a>{4})/<a class="code" href="jquery-1_8x_8min_8js.html#a103df269476e78897c9c4c6cb8f4eb06">g</a>, <span class="keyword">function</span>(a){<span class="keywordflow">return</span> <span class="stringliteral">&quot;%u&quot;</span>+a}).split(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;        this.charSet[1] = <a class="code" href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a>(<span class="stringliteral">&#39;%BD 2153 2154 %BC %BE 215B 215C 215D 215E %B9 %B2 %B3 2074 207F 2081 2082 2083 2084 2160 2161 2162 2163 2164 2165 2166 2167 2168 2169 2170 2171 2172 2173 2174 2175 2176 2177 2178 2179 FFE6 %24 FFE5 FFE1 20AC 2103 212B 2109 FFE0 %A4 2030 3395 3396 3397 2113 3398 33C4 33A3 33A4 33A5 33A6 3399 339A 339B 339C 339D 339E 339F 33A0 33A1 33A2 33CA 338D 338E 338F 33CF 3388 3389 33C8 33A7 33A8 33B0 33B1 33B2 33B3 33B4 33B5 33B6 33B7 33B8 33B9 3380 3381 3382 3383 3384 33BA 33BB 33BC 33BD 33BE 33BF 3390 3391 3392 3393 3394 2126 33C0 33C1 338A 338B 338C 33D6 33C5 33AD 33AE 33AF 33DB 33A9 33AA 33AB 33AC 33DD 33D0 33D3 33C3 33C9 33DC 33C6&#39;</span>).replace(/(\<a class="code" href="jquery-1_8x_8min_8js.html#a8bab16140cede5f71c657e8dc46c1887">S</a>{4})/<a class="code" href="jquery-1_8x_8min_8js.html#a103df269476e78897c9c4c6cb8f4eb06">g</a>, <span class="keyword">function</span>(a){<span class="keywordflow">return</span> <span class="stringliteral">&quot;%u&quot;</span>+a}).split(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;        this.charSet[2] = <a class="code" href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a>(<span class="stringliteral">&#39;3260 3261 3262 3263 3264 3265 3266 3267 3268 3269 326A 326B 326C 326D 326E 326F 3270 3271 3272 3273 3274 3275 3276 3277 3278 3279 327A 327B 24D0 24D1 24D2 24D3 24D4 24D5 24D6 24D7 24D8 24D9 24DA 24DB 24DC 24DD 24DE 24DF 24E0 24E1 24E2 24E3 24E4 24E5 24E6 24E7 24E8 24E9 2460 2461 2462 2463 2464 2465 2466 2467 2468 2469 246A 246B 246C 246D 246E 3200 3201 3202 3203 3204 3205 3206 3207 3208 3209 320A 320B 320C 320D 320E 320F 3210 3211 3212 3213 3214 3215 3216 3217 3218 3219 321A 321B 249C 249D 249E 249F 24A0 24A1 24A2 24A3 24A4 24A5 24A6 24A7 24A8 24A9 24AA 24AB 24AC 24AD 24AE 24AF 24B0 24B1 24B2 24B3 24B4 24B5 2474 2475 2476 2477 2478 2479 247A 247B 247C 247D 247E 247F 2480 2481 2482&#39;</span>).replace(/(\<a class="code" href="jquery-1_8x_8min_8js.html#a8bab16140cede5f71c657e8dc46c1887">S</a>{4})/<a class="code" href="jquery-1_8x_8min_8js.html#a103df269476e78897c9c4c6cb8f4eb06">g</a>, <span class="keyword">function</span>(a){<span class="keywordflow">return</span> <span class="stringliteral">&quot;%u&quot;</span>+a}).split(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;        this.charSet[3] = <a class="code" href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a>(<span class="stringliteral">&#39;3131 3132 3133 3134 3135 3136 3137 3138 3139 313A 313B 313C 313D 313E 313F 3140 3141 3142 3143 3144 3145 3146 3147 3148 3149 314A 314B 314C 314D 314E 314F 3150 3151 3152 3153 3154 3155 3156 3157 3158 3159 315A 315B 315C 315D 315E 315F 3160 3161 3162 3163 3165 3166 3167 3168 3169 316A 316B 316C 316D 316E 316F 3170 3171 3172 3173 3174 3175 3176 3177 3178 3179 317A 317B 317C 317D 317E 317F 3180 3181 3182 3183 3184 3185 3186 3187 3188 3189 318A 318B 318C 318D 318E&#39;</span>).replace(/(\<a class="code" href="jquery-1_8x_8min_8js.html#a8bab16140cede5f71c657e8dc46c1887">S</a>{4})/<a class="code" href="jquery-1_8x_8min_8js.html#a103df269476e78897c9c4c6cb8f4eb06">g</a>, <span class="keyword">function</span>(a){<span class="keywordflow">return</span> <span class="stringliteral">&quot;%u&quot;</span>+a}).split(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;        this.charSet[4] = <a class="code" href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a>(<span class="stringliteral">&#39;0391 0392 0393 0394 0395 0396 0397 0398 0399 039A 039B 039C 039D 039E 039F 03A0 03A1 03A3 03A4 03A5 03A6 03A7 03A8 03A9 03B1 03B2 03B3 03B4 03B5 03B6 03B7 03B8 03B9 03BA 03BB 03BC 03BD 03BE 03BF 03C0 03C1 03C3 03C4 03C5 03C6 03C7 03C8 03C9 %C6 %D0 0126 0132 013F 0141 %D8 0152 %DE 0166 014A %E6 0111 %F0 0127 I 0133 0138 0140 0142 0142 0153 %DF %FE 0167 014B 0149 0411 0413 0414 0401 0416 0417 0418 0419 041B 041F 0426 0427 0428 0429 042A 042B 042C 042D 042E 042F 0431 0432 0433 0434 0451 0436 0437 0438 0439 043B 043F 0444 0446 0447 0448 0449 044A 044B 044C 044D 044E 044F&#39;</span>).replace(/(\<a class="code" href="jquery-1_8x_8min_8js.html#a8bab16140cede5f71c657e8dc46c1887">S</a>{4})/<a class="code" href="jquery-1_8x_8min_8js.html#a103df269476e78897c9c4c6cb8f4eb06">g</a>, <span class="keyword">function</span>(a){<span class="keywordflow">return</span> <span class="stringliteral">&quot;%u&quot;</span>+a}).split(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;        this.charSet[5] = <a class="code" href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a>(<span class="stringliteral">&#39;3041 3042 3043 3044 3045 3046 3047 3048 3049 304A 304B 304C 304D 304E 304F 3050 3051 3052 3053 3054 3055 3056 3057 3058 3059 305A 305B 305C 305D 305E 305F 3060 3061 3062 3063 3064 3065 3066 3067 3068 3069 306A 306B 306C 306D 306E 306F 3070 3071 3072 3073 3074 3075 3076 3077 3078 3079 307A 307B 307C 307D 307E 307F 3080 3081 3082 3083 3084 3085 3086 3087 3088 3089 308A 308B 308C 308D 308E 308F 3090 3091 3092 3093 30A1 30A2 30A3 30A4 30A5 30A6 30A7 30A8 30A9 30AA 30AB 30AC 30AD 30AE 30AF 30B0 30B1 30B2 30B3 30B4 30B5 30B6 30B7 30B8 30B9 30BA 30BB 30BC 30BD 30BE 30BF 30C0 30C1 30C2 30C3 30C4 30C5 30C6 30C7 30C8 30C9 30CA 30CB 30CC 30CD 30CE 30CF 30D0 30D1 30D2 30D3 30D4 30D5 30D6 30D7 30D8 30D9 30DA 30DB 30DC 30DD 30DE 30DF 30E0 30E1 30E2 30E3 30E4 30E5 30E6 30E7 30E8 30E9 30EA 30EB 30EC 30ED 30EE 30EF 30F0 30F1 30F2 30F3 30F4 30F5 30F6&#39;</span>).replace(/(\<a class="code" href="jquery-1_8x_8min_8js.html#a8bab16140cede5f71c657e8dc46c1887">S</a>{4})/<a class="code" href="jquery-1_8x_8min_8js.html#a103df269476e78897c9c4c6cb8f4eb06">g</a>, <span class="keyword">function</span>(a){<span class="keywordflow">return</span> <span class="stringliteral">&quot;%u&quot;</span>+a}).split(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;    },</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;        oAppContainer = $.$(oAppContainer) || <a class="code" href="classdocument.html">document</a>;</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;        this.elDropdownLayer = $(<span class="stringliteral">&quot;DIV.xpress_xeditor_sCharacter_layer&quot;</span>, oAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;        this.oTextField = $(<span class="stringliteral">&quot;INPUT&quot;</span>, this.elDropdownLayer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;        this.oInsertButton = $(<span class="stringliteral">&quot;+ BUTTON&quot;</span>, this.oTextField).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;        this.aCloseButton = $(<span class="stringliteral">&quot;BUTTON.close&quot;</span>, this.elDropdownLayer).<span class="keyword">get</span>();</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;        this.aSCharList = $(<span class="stringliteral">&quot;.list&quot;</span>, this.elDropdownLayer).<span class="keyword">get</span>();</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;        var oLabelUL = $(<span class="stringliteral">&quot;&gt;UL&quot;</span>, this.elDropdownLayer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;        this.aLabelA = $(<span class="stringliteral">&quot;A&quot;</span>, oLabelUL).<span class="keyword">get</span>();</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    },</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;        var funcInsert = $.fnBind(this.oApp.exec, <span class="keyword">this</span>.oApp, <span class="stringliteral">&quot;INSERT_SCHARACTERS&quot;</span>, [<span class="keyword">this</span>.oTextField.value]);</div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;        $(this.oInsertButton).<a class="code" href="layouts_2xedition_2js_2layout_8js.html#a36ec7864a007264541b9a389ce97d8a6">click</a>(funcInsert);</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SET_SCHARACTER_LIST&quot;</span>, [this.charSet]);</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;this.aLabelA.length; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;            var func = $.fnBind(this.oApp.exec, <span class="keyword">this</span>.oApp, <span class="stringliteral">&quot;CHANGE_SCHARACTER_SET&quot;</span>, [<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>]);</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;            $(this.aLabelA[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>]).mousedown(func);</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;            this._stopBrowserEvent(this.aLabelA[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>], <span class="stringliteral">&quot;click&quot;</span>);</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;        }</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;this.aCloseButton.length; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;            this.oApp.registerBrowserEvent(this.aCloseButton[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>], <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>, []);</div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;        }</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;</div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;        this.oApp.registerBrowserEvent(this.elDropdownLayer, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EVENT_SCHARACTER_CLICKED&quot;</span>, []);</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;sCharacter&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;TOGGLE_SCHARACTER_LAYER&quot;</span>]);</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;    },</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;    $ON_TOGGLE_SCHARACTER_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;        this.oTextField.value = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;        this.oSelection = this.oApp.getSelection();</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;</div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;TOGGLE_TOOLBAR_ACTIVE_LAYER&quot;</span>, [this.elDropdownLayer]);</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;    },</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;    $ON_EVENT_SCHARACTER_CLICKED : <span class="keyword">function</span>(weEvent){</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;        var elButton = weEvent.target;</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;        <span class="keywordflow">if</span>(elButton.tagName != <span class="stringliteral">&quot;BUTTON&quot;</span>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;        <span class="keywordflow">if</span>(elButton.parentNode.tagName != <span class="stringliteral">&quot;LI&quot;</span>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;        var sChar = elButton.firstChild.innerHTML;</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SELECT_SCHARACTER&quot;</span>, [sChar]);</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;    },</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;    $ON_SELECT_SCHARACTER : <span class="keyword">function</span>(schar){</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;        this.oTextField.value += schar;</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;        <span class="keywordflow">if</span>(this.oTextField.createTextRange){</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;            var oTextRange = this.oTextField.createTextRange();</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;            oTextRange.collapse(<span class="keyword">false</span>);</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;            oTextRange.select();</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;            <span class="keywordflow">if</span>(this.oTextField.selectionEnd){</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;                this.oTextField.selectionEnd = this.oTextField.value.length;</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;                this.oTextField.focus();</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;            }</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;        }</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;    },</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    $ON_INSERT_SCHARACTERS : <span class="keyword">function</span>(){</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;        this.oSelection.pasteHTML(this.oTextField.value);</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>, []);</div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    },</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    $ON_CHANGE_SCHARACTER_SET : <span class="keyword">function</span>(nSCharSet){</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;this.aSCharList.length; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;            <span class="keywordflow">if</span>(this.aSCharList[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].style.display == <span class="stringliteral">&quot;block&quot;</span>){</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a> == nSCharSet) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;                $(this.aLabelA[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>]).removeClass(<span class="stringliteral">&quot;on&quot;</span>);</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;                this.aSCharList[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].style.display = <span class="stringliteral">&quot;none&quot;</span>;</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;            }</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;        }</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;        this._drawSCharList(nSCharSet);</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;        $(this.aLabelA[nSCharSet]).addClass(<span class="stringliteral">&quot;on&quot;</span>);</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;        this.aSCharList[nSCharSet].style.display = <span class="stringliteral">&quot;block&quot;</span>;</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;    },</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;</div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    $ON_SET_SCHARACTER_LIST : <span class="keyword">function</span>(charSet){</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;        this.charSet = charSet;</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;        this.bSCharSetDrawn = <span class="keyword">new</span> Array(this.charSet.length);</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;        this._drawSCharList(0);</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;    },</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;    _drawSCharList : <span class="keyword">function</span>(<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>){</div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;        <span class="keywordflow">if</span>(this.bSCharSetDrawn[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>]) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;        this.bSCharSetDrawn[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>] = <span class="keyword">true</span>;</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;        var len = this.charSet[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].length;</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;        var aLI = <span class="keyword">new</span> Array(len);</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;        this.aSCharList[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].innerHTML = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;        var button, span;</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;        <span class="keywordflow">for</span>(var ii=0; ii&lt;len; ii++){</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;            aLI[ii] = <a class="code" href="classdocument.html">document</a>.createElement(<span class="stringliteral">&quot;LI&quot;</span>);</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;            aLI[ii].innerHTML = <span class="stringliteral">&#39;&lt;button type=&quot;button&quot;&gt;&lt;span&gt;&#39;</span>+<a class="code" href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a>(this.charSet[i][ii])+<span class="stringliteral">&#39;&lt;/span&gt;&lt;/button&gt;&#39;</span>;</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;            this.aSCharList[<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>].appendChild(aLI[ii]);</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;        }</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;        <span class="comment">// enable this after Jindo framework is updated</span></div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;<span class="comment">//      this.oApp.exec(&quot;ATTACH_HOVER_EVENTS&quot;, [$(&quot;&gt;LI&gt;BUTTON&quot;, this.aSCharList[i])]).get();</span></div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;    },</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;    _stopBrowserEvent : <span class="keyword">function</span>(obj, sEvent){</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;        $(obj).bind(sEvent, <span class="keyword">function</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>.stopPropagation();<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>.preventDefault();} )</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;    }</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;});</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_UndoRedo = $.Class({</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_UndoRedo&quot;</span>,</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;    actionHistory : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;    <span class="comment">// this may also be called, lastAdded/lastRestored</span></div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;    oCurStateIdx : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;    iMinimumSizeChange : 10,</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;    sBlankContentsForFF : <span class="stringliteral">&quot;&lt;br&gt;&quot;</span>,</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;    $init : <span class="keyword">function</span>(){</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;        this.aUndoHistory = [];</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;        this.oCurStateIdx = {nIdx: 0, nStep: 0};</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;    },</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;</div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;    $PRECONDITION : <span class="keyword">function</span>(sCmd){</div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;        <span class="keywordflow">if</span>(sCmd.match(/_DO_RECORD_UNDO_HISTORY_AT$/)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;        <span class="keywordflow">try</span>{</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;            <span class="keywordflow">if</span>(this.oApp.getEditingMode() != <span class="stringliteral">&quot;WYSIWYG&quot;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;        }<span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;        }</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;    },</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;</div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    $BEFORE_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;DO_RECORD_UNDO_HISTORY_AT&quot;</span>, [this.oCurStateIdx, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>]);</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    },</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;        this.bFF = $.browser.mozilla;</div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;</div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;getUndoHistory&quot;</span>, $.fnBind(this.getUndoHistory, <span class="keyword">this</span>)]);</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ADD_APP_PROPERTY&quot;</span>, [<span class="stringliteral">&quot;getUndoStateIdx&quot;</span>, $.fnBind(this.getUndoStateIdx, <span class="keyword">this</span>)]);</div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;undo&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;UNDO&quot;</span>]);</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;redo&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;REDO&quot;</span>]);</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;</div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_HOTKEY&quot;</span>, [<span class="stringliteral">&quot;ctrl+z&quot;</span>, <span class="stringliteral">&quot;UNDO&quot;</span>]);</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_HOTKEY&quot;</span>, [<span class="stringliteral">&quot;ctrl+y&quot;</span>, <span class="stringliteral">&quot;REDO&quot;</span>]);</div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;    },</div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;    $ON_UNDO : <span class="keyword">function</span>(){</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;        var oTmpStateIdx = {};</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;DO_RECORD_UNDO_HISTORY&quot;</span>, [<span class="stringliteral">&quot;KEYPRESS&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, 1]);</div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;        <span class="keywordflow">if</span>(this.oCurStateIdx.nIdx == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;        <span class="keywordflow">if</span>(this.oCurStateIdx.nStep &gt; 0){</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;            this.oCurStateIdx.nStep--;</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;            var oTmpHistory = this.aUndoHistory[this.oCurStateIdx.nIdx];</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;</div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;            this.oCurStateIdx.nIdx--;</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;</div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;            <span class="keywordflow">if</span>(oTmpHistory.nTotalSteps&gt;1){</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;                this.oCurStateIdx.nStep = 0;</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;                oTmpHistory = this.aUndoHistory[this.oCurStateIdx.nIdx];</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;                this.oCurStateIdx.nStep = oTmpHistory.nTotalSteps-1;</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;            }</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;        }</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RESTORE_UNDO_HISTORY&quot;</span>, [this.oCurStateIdx.nIdx, <span class="keyword">this</span>.oCurStateIdx.nStep]);</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []);</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;    },</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;    $ON_REDO : <span class="keyword">function</span>(){</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;        <span class="keywordflow">if</span>(this.oCurStateIdx.nIdx &gt;= <span class="keyword">this</span>.aUndoHistory.length) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;</div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;        var oCurHistory = this.aUndoHistory[this.oCurStateIdx.nIdx];</div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;        <span class="keywordflow">if</span>(this.oCurStateIdx.nIdx == <span class="keyword">this</span>.aUndoHistory.length-1 &amp;&amp; <span class="keyword">this</span>.oCurStateIdx.nStep &gt;= oCurHistory.nTotalSteps-1) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;        <span class="keywordflow">if</span>(this.oCurStateIdx.nStep &lt; oCurHistory.nTotalSteps-1){</div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;            this.oCurStateIdx.nStep++;</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;            this.oCurStateIdx.nIdx++;</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;            oCurHistory = this.aUndoHistory[this.oCurStateIdx.nIdx];</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;            this.oCurStateIdx.nStep = oCurHistory.nTotalSteps-1;</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;        }</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RESTORE_UNDO_HISTORY&quot;</span>, [this.oCurStateIdx.nIdx, <span class="keyword">this</span>.oCurStateIdx.nStep]);</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []);</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;    },</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;    $ON_RECORD_UNDO_ACTION : <span class="keyword">function</span>(sAction){</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;DO_RECORD_UNDO_HISTORY&quot;</span>, [sAction]);</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;    },</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;</div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;    $ON_RECORD_UNDO_BEFORE_ACTION : <span class="keyword">function</span>(sAction){</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;DO_RECORD_UNDO_HISTORY&quot;</span>, [sAction, <span class="keyword">true</span>, <span class="keyword">true</span>]);</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;    },</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;</div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;    $ON_RECORD_UNDO_AFTER_ACTION : <span class="keyword">function</span>(sAction){</div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;DO_RECORD_UNDO_HISTORY&quot;</span>, [sAction, <span class="keyword">true</span>, <span class="keyword">false</span>]);</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;    },</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;    $ON_RESTORE_UNDO_HISTORY : <span class="keyword">function</span>(nUndoIdx, nUndoStateStep){</div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;        this.oCurStateIdx.nIdx = nUndoIdx;</div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;        this.oCurStateIdx.nStep = nUndoStateStep;</div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;        var oCurHistory = this.aUndoHistory[this.oCurStateIdx.nIdx];</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;        var sContent = oCurHistory.sContent[this.oCurStateIdx.nStep];</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;        var oBookmark = oCurHistory.oBookmark[this.oCurStateIdx.nStep];</div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;        this.oApp.setIR(sContent, <span class="keyword">true</span>);</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;        <span class="comment">// setting the innerHTML may change the internal DOM structure, so save the value again.</span></div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;        var sCurContent = this.oApp.getIR();</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;        <span class="keywordflow">if</span>(this.bFF &amp;&amp; sCurContent == this.sBlankContentsForFF){</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;            sCurContent = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;        }</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;        oCurHistory.sContent[this.oCurStateIdx.nStep] = sCurContent;</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;</div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;        var oSelection = this.oApp.getEmptySelection();</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;        <span class="keywordflow">if</span>(oSelection.selectionLoaded){</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;            <span class="keywordflow">if</span>(oBookmark){</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;                oSelection.moveToXPathBookmark(oBookmark);</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;                oSelection = this.oApp.getEmptySelection();</div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;            }</div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;            oSelection.select();</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;        }</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;    },</div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;    $ON_DO_RECORD_UNDO_HISTORY : <span class="keyword">function</span>(sAction, bTwoStepAction, bBeforeAction, nForceAddUnlessEqual){</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;        bTwoStepAction = bTwoStepAction || <span class="keyword">false</span>;</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;        bBeforeAction = bBeforeAction || <span class="keyword">false</span>;</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;        nForceAddUnlessEqual = nForceAddUnlessEqual || 0;</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;        <span class="comment">// if we&#39;re in the middle of some action history, remove everything after current idx if any &quot;little&quot; change is made</span></div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;        <span class="keywordflow">if</span>(!(this.oCurStateIdx.nIdx == <span class="keyword">this</span>.aUndoHistory.length-1)) nForceAddUnlessEqual = 1;</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;        var oCurHistory = this.aUndoHistory[this.oCurStateIdx.nIdx];</div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;        var sCurContent = this.oApp.getIR();</div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;        var sHistoryContent = oCurHistory.sContent[this.oCurStateIdx.nStep];</div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;</div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;        <span class="keywordflow">if</span>(this.bFF &amp;&amp; sCurContent == this.sBlankContentsForFF){</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;            sCurContent = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;        }</div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;        <span class="comment">// every TwoStepAction needs to be recorded</span></div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;        <span class="keywordflow">if</span>(!bTwoStepAction){</div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;            <span class="keywordflow">switch</span>(nForceAddUnlessEqual){</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;                <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;                    <span class="keywordflow">if</span>(Math.abs(sHistoryContent.length - sCurContent.length)&lt;this.iMinimumSizeChange) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;                <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;                    <span class="keywordflow">if</span>(sHistoryContent == sCurContent) <span class="keywordflow">return</span>;</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;                <span class="comment">// write at all times</span></div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;                <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;            }</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;        }</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;</div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;        var oSelection = this.oApp.getSelection();</div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;        var oBookmark=<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;        <span class="keywordflow">if</span>(oSelection.selectionLoaded){</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;            oBookmark = oSelection.getXPathBookmark();</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;        }</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;        var oInsertionIdx = {nIdx:this.oCurStateIdx.nIdx, nStep:this.oCurStateIdx.nStep};</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;        <span class="keywordflow">if</span>(bTwoStepAction){</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;            <span class="keywordflow">if</span>(bBeforeAction){</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;                oInsertionIdx.nStep = 0;</div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;                oInsertionIdx.nStep = 1;</div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;            }</div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;            oInsertionIdx.nStep = 0;</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;        }</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;</div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;        <span class="keywordflow">if</span>(oInsertionIdx.nStep == 0 &amp;&amp; <span class="keyword">this</span>.oCurStateIdx.nStep == oCurHistory.nTotalSteps-1){</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;            oInsertionIdx.nIdx = this.oCurStateIdx.nIdx+1;</div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;        }</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;DO_RECORD_UNDO_HISTORY_AT&quot;</span>, [oInsertionIdx, sAction, sCurContent, oBookmark]);</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;    },</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;</div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;    $ON_DO_RECORD_UNDO_HISTORY_AT : <span class="keyword">function</span>(oInsertionIdx, sAction, sContent, oBookmark){</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;        <span class="keywordflow">if</span>(oInsertionIdx.nStep != 0){</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;            this.aUndoHistory[oInsertionIdx.nIdx].nTotalSteps = oInsertionIdx.nStep+1;</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;            this.aUndoHistory[oInsertionIdx.nIdx].sContent[oInsertionIdx.nStep] = sContent;</div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;            this.aUndoHistory[oInsertionIdx.nIdx].oBookmark[oInsertionIdx.nStep] = oBookmark;</div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;            var oNewHistory = {sAction:sAction, nTotalSteps: 1};</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;            oNewHistory.sContent = [];</div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;            oNewHistory.sContent[0] = sContent;</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;</div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;            oNewHistory.oBookmark = [];</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;            oNewHistory.oBookmark[0] = oBookmark;</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;            this.aUndoHistory.splice(oInsertionIdx.nIdx, <span class="keyword">this</span>.aUndoHistory.length - oInsertionIdx.nIdx, oNewHistory);</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;        }</div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;        this.oCurStateIdx.nIdx = oInsertionIdx.nIdx;</div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;        this.oCurStateIdx.nStep = oInsertionIdx.nStep;</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;    },</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;    _getUndoHistory : <span class="keyword">function</span>(){</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;        <span class="keywordflow">return</span> this.aUndoHistory;</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;    },</div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;    _getUndoStateIdx : <span class="keyword">function</span>(){</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;        <span class="keywordflow">return</span> this.oCurStateIdx;</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;    }</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;});</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_Hyperlink = $.Class({</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_Hyperlink&quot;</span>,</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;    sATagMarker : <span class="stringliteral">&quot;HTTP://HUSKY_TMP.MARKER/&quot;</span>,</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;</div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;    $init : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;        this._assignHTMLObjects(elAppContainer);</div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;        this.sRXATagMarker = this.sATagMarker.replace(/\<span class="comment">//g, &quot;\\/&quot;).replace(/\./g, &quot;\\.&quot;);</span></div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;    },</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;        this.oHyperlinkLayer = $(<span class="stringliteral">&quot;DIV.xpress_xeditor_hyperlink_layer&quot;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;        this.oLinkInput  = $(<span class="stringliteral">&quot;INPUT[type=text]&quot;</span>, this.oHyperlinkLayer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;        this.oBtnConfirm = $(<span class="stringliteral">&quot;BUTTON.confirm&quot;</span>, this.oHyperlinkLayer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;        this.oBtnCancel  = $(<span class="stringliteral">&quot;BUTTON.cancel&quot;</span>, this.oHyperlinkLayer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;        this.oCbNewWin   = $(<span class="stringliteral">&quot;INPUT[type=checkbox]&quot;</span>, this.oHyperlinkLayer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;    },</div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;</div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_HOTKEY&quot;</span>, [<span class="stringliteral">&quot;ctrl+k&quot;</span>, <span class="stringliteral">&quot;XE_TOGGLE_HYPERLINK_LAYER&quot;</span>, []]);</div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;</div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;        this.oApp.registerBrowserEvent(this.oBtnConfirm, <span class="stringliteral">&quot;mousedown&quot;</span>, <span class="stringliteral">&quot;XE_APPLY_HYPERLINK&quot;</span>);</div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;        this.oApp.registerBrowserEvent(this.oBtnCancel, <span class="stringliteral">&quot;mousedown&quot;</span>, <span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>);</div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;        this.oApp.registerBrowserEvent(this.oLinkInput, <span class="stringliteral">&quot;keydown&quot;</span>, <span class="stringliteral">&quot;EVENT_XE_HYPERLINK_KEYDOWN&quot;</span>);</div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;</div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;hyperlink&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;XE_TOGGLE_HYPERLINK_LAYER&quot;</span>]);</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;    },</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;</div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;    $ON_XE_TOGGLE_HYPERLINK_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;        <span class="comment">// hotkey may close the layer right away so delay here</span></div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;        this.oApp.delayedExec(<span class="stringliteral">&quot;TOGGLE_TOOLBAR_ACTIVE_LAYER&quot;</span>, [this.oHyperlinkLayer, <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, <span class="stringliteral">&quot;XE_RESET_HYPERLINK_LAYER&quot;</span>, []], 0);</div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;    },</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;    $ON_XE_RESET_HYPERLINK_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;FOCUS&quot;</span>, []);</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;        this.oSelection = this.oApp.getSelection();</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;        var oAnchor = this.oSelection.findAncestorByTagName(<span class="stringliteral">&quot;A&quot;</span>);</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;        this.oCbNewWin.checked = <span class="keyword">false</span>;</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;        <span class="keywordflow">if</span>(oAnchor){</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;            this.oSelection.selectNode(oAnchor);</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;            this.oSelection.select();</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;</div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;            var sTarget = oAnchor.target;</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;            <span class="keywordflow">if</span>(sTarget &amp;&amp; sTarget == <span class="stringliteral">&quot;_blank&quot;</span>) this.oCbNewWin.checked = <span class="keyword">true</span>;</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;            this.oLinkInput.value = oAnchor.href?oAnchor.href:<span class="stringliteral">&quot;http://&quot;</span>;</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;            this.oLinkInput.value = <span class="stringliteral">&quot;http://&quot;</span>;</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;        }</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;        this.oLinkInput.focus();</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;        this.oLinkInput.value = this.oLinkInput.value;</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;    },</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;    $ON_XE_APPLY_HYPERLINK : <span class="keyword">function</span>(){</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;        var sURL = this.oLinkInput.value, newWin = this.oCbNewWin.checked, sTarget = newWin?<span class="stringliteral">&#39;_blank&#39;</span>:<span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;FOCUS&quot;</span>, []);</div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;        this.oSelection = this.oApp.getSelection();</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;        <span class="keywordflow">if</span>(this.oSelection.collapsed){</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;            var str = <span class="stringliteral">&quot;&lt;a href=&#39;&quot;</span> + sURL + <span class="stringliteral">&quot;&#39; target=&quot;</span>+sTarget+<span class="stringliteral">&quot;&gt;&quot;</span> + sURL + <span class="stringliteral">&quot;&lt;/a&gt;&quot;</span>;</div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;            this.oSelection.pasteHTML(str);</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;            var nSession = Math.ceil(Math.random()*10000);</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;            var sMarker  = this.sATagMarker+nSession;</div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;            var arg = ( sURL == <span class="stringliteral">&quot;&quot;</span> ? [<span class="stringliteral">&quot;unlink&quot;</span>] : [<span class="stringliteral">&quot;createLink&quot;</span>, <span class="keyword">false</span>, sMarker+sURL] );</div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, arg);</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;</div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;            <span class="keywordflow">try</span> { this.oSelection.setFromSelection() }<span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){};</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;            var oDoc = this.oApp.getWYSIWYGDocument();</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;            $(oDoc.body.getElementsByTagName(<span class="stringliteral">&quot;A&quot;</span>))</div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;                .filter(<span class="stringliteral">&#39;[href^=&quot;&#39;</span>+sMarker+<span class="stringliteral">&#39;&quot;]&#39;</span>)</div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;                    .attr(<span class="stringliteral">&#39;href&#39;</span>, <span class="keyword">function</span>(){</div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;                            var rx = <span class="keyword">new</span> RegExp(<span class="charliteral">&#39;^&#39;</span>+sMarker.replace(/([\.\\])/<a class="code" href="jquery-1_8x_8min_8js.html#a103df269476e78897c9c4c6cb8f4eb06">g</a>, <span class="stringliteral">&#39;\\$1&#39;</span>), <span class="charliteral">&#39;i&#39;</span>);</div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;                            <span class="keywordflow">if</span> (sTarget) $(<span class="keyword">this</span>).<a class="code" href="jquery-1_8x_8js.html#af22ff3acc1911f7b1d56fd19d45db91e">attr</a>(<span class="stringliteral">&#39;target&#39;</span>, sTarget);</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;                            <span class="keywordflow">else</span> $(<span class="keyword">this</span>).removeAttr(<span class="stringliteral">&#39;target&#39;</span>);</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;                            <span class="keywordflow">return</span> this.href.replace(rx, <span class="stringliteral">&#39;&#39;</span>);</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;                        });</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;        }</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>);</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;        setTimeout($.fnBind(<span class="keyword">function</span>(){<span class="keywordflow">try</span>{this.oSelection.select()}<span class="keywordflow">catch</span>(<a class="code" href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a>){}}, <span class="keyword">this</span>), 0);</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;    },</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;    _validateURL : <span class="keyword">function</span>(sURL){</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;        <span class="keywordflow">return</span> /^(<a class="code" href="LICENSE_8txt.html#ac4b61a1f8e5f59d19b9a24b25b336db1">http</a>|https|<a class="code" href="classftp.html">ftp</a>|mailto):(?:\/\/)?((<a class="code" href="jquery-1_8x_8min_8js.html#a9721a992655f700bdc2e91ba68b71e26">\w</a>|-)+(?:[\.:@](\<a class="code" href="jquery-1_8x_8min_8js.html#a9721a992655f700bdc2e91ba68b71e26">w</a>|-))+)(?:\/|@)?([^<span class="stringliteral">&quot;\?]*?)(?:\?([^\?&quot;</span>]*?))?$/.test(sURL);</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;    },</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;    $ON_EVENT_XE_HYPERLINK_KEYDOWN : <span class="keyword">function</span>(oEvent){</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;        <span class="keywordflow">if</span> (oEvent.keyCode == 13){</div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;XE_APPLY_HYPERLINK&quot;</span>);</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;            oEvent.preventDefault(); oEvent.stopPropagation();</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;        }</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;    }</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;});</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_Table = $.Class({</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_Table&quot;</span>,</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;    iMinRows : 1,</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;    iMaxRows : 20,</div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;    iMinColumns : 1,</div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;    iMaxColumns : 10,</div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;</div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;    iMinBorderWidth : 1,</div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;    iMaxBorderWidth : 10,</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;</div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;    oSelection : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;    $init : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;        this._assignHTMLObjects(oAppContainer);</div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;    },</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(oAppContainer){</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;        var tmp = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;        this.elDropdownLayer = $(<span class="stringliteral">&quot;DIV.xpress_xeditor_table_layer&quot;</span>, oAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;        this.welDropdownLayer = $(this.elDropdownLayer);</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;</div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;        tmp = $(<span class="stringliteral">&quot;INPUT&quot;</span>, this.elDropdownLayer).<span class="keyword">get</span>();</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;        this.oRowInput = tmp[0];</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;        this.oColumnInput = tmp[1];</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;        this.oBorderWidthInput = tmp[2];</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;        this.oBorderColorInput = tmp[3];</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;        this.oBGColorInput = tmp[4];</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;        tmp = $(<span class="stringliteral">&quot;BUTTON&quot;</span>, this.elDropdownLayer).<span class="keyword">get</span>();</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;        this.oButton_AddRow = tmp[0];</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;        this.oButton_RemoveRow = tmp[1];</div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;        this.oButton_AddColumn = tmp[2];</div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;        this.oButton_RemoveColumn = tmp[3];</div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;        this.oButton_IncBorderWidth = tmp[4];</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;        this.oButton_DecBorderWidth = tmp[5];</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;        this.oButton_BorderColorPreview = tmp[6];</div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;        this.oButton_BorderColor = tmp[7];</div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;        this.oButton_BGColorPreview = tmp[8];</div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;        this.oButton_BGColor = tmp[9];</div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;        this.oButton_Insert = tmp[10];</div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;        this.oButton_Cancel = tmp[11];</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;        this.oSampleTable = $(<span class="stringliteral">&quot;TABLE&quot;</span>, this.elDropdownLayer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;    },</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;REGISTER_UI_EVENT&quot;</span>, [<span class="stringliteral">&quot;table&quot;</span>, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_TOGGLE_TOOLBAR_LAYER&quot;</span>]);</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;        this.oApp.registerBrowserEvent(this.oRowInput, <span class="stringliteral">&quot;change&quot;</span>, <span class="stringliteral">&quot;ST_SET_ROW_NUM&quot;</span>, [<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, 0]);</div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;        this.oApp.registerBrowserEvent(this.oColumnInput, <span class="stringliteral">&quot;change&quot;</span>, <span class="stringliteral">&quot;ST_SET_COLUMN_NUM&quot;</span>, [<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, 0]);</div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;        this.oApp.registerBrowserEvent(this.oBorderWidthInput, <span class="stringliteral">&quot;change&quot;</span>, <span class="stringliteral">&quot;ST_SET_BORDER_WIDTH&quot;</span>, [<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, 0]);</div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;</div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_AddRow, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_ADD_ROW&quot;</span>);</div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_RemoveRow, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_REMOVE_ROW&quot;</span>);</div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_AddColumn, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_ADD_COLUMN&quot;</span>);</div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_RemoveColumn, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_REMOVE_COLUMN&quot;</span>);</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_IncBorderWidth, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_INC_BORDER_WIDTH&quot;</span>);</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_DecBorderWidth, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_DEC_BORDER_WIDTH&quot;</span>);</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_BorderColorPreview, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_TOGGLE_BORDER_COLOR_LAYER&quot;</span>);</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_BGColorPreview, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_TOGGLE_BGCOLOR_LAYER&quot;</span>);</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_BorderColor, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_TOGGLE_BORDER_COLOR_LAYER&quot;</span>);</div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_BGColor, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_TOGGLE_BGCOLOR_LAYER&quot;</span>);</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_Insert, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_INSERT_TABLE&quot;</span>);</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;        this.oApp.registerBrowserEvent(this.oButton_Cancel, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;ST_CLOSE&quot;</span>);</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;</div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_SET_BORDER_COLOR&quot;</span>, [<span class="stringliteral">&quot;#CCCCCC&quot;</span>]);</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_SET_BGCOLOR&quot;</span>, [<span class="stringliteral">&quot;#FFFFFF&quot;</span>]);</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;    },</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;    $ON_ST_TOGGLE_TOOLBAR_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_ACTION_FORCED&quot;</span>, [<span class="stringliteral">&quot;KEYPRESS&quot;</span>]);</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;        this._showNewTable();</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;TOGGLE_TOOLBAR_ACTIVE_LAYER&quot;</span>, [this.elDropdownLayer]);</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;    },</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;</div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;    $ON_ST_ADD_ROW : <span class="keyword">function</span>(){</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_SET_ROW_NUM&quot;</span>, [<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, 1]);</div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;    },</div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;</div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;    $ON_ST_REMOVE_ROW : <span class="keyword">function</span>(){</div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_SET_ROW_NUM&quot;</span>, [<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, -1]);</div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;    },</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;    $ON_ST_ADD_COLUMN : <span class="keyword">function</span>(){</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_SET_COLUMN_NUM&quot;</span>, [<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, 1]);</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;    },</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;    $ON_ST_REMOVE_COLUMN : <span class="keyword">function</span>(){</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_SET_COLUMN_NUM&quot;</span>, [<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, -1]);</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;    },</div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;    $ON_ST_SET_ROW_NUM : <span class="keyword">function</span>(iRows, iRowDiff){</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;        iRows = iRows || parseInt(this.oRowInput.value);</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;        iRowDiff = iRowDiff || 0;</div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;</div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;        iRows += iRowDiff;</div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;</div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;        <span class="keywordflow">if</span>(iRows &lt; this.iMinRows) iRows = this.iMinRows;</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;        <span class="keywordflow">if</span>(iRows &gt; this.iMaxRows) iRows = this.iMaxRows;</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;        this.oRowInput.value = iRows;</div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;        this._showNewTable();</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    },</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;    $ON_ST_SET_COLUMN_NUM : <span class="keyword">function</span>(iColumns, iColumnDiff){</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;        iColumns = iColumns || parseInt(this.oColumnInput.value);</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;        iColumnDiff = iColumnDiff || 0;</div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;</div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;        iColumns += iColumnDiff;</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;        <span class="keywordflow">if</span>(iColumns &lt; this.iMinColumns) iColumns = this.iMinColumns;</div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;        <span class="keywordflow">if</span>(iColumns &gt; this.iMaxColumns) iColumns = this.iMaxColumns;</div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;        this.oColumnInput.value = iColumns;</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;        this._showNewTable();</div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;    },</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;    $ON_ST_INSERT_TABLE : <span class="keyword">function</span>(){</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;        var sTable = this._getTableString();</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;PASTE_HTML&quot;</span>, [sTable]);</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_CLOSE&quot;</span>, []);</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;    },</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;    $ON_ST_CLOSE : <span class="keyword">function</span>(){</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>, []);</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;    },</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;</div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;    $ON_ST_SET_BORDER_WIDTH : <span class="keyword">function</span>(iBorderWidth, iBorderWidthDiff){</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;        iBorderWidth = iBorderWidth || parseInt(this.oBorderWidthInput.value);</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;        iBorderWidthDiff = iBorderWidthDiff || 0;</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;</div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;        iBorderWidth += iBorderWidthDiff;</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;        <span class="keywordflow">if</span>(iBorderWidth &lt; this.iMinBorderWidth) iBorderWidth = this.iMinBorderWidth;</div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;        <span class="keywordflow">if</span>(iBorderWidth &gt; this.iMaxBorderWidth) iBorderWidth = this.iMaxBorderWidth;</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;        this.oBorderWidthInput.value = iBorderWidth;</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;        this._showNewTable();</div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;    },</div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;</div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;    $ON_ST_INC_BORDER_WIDTH : <span class="keyword">function</span>(){</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_SET_BORDER_WIDTH&quot;</span>, [<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, 1]);</div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;    },</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;</div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;    $ON_ST_DEC_BORDER_WIDTH : <span class="keyword">function</span>(){</div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_SET_BORDER_WIDTH&quot;</span>, [<a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>, -1]);</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;    },</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;</div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;    $ON_ST_TOGGLE_BORDER_COLOR_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;        <span class="keywordflow">if</span>(this.welDropdownLayer.hasClass(<span class="stringliteral">&quot;p1&quot;</span>))</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;ST_HIDE_BORDER_COLOR_LAYER&quot;</span>, []);</div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;ST_SHOW_BORDER_COLOR_LAYER&quot;</span>, []);</div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;    },</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;    $ON_ST_SHOW_BORDER_COLOR_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;        this.welDropdownLayer.addClass(<span class="stringliteral">&quot;p1&quot;</span>);</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;        this.welDropdownLayer.removeClass(<span class="stringliteral">&quot;p2&quot;</span>);</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SHOW_COLOR_PALETTE&quot;</span>, [<span class="stringliteral">&quot;ST_SET_BORDER_COLOR_FROM_PALETTE&quot;</span>, this.elDropdownLayer]);</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;    },</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;    $ON_ST_HIDE_BORDER_COLOR_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;        this.welDropdownLayer.removeClass(<span class="stringliteral">&quot;p1&quot;</span>);</div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;</div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_COLOR_PALETTE&quot;</span>, []);</div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;    },</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;    $ON_ST_TOGGLE_BGCOLOR_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;        <span class="keywordflow">if</span>(this.welDropdownLayer.hasClass(<span class="stringliteral">&quot;p2&quot;</span>))</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;ST_HIDE_BGCOLOR_LAYER&quot;</span>, []);</div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;ST_SHOW_BGCOLOR_LAYER&quot;</span>, []);</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;    },</div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;    $ON_ST_SHOW_BGCOLOR_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;        this.welDropdownLayer.removeClass(<span class="stringliteral">&quot;p1&quot;</span>);</div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;        this.welDropdownLayer.addClass(<span class="stringliteral">&quot;p2&quot;</span>);</div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;</div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;SHOW_COLOR_PALETTE&quot;</span>, [<span class="stringliteral">&quot;ST_SET_BGCOLOR_FROM_PALETTE&quot;</span>, this.elDropdownLayer]);</div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;    },</div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;    $ON_ST_HIDE_BGCOLOR_LAYER : <span class="keyword">function</span>(){</div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;        this.welDropdownLayer.removeClass(<span class="stringliteral">&quot;p2&quot;</span>);</div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;HIDE_COLOR_PALETTE&quot;</span>, []);</div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;    },</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;</div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;    $ON_ST_SET_BORDER_COLOR_FROM_PALETTE : <span class="keyword">function</span>(sColorCode){</div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_SET_BORDER_COLOR&quot;</span>, [sColorCode]);</div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_HIDE_BORDER_COLOR_LAYER&quot;</span>, []);</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;    },</div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;    $ON_ST_SET_BORDER_COLOR : <span class="keyword">function</span>(sColorCode){</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;        this.oBorderColorInput.value = sColorCode;</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;        this.oButton_BorderColorPreview.style.backgroundColor = sColorCode;</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;        this._showNewTable();</div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;    },</div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;</div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;    $ON_ST_SET_BGCOLOR_FROM_PALETTE : <span class="keyword">function</span>(sColorCode){</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_SET_BGCOLOR&quot;</span>, [sColorCode]);</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;ST_HIDE_BGCOLOR_LAYER&quot;</span>, []);</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;    },</div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;</div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;    $ON_ST_SET_BGCOLOR : <span class="keyword">function</span>(sColorCode){</div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;        this.oBGColorInput.value = sColorCode;</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;        this.oButton_BGColorPreview.style.backgroundColor = sColorCode;</div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;        this._showNewTable();</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;    },</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;    _showNewTable : <span class="keyword">function</span>(){</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;        var oTmp = <a class="code" href="classdocument.html">document</a>.createElement(<span class="stringliteral">&quot;DIV&quot;</span>);</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;        oTmp.innerHTML = this._getTableString();</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;        var oNewTable = oTmp.firstChild;</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;        this.oSampleTable.parentNode.insertBefore(oNewTable, this.oSampleTable);</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;        this.oSampleTable.parentNode.removeChild(this.oSampleTable);</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;        this.oSampleTable = oNewTable;</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;    },</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    <span class="comment">// need to do something about the table width as the same HTML code is being used to the actual table and the preview table</span></div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;    _getTableString : <span class="keyword">function</span>(){</div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;        var sBorderColorCode = this.oBorderColorInput.value;</div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;        var sBGColorCode = this.oBGColorInput.value;</div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;        var iBorderWidth = this.oBorderWidthInput.value;</div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;        var sTD = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;        <span class="keywordflow">if</span>($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie){</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;            sTD = <span class="stringliteral">&quot;&lt;td&gt;&lt;p&gt;&lt;/p&gt;&lt;/td&gt;&quot;</span>;</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;            <span class="keywordflow">if</span>($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.firefox){</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;                sTD = <span class="stringliteral">&quot;&lt;td&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;/td&gt;&quot;</span>;</div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;                sTD = <span class="stringliteral">&quot;&lt;td&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;/td&gt;&quot;</span>;</div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;            }</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;        }</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;        var sTable = <span class="stringliteral">&#39;&lt;table style=&quot;background:&#39;</span>+sBorderColorCode+<span class="stringliteral">&#39;;border-spacing:1px&quot; cellspacing=&quot;&#39;</span>+iBorderWidth+<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;        var sRow = <span class="stringliteral">&#39;&lt;tr style=&quot;background:&#39;</span>+sBGColorCode+<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;        var iColumns = this.oColumnInput.value;</div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;iColumns; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;            sRow += sTD;</div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;        }</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;        sRow += <span class="stringliteral">&quot;&lt;/tr&gt;\n&quot;</span>;</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;        var iRows = this.oRowInput.value;</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;        sTable += <span class="stringliteral">&quot;&lt;tbody&gt;&quot;</span>;</div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;        <span class="keywordflow">for</span>(var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>=0; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>&lt;iRows; <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>++){</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;            sTable += sRow;</div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;        }</div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;        sTable += <span class="stringliteral">&quot;&lt;/tbody&gt;&quot;</span>;</div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;</div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;        sTable += <span class="stringliteral">&quot;&lt;/table&gt;&quot;</span>;</div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;        <span class="keywordflow">return</span> sTable;</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;    }</div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;});</div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;<span class="comment">//{</span></div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;<span class="comment"></span><a class="code" href="namespacexe.html">xe</a>.XE_EditingModeToggler = $.Class({</div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_EditingModeToggler&quot;</span>,</div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;</div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;    $init : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;        this._assignHTMLObjects(elAppContainer);</div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;    },</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;        elAppContainer = $.$(elAppContainer) || <a class="code" href="classdocument.html">document</a>;</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;        this.elModeToggleButton = $(<span class="stringliteral">&quot;BUTTON.xpress_xeditor_mode_toggle_button&quot;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;        this.welModeToggleButton = $(this.elModeToggleButton);</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;    },</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;        this.oApp.registerBrowserEvent(this.elModeToggleButton, <span class="stringliteral">&quot;click&quot;</span>, <span class="stringliteral">&quot;EVENT_TOGGLE_EDITING_MODE&quot;</span>, []);</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;    },</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;    $ON_EVENT_TOGGLE_EDITING_MODE : <span class="keyword">function</span>(){</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;        <span class="keywordflow">if</span>(this.oApp.getEditingMode() == <span class="stringliteral">&quot;WYSIWYG&quot;</span>)</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;CHANGE_EDITING_MODE&quot;</span>, [<span class="stringliteral">&quot;HTMLSrc&quot;</span>]);</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;CHANGE_EDITING_MODE&quot;</span>, [<span class="stringliteral">&quot;WYSIWYG&quot;</span>]);</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;    },</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;</div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;    $ON_CHANGE_EDITING_MODE : <span class="keyword">function</span>(sMode){</div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;        <span class="keywordflow">if</span>(sMode == <span class="stringliteral">&quot;HTMLSrc&quot;</span>){</div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;            this.welModeToggleButton.addClass(<span class="stringliteral">&quot;active&quot;</span>).parent(<span class="stringliteral">&quot;span&quot;</span>).addClass(<span class="stringliteral">&quot;active&quot;</span>);</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;DISABLE_ALL_UI&quot;</span>, []);</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;            this.welModeToggleButton.removeClass(<span class="stringliteral">&quot;active&quot;</span>).parent(<span class="stringliteral">&quot;span&quot;</span>).removeClass(<span class="stringliteral">&quot;active&quot;</span>);</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;            this.oApp.exec(<span class="stringliteral">&quot;ENABLE_ALL_UI&quot;</span>, []);</div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;        }</div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;    }</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;});</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;<a class="code" href="namespacexe.html">xe</a>.XE_Editorresize = $.Class({</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_Editorresize&quot;</span>,</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;    $init : <span class="keyword">function</span>(elAppContainer, oWYSIWYGIFrame){</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;        this.inputArea = $(<span class="stringliteral">&#39;.xpress_xeditor_editing_area_container&#39;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;        this.oVerticalResizer = $(<span class="stringliteral">&#39;.xpress_xeditor_editingArea_verticalResizer&#39;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;        this.oCheckBox = $(<span class="stringliteral">&#39;#editorresize&#39;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;        this.oIframe = oWYSIWYGIFrame;</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;        var <span class="keyword">self</span> = <span class="keyword">this</span>;</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;        $(oWYSIWYGIFrame).<a class="code" href="jquery-1_8x_8js.html#a8d0b9ec82c308161432f1c387d2fc2a7">load</a>(<span class="keyword">function</span>(){</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;            <span class="keyword">self</span>.oIframeBody = $(oWYSIWYGIFrame).contents().find(<span class="stringliteral">&#39;body&#39;</span>);</div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;            });</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;    },</div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;        this.oApp.registerBrowserEvent(this.oCheckBox, <span class="stringliteral">&#39;change&#39;</span>, <span class="stringliteral">&#39;XE_TOGGLE_EDITOR_RESIZE&#39;</span>);</div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;    },</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;    $ON_XE_TOGGLE_EDITOR_RESIZE : <span class="keyword">function</span>(){</div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;        <span class="keywordflow">if</span>(this.oCheckBox.checked == <span class="keyword">true</span>){</div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;            <span class="keywordflow">if</span>(this._prevHeight == <a class="code" href="jquery-1_8x_8js.html#a08113a236cc18d2a9d5ce27e638012be">undefined</a>)</div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;                this._prevHeight = this.inputArea.style.height;</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;            </div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;            this.oVerticalResizer.style.display = <span class="stringliteral">&#39;none&#39;</span>;</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;            this.oApp.registerBrowserEvent(this.oIframeBody, <span class="stringliteral">&#39;keydown&#39;</span>, <span class="stringliteral">&#39;XE_EDITOR_RESIZE&#39;</span>);</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;</div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;            this.inputArea.style.height = this.oIframe.style.height = this.oIframeBody[0].scrollHeight + <span class="stringliteral">&#39;px&#39;</span>;</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;            $(this.oIframeBody).unbind(<span class="stringliteral">&#39;keydown&#39;</span>);</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;            this.oVerticalResizer.style.display = <span class="stringliteral">&#39;block&#39;</span>;</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;            this.inputArea.style.height = this._prevHeight;</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;            this.oIframe.style.height = this._prevHeight;</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;        }</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;    },</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;    $ON_XE_EDITOR_RESIZE : <span class="keyword">function</span>(){</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;        var <a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a> = <span class="keyword">this</span>;</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;        setTimeout(<span class="keyword">function</span>(){</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;            t.inputArea.style.height = t.oIframe.style.height = t.oIframeBody[0].scrollHeight + <span class="stringliteral">&#39;px&#39;</span>;</div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;        }, 0);</div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;    }</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;});</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;<span class="comment">//}</span></div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;<span class="comment"></span>var oMessageMap = {</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;    <span class="stringliteral">&#39;XE_EditingAreaManager.onExit&#39;</span> : <span class="stringliteral">&#39;%uB0B4%uC6A9%uC774%20%uBCC0%uACBD%uB418%uC5C8%uC2B5%uB2C8%uB2E4.&#39;</span>,</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;    <span class="stringliteral">&#39;XE_FontColor.invalidColorCode&#39;</span> : <span class="stringliteral">&#39;%uC0C9%uC0C1%20%uCF54%uB4DC%uB97C%20%uC62C%uBC14%uB974%uAC8C%20%uC785%uB825%uD558%uC5EC%20%uC8FC%uC2DC%uAE30%20%uBC14%uB78D%uB2C8%uB2E4.\n\n%uC608%29%20%23000000%2C%20%23FF0000%2C%20%23FFFFFF%2C%20%23ffffff%2C%20ffffff&#39;</span>,</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;    <span class="stringliteral">&#39;XE_BGColor.invalidColorCode&#39;</span> : <span class="stringliteral">&#39;%uC0C9%uC0C1%20%uCF54%uB4DC%uB97C%20%uC62C%uBC14%uB974%uAC8C%20%uC785%uB825%uD558%uC5EC%20%uC8FC%uC2DC%uAE30%20%uBC14%uB78D%uB2C8%uB2E4.\n\n%uC608%29%20%23000000%2C%20%23FF0000%2C%20%23FFFFFF%2C%20%23ffffff%2C%20ffffff&#39;</span>,</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;    <span class="stringliteral">&#39;XE_Hyperlink.invalidURL&#39;</span> : <span class="stringliteral">&#39;%uC785%uB825%uD558%uC2E0%20URL%uC774%20%uC62C%uBC14%uB974%uC9C0%20%uC54A%uC2B5%uB2C8%uB2E4.&#39;</span></div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;};</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;<a class="code" href="namespacexe.html">xe</a>.XpressCore.oMessageMap = oMessageMap;</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;var</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;    regex_meanless_css1 = /&lt;(.*?)\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>+style\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*=\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&quot;(.*?(?:margin|padding)\s*:\s*0(?:px)?.*?|.*?\-(?:moz|ms|webkit|opera).*?)&quot;</span>(.*?)&gt;/ig,</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;    regex_meanless_css2 = /(?:(?:margin|padding)\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*0(?:px)?|\-(?:moz|ms|webkit|opera)\-[\<a class="code" href="jquery-1_8x_8min_8js.html#a9721a992655f700bdc2e91ba68b71e26">w</a>-]+\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*.*?|[\<a class="code" href="jquery-1_8x_8min_8js.html#a9721a992655f700bdc2e91ba68b71e26">w</a>-]+\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*\-(?:moz|ms|webkit|opera)\-[<a class="code" href="jquery-1_8x_8min_8js.html#a9721a992655f700bdc2e91ba68b71e26">\w</a>-]+|(?:line-height|font-variant|font-stretch|font-<a class="code" href="jquery-1_8x_8js.html#afa6806c6ee5e63d5177f1dcc082ba6bc">size</a>-adjust|font-<a class="code" href="jquery-1_8x_8js.html#afa6806c6ee5e63d5177f1dcc082ba6bc">size</a>)\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*[a-z_-]+)<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">\s</a>*;?<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">\s</a>*|font-(?:weight|style)\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*normal;?/ig,</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;    regex_class  = /&lt;(.*?)\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>+<span class="keyword">class</span>\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*=(?:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&quot;(.*?)&quot;</span>|\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&#39;(.*?)&#39;</span>|([^\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>&gt;]+))(.*?)&gt;/ig,</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;    regex_class2 = /xe_selected_cell/<a class="code" href="jquery-1_8x_8min_8js.html#a103df269476e78897c9c4c6cb8f4eb06">g</a>;</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;    regex_handler = /&lt;(.*?)\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>+<a class="code" href="jquery-1_8x_8min_8js.html#a9d5fa4fe98b38569490d55d1a97b0f72">on</a>[a-z]+\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*=(?:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&quot;.*?&quot;</span>|\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&#39;.*?&#39;</span>|[^\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>&gt;]+)(.*?)&gt;/ig,</div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;    <span class="comment">//regex_id = /&lt;(.*?)\s+id\s*=(?:[^\s&gt;]+|\s*&quot;.*?&quot;|\s*&#39;.*?&#39;)(.*?)&gt;/ig,</span></div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;    <span class="comment">//regex_script = /&lt;script[\s\S]+?&lt;\/script&gt;/ig,</span></div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;    regex_font_color = /color\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*=(?:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&quot;(.*?)&quot;</span>|\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&#39;(.*?)&#39;</span>|([^\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>&gt;]+))/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>,</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;    regex_font_face  = /face\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*=(?:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&quot;(.*?)&quot;</span>|\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&#39;(.*?)&#39;</span>|([^\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>&gt;]+))/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>,</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;    regex_font_size  = /<a class="code" href="jquery-1_8x_8js.html#afa6806c6ee5e63d5177f1dcc082ba6bc">size</a>\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*=(?:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&quot;(\d+)&quot;</span>|\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&#39;(\d+)&#39;</span>|(\<a class="code" href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">d</a>+))/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>,</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;    regex_style = /style\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*=\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*(?:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&quot;(.*?)&quot;</span>|\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&#39;(.*?)&#39;</span>|([^\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>&gt;]+))/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>,</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;    regex_font_weight = /font-weight\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*([a-z]+);?/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>,</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;    regex_font_style = /font-<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">style\s</a>*:<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">\s</a>*italic;?/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>,</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;    regex_font_decoration = /text-<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">decoration\s</a>*:<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">\s</a>*([a-z -]+);?/<a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a>,</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;    regex_jquery = /<a class="code" href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">jQuery\d</a>+<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">\s</a>*=(\s*<span class="stringliteral">&quot;\d+&quot;</span>|<a class="code" href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">\d</a>+)/ig,</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;    regex_quote_attr = /([\<a class="code" href="jquery-1_8x_8min_8js.html#a9721a992655f700bdc2e91ba68b71e26">w</a>-]+\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*=(?:\<a class="code" href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a>*<span class="stringliteral">&quot;[^&quot;</span>]+<span class="stringliteral">&quot;|\s*&#39;[^&#39;]+&#39;))|([\w-]+)=([^\s]+)/g; //&quot;</span></div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;var</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;    allow_tags  = <span class="stringliteral">&#39;a,abbr,acronym,address,area,blockquote,br,caption,center,cite,code,col,colgroup,dd,del,dfn,div,dl,dt,em,embed,h1,h2,h3,h4,h5,h6,hr,img,ins,kbd,li,map,object,ol,p,param,pre,q,samp,span,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,tt,u,ul,var,iframe,object,param,style&#39;</span>.split(<span class="charliteral">&#39;,&#39;</span>),</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;    no_closing_tags = <span class="stringliteral">&#39;area,br,col,embed,hr,img,input,param,base,meta,link,basefont,isindex&#39;</span>.split(<span class="charliteral">&#39;,&#39;</span>);</div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;var</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;    replace_tags = {</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;        <span class="charliteral">&#39;b&#39;</span> : <span class="stringliteral">&#39;strong&#39;</span>,</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;        <span class="charliteral">&#39;i&#39;</span> : <span class="stringliteral">&#39;em&#39;</span>,</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;        <span class="charliteral">&#39;s&#39;</span> : <span class="stringliteral">&#39;del&#39;</span>,</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;        <span class="stringliteral">&#39;strike&#39;</span> : <span class="stringliteral">&#39;del&#39;</span></div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;    };</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;<a class="code" href="namespacexe.html">xe</a>.XE_XHTMLFormatter = $.Class({</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_XHTMLFormatter&quot;</span>,</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>() {</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;        this.oApp.addConverter(<span class="stringliteral">&quot;WYSIWYG_TO_IR&quot;</span>, this.TO_IR);</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;        this.oApp.addConverter(<span class="stringliteral">&quot;HTMLSrc_TO_IR&quot;</span>, this.TO_IR);</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;        this.oApp.addConverter(<span class="stringliteral">&quot;IR_TO_HTMLSrc&quot;</span>, this.IR_TO);</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;        this.oApp.addConverter(<span class="stringliteral">&quot;IR_TO_WYSIWYG&quot;</span>, this.IR_TO);</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;    },</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;    TO_IR : <span class="keyword">function</span>(sContent) {</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;        var stack = [];</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;        <span class="comment">// remove xeHandled attrs</span></div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;<span class="comment">        sContent = sContent.replace(/xeHandled=&quot;YES&quot;/ig,&#39;&#39;);</span></div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;        <span class="comment">// remove all useless styles</span></div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;<span class="comment">        sContent = sContent.replace(regex_meanless_css1, function(m0,m1,m2,m3){</span></div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;<span class="comment">            m2 = m2.replace(regex_meanless_css2, &#39;&#39;);</span></div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;<span class="comment">            return &#39;&lt;&#39;+m1+(m2?&#39; style=&quot;&#39;+m2+&#39;&quot;&#39;:&#39;&#39;)+m3+&#39;&gt;&#39;;</span></div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;<span class="comment">        });</span></div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;        <span class="comment">// remove all useless classes</span></div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;<span class="comment">        sContent = sContent.replace(regex_class, function(m0,m1,m2,m3,m4,m5){</span></div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;<span class="comment">            var cls = $.trim((m2 || m3 || m4 || &quot;&quot;).replace(regex_class2, &#39;&#39;));</span></div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;<span class="comment">            return &#39;&lt;&#39;+(m1||&quot;&quot;)+(cls?&#39; class=&quot;&#39;+cls+&#39;&quot;&#39;:&#39;&#39;)+(m5||&quot;&quot;)+&#39;&gt;&#39;;</span></div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;<span class="comment">        });</span></div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;        <span class="comment">// remove all event handler</span></div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;        <span class="comment">//sContent = sContent.replace(regex_handler, &#39;&lt;$1$2&gt;&#39;);</span></div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;        <span class="comment">// remove all id</span></div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;        <span class="comment">//sContent = sContent.replace(regex_id, &#39;&lt;$1$2&gt;&#39;);</span></div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;        <span class="comment">// remove all scripts</span></div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;        <span class="comment">//sContent = sContent.replace(regex_script, &#39;&#39;);</span></div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;        <span class="keywordflow">if</span> ($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie) {</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;            <span class="comment">// remove $ attributes</span></div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;            sContent = sContent.replace(regex_jquery, <span class="stringliteral">&#39;&#39;</span>);</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;            <span class="comment">// quote all attrs</span></div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;            sContent = sContent.replace(/&lt;(\<a class="code" href="jquery-1_8x_8min_8js.html#a9721a992655f700bdc2e91ba68b71e26">w</a>+) ([^&gt;]+)&gt;/<a class="code" href="jquery-1_8x_8min_8js.html#a103df269476e78897c9c4c6cb8f4eb06">g</a>, <span class="keyword">function</span>(m0,m1,m2){</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;                <span class="keywordflow">return</span> <span class="charliteral">&#39;&lt;&#39;</span>+m1+<span class="charliteral">&#39; &#39;</span>+</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;                    m2.replace(regex_quote_attr, <span class="keyword">function</span>(s0,s1,s2,s3){</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;                        <span class="keywordflow">if</span>(s1) <span class="keywordflow">return</span> s1;</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;                        <span class="keywordflow">if</span>(/^<span class="stringliteral">&quot;/.test(s3)||/&quot;</span>$/.test(s3)) <span class="keywordflow">return</span> s2+<span class="charliteral">&#39;=&#39;</span>+s3;</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;                        <span class="keywordflow">return</span> s2+<span class="stringliteral">&#39;=&quot;&#39;</span>+(s3||s2)+<span class="charliteral">&#39;&quot;&#39;</span>;</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;                    }) + <span class="charliteral">&#39;&gt;&#39;</span>;</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;            });</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;        }</div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;</div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;        <span class="comment">// remove all useless tag and enclose tags</span></div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;        <a class="code" href="xpresseditor_8min_8js.html#a41501e23bb16bb56190330504dbe53de">regex</a> = /&lt;(\/)?([:\<a class="code" href="jquery-1_8x_8min_8js.html#a9721a992655f700bdc2e91ba68b71e26">w</a>\/-]+)(.*?)&gt;/ig;</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;        sContent = sContent.replace(<a class="code" href="xpresseditor_8min_8js.html#a41501e23bb16bb56190330504dbe53de">regex</a>, <span class="keyword">function</span>(m0,closing,<a class="code" href="classtag.html">tag</a>,attrs){</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;            var m3s = [];</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;            var state = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;            closing = closing || <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;            <a class="code" href="classtag.html">tag</a>     = <a class="code" href="classtag.html">tag</a>.toLowerCase();</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;            attrs   = $.trim(attrs || <span class="stringliteral">&#39;&#39;</span>);</div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;            <span class="keywordflow">if</span>(replace_tags[<a class="code" href="classtag.html">tag</a>]!=<a class="code" href="jquery-1_8x_8js.html#a08113a236cc18d2a9d5ce27e638012be">undefined</a>) <a class="code" href="classtag.html">tag</a> = replace_tags[<a class="code" href="classtag.html">tag</a>];</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;            <span class="keywordflow">if</span> (!closing) {</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;                <span class="keywordflow">if</span> ($.inArray(<a class="code" href="classtag.html">tag</a>,no_closing_tags) &gt;= 0) {</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;                    var len = attrs.length;</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classtag.html">tag</a> == <span class="stringliteral">&#39;br&#39;</span>) attrs = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;                    <span class="keywordflow">if</span> (!attrs || attrs.substring(len-1,len) != <span class="charliteral">&#39;/&#39;</span>) attrs += <span class="stringliteral">&#39; /&#39;</span>;</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;                    <span class="keywordflow">return</span> <span class="charliteral">&#39;&lt;&#39;</span>+<a class="code" href="classtag.html">tag</a>+<span class="charliteral">&#39; &#39;</span>+$.trim(attrs)+<span class="charliteral">&#39;&gt;&#39;</span>;</div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;                    stack.push({<a class="code" href="classtag.html">tag</a>:<a class="code" href="classtag.html">tag</a>, state:state});</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;                }</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;                var tags = [], <a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;                <span class="comment">// if the tag does not require a closing tag, simply remove the closing tag</span></div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;                <span class="keywordflow">if</span> ($.inArray(<a class="code" href="classtag.html">tag</a>,no_closing_tags) &gt;= 0) {</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;                    <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;                }</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;                <span class="comment">// if the matching opening tag was not found, remove this closing tag</span></div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;                <span class="keywordflow">if</span> (!stack.length){</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;                    <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;                }</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;                <span class="keywordflow">do</span> {</div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;                    <a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a> = stack.pop();</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a>.tag != <a class="code" href="classtag.html">tag</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a>.state != <span class="stringliteral">&#39;deleted&#39;</span>) tags.push(<span class="stringliteral">&#39;&lt;/&#39;</span>+<a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a>.tag+<span class="charliteral">&#39;&gt;&#39;</span>);</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;                } <span class="keywordflow">while</span>(stack.length &amp;&amp; <a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a>.tag != <a class="code" href="classtag.html">tag</a>);</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;                <span class="keywordflow">return</span> tags.join(<span class="stringliteral">&#39;&#39;</span>);</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;            }</div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;            <span class="keywordflow">return</span> <span class="charliteral">&#39;&lt;&#39;</span>+closing+<a class="code" href="classtag.html">tag</a>+(attrs?<span class="charliteral">&#39; &#39;</span>+attrs:<span class="stringliteral">&#39;&#39;</span>)+<span class="charliteral">&#39;&gt;&#39;</span>;</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;        });</div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;</div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;        <span class="keywordflow">if</span>(stack.length) {</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;            var <a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;            <span class="keywordflow">do</span> {</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;                t = stack.pop();</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;                <span class="keywordflow">if</span> (t.state != <span class="stringliteral">&#39;deleted&#39;</span>) sContent += <span class="stringliteral">&#39;&lt;/&#39;</span>+t.tag+<span class="charliteral">&#39;&gt;&#39;</span>;</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;            } <span class="keywordflow">while</span>(stack.length);</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;        }</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;</div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;        <span class="comment">// add new line after &lt;/p&gt;</span></div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;        <a class="code" href="xpresseditor_8min_8js.html#a41501e23bb16bb56190330504dbe53de">regex</a> = /&lt;\/<a class="code" href="jquery-1_8x_8min_8js.html#ad1707b001240e9c8298830073364c8bf">p</a>&gt;[ <a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">\t</a>]*(<a class="code" href="jquery-1_8x_8min_8js.html#afc984c4f6c68ce30a0af99006f5f8d27">\n</a>)?/ig;</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;        sContent = sContent.replace(<a class="code" href="xpresseditor_8min_8js.html#a41501e23bb16bb56190330504dbe53de">regex</a>, <span class="stringliteral">&quot;&lt;/p&gt;\n&quot;</span>);</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;</div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;        <span class="keywordflow">return</span> sContent;</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;    },</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;    IR_TO : <span class="keyword">function</span>(sContent) {</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;        <span class="keywordflow">return</span> sContent;</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;    }</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;});</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;<span class="comment">// center, font, b, i, s, strike</span></div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;<a class="code" href="namespacexe.html">xe</a>.XE_Extension = $.Class({</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a>  : <span class="stringliteral">&quot;XE_Extension&quot;</span>,</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;    seq   : <span class="stringliteral">&#39;&#39;</span>,</div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;    last_doc : <span class="stringliteral">&#39;&#39;</span>,</div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;</div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;    $init : <span class="keyword">function</span>(elAppContainer, editor_sequence) {</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;        this.seq = editor_sequence;</div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;        this._assignHTMLObjects(elAppContainer);</div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;    },</div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer) {</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;        this.elDropdownLayer = $(<span class="stringliteral">&#39;DIV.xpress_xeditor_extension_layer&#39;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;    },</div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;</div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;    _removeAttrs : <span class="keyword">function</span>(sContent) {</div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;        <span class="keywordflow">return</span> sContent;</div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;    },</div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;</div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;    _addEvent : <span class="keyword">function</span>() {</div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;        <span class="keywordflow">if</span> (this.oApp.getEditingMode() != <span class="stringliteral">&#39;WYSIWYG&#39;</span>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;        var doc = this.oApp.getWYSIWYGDocument();</div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;        var seq = this.seq;</div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;        var <a class="code" href="jquery-1_8x_8min_8js.html#a37b9e1ceee4c6d2616fa6081784b5468">fn</a>  = <span class="keyword">function</span>(){</div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;            var obj  = $(<span class="keyword">this</span>);</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;            var comp = obj.attr(<span class="stringliteral">&#39;editor_component&#39;</span>);</div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;            <span class="keywordflow">if</span> (comp &amp;&amp; $.isFunction(<a class="code" href="editor__common_8js.html#aefa1bbe206ace10cf6ebc63da9ef7219">openComponent</a>)) {</div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;                <a class="code" href="editor__common_8js.html#ab93b882536c44fdf3619d68842133a5c">editorPrevNode</a> = obj.get(0);</div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;                <a class="code" href="editor__common_8js.html#aefa1bbe206ace10cf6ebc63da9ef7219">openComponent</a>(comp, seq);</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;            }</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;        };</div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;        $(doc).<a class="code" href="jquery_8mobile_8customized_8min_8js.html#a014f4b186ec2d7af824aa74fbff0cb94">find</a>(<span class="stringliteral">&#39;img,div[editor_component]&#39;</span>).each(<span class="keyword">function</span>(){</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;            var obj = $(<span class="keyword">this</span>);</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;            <span class="keywordflow">if</span>(this.nodeName == <span class="stringliteral">&#39;IMG&#39;</span> &amp;&amp; !obj.attr(<span class="stringliteral">&#39;editor_component&#39;</span>) &amp;&amp; !obj.attr(<span class="stringliteral">&#39;widget&#39;</span>)) {</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;                obj.attr(<span class="stringliteral">&#39;editor_component&#39;</span>,<span class="stringliteral">&#39;image_link&#39;</span>);</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;            }</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;            <span class="keywordflow">if</span>(this.last_doc != doc) {</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;                obj.unbind(<span class="stringliteral">&#39;dblclick.widget&#39;</span>).bind(<span class="stringliteral">&#39;dblclick.widget&#39;</span>,fn);</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;                this.last_doc = doc;</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;            }</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;        });</div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;    },</div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;</div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>() {</div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;        var oApp = this.oApp;</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;        oApp.exec(<span class="stringliteral">&#39;REGISTER_UI_EVENT&#39;</span>, [<span class="stringliteral">&#39;extension&#39;</span>, <span class="stringliteral">&#39;click&#39;</span>, <span class="stringliteral">&#39;TOGGLE_EXTENSION_LAYER&#39;</span>]);</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;        var functn  = <span class="keyword">function</span>(){</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;            oApp.exec(<span class="stringliteral">&quot;HIDE_ACTIVE_LAYER&quot;</span>, []);</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;        };</div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;        $(<span class="charliteral">&#39;a&#39;</span>, this.elDropdownLayer).<a class="code" href="jquery-1_8x_8js.html#af7620627e2f905064d3dff5102ed804b">each</a>(<span class="keyword">function</span>(){</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;            var obj = $(<span class="keyword">this</span>);</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;            <span class="keywordflow">if</span>(!obj.attr(<span class="stringliteral">&#39;component_onclick_event_added&#39;</span>)) {</div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;                obj.click(functn);</div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;                obj.attr(<span class="stringliteral">&#39;component_onclick_event_added&#39;</span>,<span class="charliteral">&#39;Y&#39;</span>);</div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;            }</div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;        });</div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;    },</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;</div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;    $ON_TOGGLE_EXTENSION_LAYER : <span class="keyword">function</span>() {</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;        this.oApp.exec(<span class="stringliteral">&#39;TOGGLE_TOOLBAR_ACTIVE_LAYER&#39;</span>, [this.elDropdownLayer]);</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;    },</div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;</div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;    $ON_CHANGE_EDITING_MODE : <span class="keyword">function</span>(mode) {</div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;        var <span class="keyword">self</span> = <span class="keyword">this</span>;</div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;        setTimeout(<span class="keyword">function</span>(){ <span class="keyword">self</span>._addEvent(); }, 100);</div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;    },</div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;</div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;    $ON_PASTE_HTML : <span class="keyword">function</span>() {</div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;        var <span class="keyword">self</span> = <span class="keyword">this</span>;</div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;        setTimeout(<span class="keyword">function</span>(){ <span class="keyword">self</span>._addEvent(); }, 100);</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;    },</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;    $ON_LOAD_IR_FIELD : <span class="keyword">function</span>() {</div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;        var <span class="keyword">self</span> = <span class="keyword">this</span>;</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;        setTimeout(<span class="keyword">function</span>(){ <span class="keyword">self</span>._addEvent(); }, 100);</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;    },</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;    $ON_SET_IR : <span class="keyword">function</span>() {</div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;        var <span class="keyword">self</span> = <span class="keyword">this</span>;</div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;        setTimeout(<span class="keyword">function</span>(){ <span class="keyword">self</span>._addEvent(); }, 100);</div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;    }</div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;});</div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;<a class="code" href="namespacexe.html">xe</a>.XE_AutoSave = $.Class({</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_AutoSave&quot;</span>,</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;    <a class="code" href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a> : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;    textarea : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;</div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;    $init : <span class="keyword">function</span>(oIRTextarea, elAppContainer) {</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;        this.<a class="code" href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a> = oIRTextarea.form;</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;        this.textarea = oIRTextarea;</div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;        this._assignHTMLObjects(elAppContainer);</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;    },</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;</div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer) {</div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;        this.welMessageBox = $(<span class="stringliteral">&#39;autosave_message&#39;</span>);</div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;    },</div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;</div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>() {</div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;        var elTitle   = $(this.<a class="code" href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a>._saved_doc_title);</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;        var elContent = $(this.<a class="code" href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a>._saved_doc_content);</div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;        var elDocument_srl = $(this.<a class="code" href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a>._saved_doc_document_srl);</div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;        var <a class="code" href="ko_8install_8php.html#a5b072c5fd1d2228c6ba5cee13cd142e3">title</a>   = $.trim(elTitle.val());</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;        var <a class="code" href="classcontent.html">content</a> = $.trim(elContent.val());</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;        var document_srl = $.trim(elDocument_srl.val());</div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;        <span class="keywordflow">if</span> (title || content || document_srl) {</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;            <span class="keywordflow">if</span> (confirm(this.<a class="code" href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a>._saved_doc_message.value)) {</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;                $(this.<a class="code" href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a>.title).<a class="code" href="ckeditor_2js_2xe__interface_8js.html#a4fb96abdf073a439bca5e051c333b35d">val</a>(title);</div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;                this.oApp.setIR(content);</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;                <span class="keywordflow">if</span>(typeof(<a class="code" href="xpresseditor_2js_2xe__interface_8js.html#a0f3c0e237d9657010d0a21498e93ea46">editorGetAutoSavedDoc</a>) == <span class="stringliteral">&#39;function&#39;</span>) <a class="code" href="xpresseditor_2js_2xe__interface_8js.html#a0f3c0e237d9657010d0a21498e93ea46">editorGetAutoSavedDoc</a>(this.<a class="code" href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a>);</div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;                <a class="code" href="editor__common_8js.html#a4eb48219a7e62e11219039145b0165c8">editorRemoveSavedDoc</a>();</div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;            }</div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;        }</div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;</div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;        <a class="code" href="editor__common_8js.html#a493216c50b02e45914523b7f1aba4d88">editorEnableAutoSave</a>(this.<a class="code" href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a>, $(this.<a class="code" href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a>).<a class="code" href="jquery-1_8x_8js.html#af22ff3acc1911f7b1d56fd19d45db91e">attr</a>(<span class="stringliteral">&quot;editor_sequence&quot;</span>));</div><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;</div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;        <span class="comment">// register hotkey</span></div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;        this.oApp.exec(<span class="stringliteral">&#39;REGISTER_HOTKEY&#39;</span>, [<span class="stringliteral">&#39;ctrl+shift+s&#39;</span>,<span class="stringliteral">&#39;AUTO_SAVE&#39;</span>]);</div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;    },</div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;</div><div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;    $ON_AUTO_SAVE : <span class="keyword">function</span>() {</div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;        <a class="code" href="editor__common_8js.html#a591b7575f1b1950bda8ef3c6b5339317">_editorAutoSave</a>();</div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;    }</div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;});</div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;<a class="code" href="namespacexe.html">xe</a>.XE_FormatWithSelectUI = $.Class({</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;    <a class="code" href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a> : <span class="stringliteral">&quot;XE_FormatWithSelectUI&quot;</span>,</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;    $init : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;        this._assignHTMLObjects(elAppContainer);</div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;    },</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;</div><div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;    _assignHTMLObjects : <span class="keyword">function</span>(elAppContainer){</div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;        this.elFormatSelect = $(<span class="stringliteral">&quot;SELECT.xpress_xeditor_ui_format_select&quot;</span>, elAppContainer).<span class="keyword">get</span>(0);</div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;    },</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>(){</div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;        this.oApp.registerBrowserEvent(this.elFormatSelect, <span class="stringliteral">&quot;change&quot;</span>, <span class="stringliteral">&quot;SET_FORMAT_FROM_SELECT_UI&quot;</span>);</div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;        this.elFormatSelect.selectedIndex = 0;</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;    },</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;    $ON_MSG_STYLE_CHANGED : <span class="keyword">function</span>(sAttributeName, sAttributeValue){</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;        var blockName = this.oApp.getWYSIWYGDocument().queryCommandValue(<span class="stringliteral">&quot;FormatBlock&quot;</span>);</div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;        <span class="keywordflow">if</span> (!blockName) <span class="keywordflow">return</span> (this.elFormatSelect.selectedIndex = 0);</div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;        <span class="keywordflow">if</span> ($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie &amp;&amp; /([0-9])/.test(blockName)) blockName = <span class="charliteral">&#39;h&#39;</span>+(RegExp.$1);</div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;        this.elFormatSelect.value = blockName.toLowerCase();</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;        <span class="keywordflow">if</span>(this.elFormatSelect.selectedIndex &lt; 0) this.elFormatSelect.selectedIndex = 0;</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;        <span class="keywordflow">if</span>(this.elFormatSelect.value != blockName.toLowerCase()) this.elFormatSelect.selectedIndex = 0;</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;    },</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;    $ON_SET_FORMAT_FROM_SELECT_UI : <span class="keyword">function</span>(){</div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;        var sFormat = this.elFormatSelect.value;</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;        <span class="keywordflow">if</span>(!sFormat) <span class="keywordflow">return</span>;</div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;        <span class="keywordflow">if</span>($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie) sFormat = <span class="charliteral">&#39;&lt;&#39;</span>+sFormat+<span class="charliteral">&#39;&gt;&#39;</span>;</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;EXECCOMMAND&quot;</span>, [<span class="stringliteral">&quot;FormatBlock&quot;</span>, <span class="keyword">false</span>, sFormat]);</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;CHECK_STYLE_CHANGE&quot;</span>, []);</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;    }</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;});</div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;<span class="comment">// 표 편집 확장 기능</span></div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;<a class="code" href="namespacexe.html">xe</a>.XE_Table = $.Class({</div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;    _startSel : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;    _endSel   : <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>,</div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;</div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;    $ON_MSG_APP_READY : <span class="keyword">function</span>() {</div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;        this._doc = $(this.oApp.getWYSIWYGDocument());</div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;</div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;        this.$FnMouseDown = $.fnBind(this._mousedown, <span class="keyword">this</span>);</div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;        this.$FnMouseUp   = $.fnBind(this._mouseup, <span class="keyword">this</span>);</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;        this.$FnMouseMove = $.fnBind(this._mousemove, <span class="keyword">this</span>);</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;        this._doc.mousedown(this.$FnMouseDown);</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;        <span class="comment">// initialize</span></div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;        this._startSel = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;        this._endSel   = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;</div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;        <span class="comment">// register buttons</span></div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;        this.oApp.exec(<span class="stringliteral">&#39;REGISTER_UI_EVENT&#39;</span>, [<span class="stringliteral">&#39;merge_cells&#39;</span>, <span class="stringliteral">&#39;click&#39;</span>, <span class="stringliteral">&#39;MERGE_CELLS&#39;</span>]);</div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;        this.oApp.exec(<span class="stringliteral">&#39;REGISTER_UI_EVENT&#39;</span>, [<span class="stringliteral">&#39;split_col&#39;</span>, <span class="stringliteral">&#39;click&#39;</span>, <span class="stringliteral">&#39;CELL_SPLIT_BY_COL&#39;</span>]);</div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;        this.oApp.exec(<span class="stringliteral">&#39;REGISTER_UI_EVENT&#39;</span>, [<span class="stringliteral">&#39;split_row&#39;</span>, <span class="stringliteral">&#39;click&#39;</span>, <span class="stringliteral">&#39;CELL_SPLIT_BY_ROW&#39;</span>]);</div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;</div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;        <span class="comment">// register hotkeys</span></div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;        this.oApp.exec(<span class="stringliteral">&#39;REGISTER_HOTKEY&#39;</span>, [<span class="stringliteral">&#39;ctrl+alt+m&#39;</span>, <span class="stringliteral">&#39;MERGE_CELLS&#39;</span>]);</div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;</div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;        <span class="comment">// perform default ready action</span></div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;        this.$super.$ON_MSG_APP_READY();</div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;    },</div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;</div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;    $ON_MERGE_CELLS : <span class="keyword">function</span>() {</div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;        var <a class="code" href="JSSpec_8js.html#a28141bc89afb42a8f39e596105992271">html</a> = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;        var cell = $(<span class="stringliteral">&#39;.xe_selected_cell&#39;</span>, this.oApp.getWYSIWYGDocument()).filter(<span class="stringliteral">&#39;td,th&#39;</span>);</div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;        var <span class="keyword">self</span> = <span class="keyword">this</span>;</div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;</div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;        <span class="comment">// 선택된 셀이 없으면 종료</span></div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;        <span class="keywordflow">if</span> (!cell.length) <span class="keywordflow">return</span>;</div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;</div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;        <span class="comment">// UNDO 지점 기록</span></div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_ACTION&quot;</span>, [<span class="stringliteral">&quot;Cell:Merge&quot;</span>]);</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;        <span class="comment">// 선택한 모든 셀의 데이터를 첫번째 셀로 복사</span></div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;        cell.each(<span class="keyword">function</span>(){ html += $(<span class="keyword">this</span>).<a class="code" href="JSSpec_8js.html#a28141bc89afb42a8f39e596105992271">html</a>() }).eq(0).html(html);</div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;</div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;        <span class="comment">// 첫번째 셀 가로 확장</span></div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;        var colspan = 0;</div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;        cell.eq(0).nextAll(<span class="stringliteral">&#39;td,th&#39;</span>).addBack().filter(<span class="stringliteral">&#39;.xe_selected_cell&#39;</span>).each(<span class="keyword">function</span>(idx){</div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;            colspan += <span class="keyword">self</span>._getSpan(<span class="keyword">this</span>, <span class="stringliteral">&#39;col&#39;</span>);</div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;        });</div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;</div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;        <span class="comment">// 마지막 셀까지 줄의 갯수 계산</span></div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;        var rect = this._getRect(cell.eq(0));</div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;        var start_tr = cell.eq(0).parent(<span class="stringliteral">&#39;tr&#39;</span>);</div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;        var end_tr   = cell.eq(cell.length-1).parent(<span class="stringliteral">&#39;tr&#39;</span>);</div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;        var all_rows = cell.parents(<span class="stringliteral">&#39;table&#39;</span>).eq(0).find(<span class="stringliteral">&#39;tr&#39;</span>);</div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;        var rowspan  = all_rows.index(end_tr.get(0)) - all_rows.index(start_tr.get(0)) + this._getSpan(cell.eq(cell.length-1), <span class="stringliteral">&#39;row&#39;</span>);</div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;</div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;        <span class="comment">// 첫번째 셀 colspan, rowspan 속성 지정</span></div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;        cell.eq(0).attr(<span class="stringliteral">&#39;colSpan&#39;</span>, colspan).attr(<span class="stringliteral">&#39;rowSpan&#39;</span>, rowspan);</div><div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;</div><div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;        <span class="comment">// 첫번째 셀을 제외한 다른 모든 셀 제거</span></div><div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;        cell.slice(1).remove();</div><div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;    },</div><div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;</div><div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;    $ON_CELL_SPLIT_BY_ROW : <span class="keyword">function</span>(many) {</div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;        var cell  = $(<span class="stringliteral">&#39;.xe_selected_cell&#39;</span>, this.oApp.getWYSIWYGDocument()).filter(<span class="stringliteral">&#39;td,th&#39;</span>);</div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;        var table = cell.parents(<span class="stringliteral">&#39;table&#39;</span>).eq(0);</div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;        var <span class="keyword">self</span>  = <span class="keyword">this</span>;</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;</div><div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;        <span class="comment">// 선택된 셀이 없으면 종료</span></div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;        <span class="keywordflow">if</span> (!cell.length) <span class="keywordflow">return</span>;</div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;</div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;        <span class="comment">// UNDO 지점 기록</span></div><div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_ACTION&quot;</span>, [<span class="stringliteral">&quot;Cell:Split By Row&quot;</span>]);</div><div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;</div><div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;        <span class="comment">// 선택 영역의 상하 좌표 구함</span></div><div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;        var _top    = this._getRect(cell.eq(0)).top;</div><div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;        var _bottom = this._getRect(cell.eq(cell.length-1)).bottom;</div><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;        <span class="comment">// 테이블의 모든 셀에서 선택영역에 해당하는 셀을 구한다(상하 기준).</span></div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;        (cell = table.find(<span class="stringliteral">&#39;td,th&#39;</span>).filter(<span class="keyword">function</span>(){</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;            var rect = <span class="keyword">self</span>._getRect($(<span class="keyword">this</span>));</div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;            <span class="keywordflow">return</span> !(rect.bottom &lt;= _top || rect.top &gt;= _bottom);</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;        })).filter(<span class="stringliteral">&#39;.xe_selected_cell&#39;</span>).each(<span class="keyword">function</span>(){</div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;            var <a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a>      = $(<span class="keyword">this</span>);</div><div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;            var row  = t.parent(<span class="stringliteral">&#39;tr&#39;</span>);</div><div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;            var rowspan = <span class="keyword">self</span>._getSpan(t, <span class="stringliteral">&#39;row&#39;</span>);</div><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;            var rect    = <span class="keyword">self</span>._getRect(t);</div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;            var queue   = [];</div><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;            var clone   = t.clone().html(<span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>);</div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;            var topspan = 1, botspan = 1;</div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;</div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;            <span class="comment">// rowspan &gt; 1이면 현재 셀의 rowspan을 절반으로 분할한다.</span></div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;            <span class="keywordflow">if</span> (rowspan &gt; 1) {</div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;</div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;                topspan = Math.ceil(rowspan/2);</div><div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;                botspan = rowspan - topspan;</div><div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;</div><div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;                queue.push(<span class="keyword">function</span>(){</div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;                    t.attr(<span class="stringliteral">&#39;rowSpan&#39;</span>, topspan);</div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;                });</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;</div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;                clone.attr(<span class="stringliteral">&#39;rowSpan&#39;</span>, botspan);</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;                <span class="comment">// rowspan이 없으면 현재 셀과 영역이 겹치는 모든 셀에 rowspan을 추가</span></div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;                cell.filter(<span class="keyword">function</span>(){</div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;                    <span class="keywordflow">if</span> (t.get(0) == <span class="keyword">this</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;                    var tt = $(<span class="keyword">this</span>);</div><div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;                    var rc = <span class="keyword">self</span>._getRect(tt);</div><div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;</div><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;                    <span class="comment">// 범위를 넘은 부분은 제외</span></div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;                    <span class="keywordflow">if</span> (rc.bottom &lt;= rect.top || rc.top &gt;= rect.bottom) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;</div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;                }).<a class="code" href="jquery-1_8x_8js.html#af7620627e2f905064d3dff5102ed804b">each</a>(<span class="keyword">function</span>(){</div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;                    var tt = $(<span class="keyword">this</span>);</div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;                    var sp = <span class="keyword">self</span>._getSpan(tt, <span class="stringliteral">&#39;row&#39;</span>)+1;</div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;</div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;                    <span class="comment">// rowspan 1 추가</span></div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;                    queue.push(<span class="keyword">function</span>(){</div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;                        tt.attr(<span class="stringliteral">&#39;rowSpan&#39;</span>, sp);</div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;                    });</div><div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;                });</div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;</div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;                <span class="comment">// 새 줄을 추가한다.</span></div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;                <span class="keywordflow">if</span> ($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie) {</div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;                    <span class="comment">// Fix bug for IE</span></div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;                    row.after(row.clone().empty().get(0).outerHTML);</div><div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;                    row.after(row.clone().empty());</div><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;                }</div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;            }</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;</div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;            var rows  = row.nextAll(<span class="stringliteral">&#39;tr&#39;</span>);</div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;</div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;            <span class="comment">// 현재 셀이 마지막 줄에 있다면 한 줄 추가 후 새로운 셀 추가</span></div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;            <span class="keywordflow">if</span> (!rows.length) {</div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;                row.after(row.clone().empty().append(clone));</div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;                var next_sib  = rows.eq(topspan - 1).children(<span class="stringliteral">&#39;td,th&#39;</span>).filter(<span class="keyword">function</span>(){</div><div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;                    <span class="keywordflow">return</span> ( <span class="keyword">self</span>._getRect($(<span class="keyword">this</span>)).left &gt; rect.left );</div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;                });</div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;</div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;                <span class="keywordflow">if</span> ($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie) {</div><div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;                    next_sib.length?</div><div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;                        next_sib.eq(0).before(clone.get(0).outerHTML):</div><div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;                        rows.eq(topspan-1).append(clone.get(0).outerHTML);</div><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;                    next_sib.length?</div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;                        next_sib.slice(0,1).before(clone):</div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;                        rows.slice(topspan-1,1).append(clone);</div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;                }</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;            }</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;</div><div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;            <span class="comment">// 함수를 바로 실행하면 좌표가 틀어지므로, 큐에 넣은 후 실행</span></div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;            $.each(queue, <span class="keyword">function</span>(){ <span class="keyword">this</span>(); });</div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;</div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;        });</div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;    },</div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;</div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;    $ON_CELL_SPLIT_BY_COL : <span class="keyword">function</span>(many) {</div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;        var cell   = $(<span class="stringliteral">&#39;.xe_selected_cell&#39;</span>, this.oApp.getWYSIWYGDocument()).filter(<span class="stringliteral">&#39;td,th&#39;</span>);</div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;        var table  = cell.parents(<span class="stringliteral">&#39;table&#39;</span>).slice(0,1);</div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;        var <span class="keyword">self</span>   = <span class="keyword">this</span>;</div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;        var ie_bug = [], tmpId = (<span class="keyword">new</span> Date).getTime(), tmpStr = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;</div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;        <span class="comment">// 선택된 셀이 없으면 종료</span></div><div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;        <span class="keywordflow">if</span> (!cell.length) <span class="keywordflow">return</span>;</div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;</div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;        <span class="comment">// UNDO 지점 기록</span></div><div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;        this.oApp.exec(<span class="stringliteral">&quot;RECORD_UNDO_ACTION&quot;</span>, [<span class="stringliteral">&quot;Cell:Split By Column&quot;</span>]);</div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;</div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;        <span class="comment">// 선택 영역의 좌우 좌표 구함</span></div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;        var first_row = cell.eq(0).parent(<span class="stringliteral">&#39;tr&#39;</span>);</div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;        var _left = this._getRect(first_row.find(<span class="stringliteral">&#39;.xe_selected_cell:first&#39;</span>)).left;</div><div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;        var _right = this._getRect(first_row.find(<span class="stringliteral">&#39;.xe_selected_cell:last&#39;</span>)).right;</div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;</div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;        <span class="comment">// 테이블의 모든 셀에서 선택영역에 해당하는 셀을 구한다(좌우 기준).</span></div><div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;        (cell = table.find(<span class="stringliteral">&#39;td,th&#39;</span>).filter(<span class="keyword">function</span>(){</div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;            var rect = <span class="keyword">self</span>._getRect($(<span class="keyword">this</span>));</div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;</div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;            <span class="keywordflow">return</span> !(rect.right &lt;= _left || rect.left &gt;= _right);</div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;        })).filter(<span class="stringliteral">&#39;.xe_selected_cell&#39;</span>).each(<span class="keyword">function</span>(idx){</div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;            var <a class="code" href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a>      = $(<span class="keyword">this</span>);</div><div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;            var colspan = <span class="keyword">self</span>._getSpan(t, <span class="stringliteral">&#39;col&#39;</span>);</div><div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;            var clone   = t.clone().html(<span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>);</div><div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;</div><div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;            <span class="comment">// colspan &gt; 1 이면 colspan을 절반으로 분할한다.</span></div><div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;            <span class="keywordflow">if</span> (colspan &gt; 1) {</div><div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;                var leftspan  = Math.ceil(colspan/2);</div><div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;                var rightspan = colspan - leftspan;</div><div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;</div><div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;                t.attr(<span class="stringliteral">&#39;colSpan&#39;</span>, leftspan);</div><div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;                clone.attr(<span class="stringliteral">&#39;colSpan&#39;</span>, rightspan);</div><div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;                <span class="comment">// colspan이 없으면 현재 셀과 영역이 겹치는 모든 셀에 colspan을 추가</span></div><div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;                var rect = <span class="keyword">self</span>._getRect(t);</div><div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;</div><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;                cell.filter(<span class="keyword">function</span>(){</div><div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;                    <span class="keywordflow">if</span> (t.get(0) == <span class="keyword">this</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;</div><div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;                    var tt = $(<span class="keyword">this</span>);</div><div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;                    var rc = <span class="keyword">self</span>._getRect(tt);</div><div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;</div><div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;                    <span class="comment">// 범위를 넘은 부분은 제외</span></div><div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;                    <span class="keywordflow">if</span> (rc.right &lt;= rect.left || rc.left &gt;= rect.right) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;</div><div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;                }).<a class="code" href="jquery-1_8x_8js.html#af7620627e2f905064d3dff5102ed804b">each</a>(<span class="keyword">function</span>(){</div><div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;                    var tt = $(<span class="keyword">this</span>);</div><div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;</div><div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;                    <span class="comment">// colspan 1 추가</span></div><div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;                    tt.attr(<span class="stringliteral">&#39;colSpan&#39;</span>, <span class="keyword">self</span>._getSpan(tt, <span class="stringliteral">&#39;col&#39;</span>)+1);</div><div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;                });</div><div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;</div><div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;                clone.attr(<span class="stringliteral">&#39;colSpan&#39;</span>, 1);</div><div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;            }</div><div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;</div><div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;            <span class="keywordflow">if</span> ($.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.msie) {</div><div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;                <span class="comment">// Fix for IE bug</span></div><div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;                t.after(clone.get(0).outerHTML);</div><div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;                t.after(clone);</div><div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;            }</div><div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;        });</div><div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;    },</div><div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;</div><div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;    $ON_CHECK_STYLE_CHANGE : <span class="keyword">function</span>(){</div><div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;        var ui  = [<span class="stringliteral">&#39;merge_cells&#39;</span>, <span class="stringliteral">&#39;split_col&#39;</span>, <span class="stringliteral">&#39;split_row&#39;</span>];</div><div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;        var app = this.oApp;</div><div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;        var command = (this._startSel &amp;&amp; this._startSel.is(<span class="stringliteral">&#39;.xe_selected_cell&#39;</span>))?<span class="stringliteral">&#39;ENABLE_UI&#39;</span>:<span class="stringliteral">&#39;DISABLE_UI&#39;</span>;</div><div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;</div><div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;        $.each(ui, <span class="keyword">function</span>(){ app.exec(command, [<span class="keyword">this</span>]); });</div><div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;    },</div><div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;</div><div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;    _mousedown : <span class="keyword">function</span>(event) {</div><div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;        var cur = $(<span class="keyword">event</span>.target);</div><div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;        var sel = cur.parents().addBack().filter(<span class="stringliteral">&#39;td,th,table&#39;</span>);</div><div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;        var app = this.oApp;</div><div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;        var <span class="keyword">self</span> = <span class="keyword">this</span>;</div><div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;</div><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;        <span class="comment">// 모든 선택영역 해제</span></div><div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;        $(<span class="stringliteral">&#39;td.xe_selected_cell&#39;</span>, this.oApp.getWYSIWYGDocument()).removeClass(<span class="stringliteral">&#39;xe_selected_cell&#39;</span>);</div><div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;</div><div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;        this._startSel = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;        this._endSel   = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;</div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;        <span class="keywordflow">if</span> (!sel.length || !<span class="keyword">this</span>._isLeftClicked(event.button)) <span class="keywordflow">return</span>;</div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;</div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;        <span class="keyword">function</span> delayed(){</div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;            sel = app.getSelection().cloneRange();</div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;            sel.collapseToStart();</div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;            sel = $(sel.startContainer).parents().addBack().filter(<span class="stringliteral">&#39;td,th&#39;</span>).eq(0);</div><div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;</div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;            <span class="keywordflow">if</span> (!sel.length) <span class="keywordflow">return</span> <span class="keyword">self</span>._removeAllListener()||<span class="keyword">true</span>;</div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;</div><div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;            <span class="comment">// 좌표를 구한다</span></div><div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;            <span class="keyword">self</span>._getRect(<span class="keyword">self</span>._startSel = sel);</div><div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;</div><div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;            <span class="comment">// 이벤트 바인딩</span></div><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;            <span class="keyword">self</span>._doc.bind(<span class="stringliteral">&#39;mousemove&#39;</span>, <span class="keyword">self</span>.$FnMouseMove);</div><div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;            <span class="keyword">self</span>._doc.bind(<span class="stringliteral">&#39;mouseup&#39;</span>, <span class="keyword">self</span>.$FnMouseUp);</div><div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;        }</div><div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;</div><div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;        <span class="comment">// mousedown이 일어난 후에 선택 영역이 설정되므로 실행을 지연시킨다.</span></div><div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;        setTimeout(delayed, 0);</div><div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;    },</div><div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;</div><div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;    _mouseup : <span class="keyword">function</span>(event) {</div><div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;        <span class="comment">// 선택된 셀 확인</span></div><div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;        this._removeAllListener();</div><div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;</div><div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;        <span class="comment">// 시작셀과 종료셀 제거</span></div><div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;        this._startSel = this._endSel = <a class="code" href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a>;</div><div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;    },</div><div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;</div><div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;    _mousemove : <span class="keyword">function</span>(event) {</div><div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;        var cur  = $(<span class="keyword">event</span>.target);</div><div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;        var cell = cur.parents().addBack().filter(<span class="stringliteral">&#39;td,th&#39;</span>).eq(0);</div><div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;        var <span class="keyword">self</span> = <span class="keyword">this</span>;</div><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;</div><div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;        <span class="comment">// 마우스 왼쪽 버튼이 눌리지 않았으면 종료</span></div><div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;        <span class="keywordflow">if</span> (!cell.length || !<span class="keyword">this</span>._isLeftClicked(event.button)) <span class="keywordflow">return</span>;</div><div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;        <span class="keywordflow">if</span> (!this._endSel &amp;&amp; cell.get(0) == this._startSel.get(0)) <span class="keywordflow">return</span>;</div><div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;        <span class="keywordflow">if</span> (this._endSel &amp;&amp; cell.get(0) == this._endSel.get(0)) <span class="keywordflow">return</span>;</div><div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;</div><div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;        <span class="comment">// 종료셀 &amp;&amp; 종료셀의 좌표</span></div><div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;        this._getRect(this._endSel = cell);</div><div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;</div><div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;        <span class="comment">// 선택 범위를 구한다</span></div><div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;        var _top    = Math.min(this._startSel.rect.top,  <span class="keyword">this</span>._endSel.rect.top);</div><div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;        var _left   = Math.min(this._startSel.rect.left, <span class="keyword">this</span>._endSel.rect.left);</div><div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;        var _bottom = Math.max(this._startSel.rect.bottom, <span class="keyword">this</span>._endSel.rect.bottom);</div><div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;        var _right  = Math.max(this._startSel.rect.right,  <span class="keyword">this</span>._endSel.rect.right);</div><div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;</div><div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;        var table = cell.parents(<span class="stringliteral">&#39;table&#39;</span>);</div><div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;        var cells = table.find(<span class="stringliteral">&#39;td,th&#39;</span>).removeClass(<span class="stringliteral">&#39;xe_selected_cell&#39;</span>);</div><div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;        var <a class="code" href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a> = 0;</div><div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;</div><div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;        <span class="comment">// 복잡한 모양의 테이블을 위한 반복 처리</span></div><div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;        var selected = $();</div><div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;        <span class="keywordflow">do</span> {</div><div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;            <span class="comment">// 선택한 셀로 최대 영역 재계산</span></div><div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;            selected.each(<span class="keyword">function</span>(){</div><div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;                var rect = <span class="keyword">self</span>._getRect($(<span class="keyword">this</span>));</div><div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;</div><div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;                <span class="comment">// 영역 재계산</span></div><div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;                <span class="keywordflow">if</span> (rect.right  &gt; _right)  _right  = rect.right;</div><div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;                <span class="keywordflow">if</span> (rect.left   &lt; _left)   _left   = rect.left;</div><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;                <span class="keywordflow">if</span> (rect.top    &lt; _top) _top    = rect.top;</div><div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;                <span class="keywordflow">if</span> (rect.bottom &gt; _bottom) _bottom = rect.bottom;</div><div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;            });</div><div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;</div><div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;            <span class="comment">// 좌표 범위 안에 있는 선택할 셀을 추린다.</span></div><div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;            cells = cells.filter(<span class="stringliteral">&#39;:not(.xe_selected_cell)&#39;</span>);</div><div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;            selected = cells.filter(<span class="keyword">function</span>(){</div><div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;                var rect = <span class="keyword">self</span>._getRect($(<span class="keyword">this</span>));</div><div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;</div><div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;                <span class="keywordflow">if</span> (rect.right &lt;= _left || rect.left &gt;= _right || rect.bottom &lt;= _top || rect.top &gt;= _bottom) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;</div><div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;            }).addClass(<span class="stringliteral">&#39;xe_selected_cell&#39;</span>);</div><div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;        } <span class="keywordflow">while</span>(selected.length);</div><div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;</div><div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;        <span class="comment">// 브라우저의 기본 선택영역 해제 : FF 제외 - 기본 기능이 충분히 좋아서 + 이 부분을 실행하면 오류가 발생해서</span></div><div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;        <span class="keywordflow">if</span> (!$.<a class="code" href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a>.mozilla) {</div><div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;            <span class="keyword">function</span> delayed() {</div><div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;                var sel = <span class="keyword">self</span>.oApp.getSelection();</div><div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;</div><div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;                <span class="keywordflow">if</span> (!<span class="keyword">self</span>._startSel) <span class="keywordflow">return</span>;</div><div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;                <span class="keywordflow">if</span> (!<span class="keyword">self</span>._startSel.get(0).firstChild) <span class="keyword">self</span>._startSel.text(<span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;</div><div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;                sel.selectNode(<span class="keyword">self</span>._startSel.get(0).firstChild);</div><div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;                sel.collapseToStart();</div><div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;                sel.select();</div><div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;            }</div><div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;</div><div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;            setTimeout(delayed, 0);</div><div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;        }</div><div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;</div><div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;    },</div><div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;</div><div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;    _removeAllListener : <span class="keyword">function</span>() {</div><div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;        <span class="comment">// 이벤트 해제</span></div><div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;        this._doc.unbind(<span class="stringliteral">&quot;mousemove&quot;</span>, this.$FnMouseMove);</div><div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;        this._doc.unbind(<span class="stringliteral">&quot;mouseup&quot;</span>, this.$FnMouseUp);</div><div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;    },</div><div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;</div><div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;    _isLeftClicked : <span class="keyword">function</span>(<a class="code" href="jquery-1_8x_8js.html#abe5393d870043cf6aaa1d5ad5fce755c">value</a>) {</div><div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;        <span class="keywordflow">return</span> $.browser.msie?!!(<a class="code" href="jquery-1_8x_8js.html#abe5393d870043cf6aaa1d5ad5fce755c">value</a> &amp; 1):(<a class="code" href="jquery-1_8x_8js.html#abe5393d870043cf6aaa1d5ad5fce755c">value</a> == 0);</div><div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;    },</div><div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;</div><div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;    _getRect : <span class="keyword">function</span>(obj) {</div><div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;        var el = obj.get(0);</div><div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;</div><div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;        obj.rect = {};</div><div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;        obj.rect.top    = el.offsetTop;</div><div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;        obj.rect.left   = el.offsetLeft;</div><div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;        obj.rect.bottom = obj.rect.top  + el.offsetHeight;</div><div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;        obj.rect.right  = obj.rect.left + el.offsetWidth;</div><div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;</div><div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;        <span class="keywordflow">return</span> obj.rect;</div><div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;    },</div><div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;</div><div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;    _getSpan : <span class="keyword">function</span>(obj, type) {</div><div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;        var span = parseInt($(obj).<a class="code" href="jquery-1_8x_8js.html#af22ff3acc1911f7b1d56fd19d45db91e">attr</a>(type+<span class="stringliteral">&#39;span&#39;</span>));</div><div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;</div><div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;        <span class="keywordflow">return</span> isNaN(span)?1:span;</div><div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;    }</div><div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;}).<a class="code" href="jquery_8js.html#a84ade6b4c0a71f54664069487f2526dc">extend</a>(<a class="code" href="namespacexe.html">xe</a>.XE_Table);</div><div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;</div><div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;})(<a class="code" href="captcha_8js.html#a2b1d6f9c448e3ce72f4e1865d6e38d2c">jQuery</a>);</div><div class="ttc" id="xpresseditor_8min_8js_html_a41501e23bb16bb56190330504dbe53de"><div class="ttname"><a href="xpresseditor_8min_8js.html#a41501e23bb16bb56190330504dbe53de">regex</a></div><div class="ttdeci">c prototype c prototype c prototype c prototype c prototype xe xe xe xe xe xe xe xe xe xe xe xe xe xe xe xe xe regex</div><div class="ttdef"><b>Definition:</b> <a href="xpresseditor_8min_8js_source.html#l00004">xpresseditor.min.js:4</a></div></div>
<div class="ttc" id="ko_8install_8php_html_a5b072c5fd1d2228c6ba5cee13cd142e3"><div class="ttname"><a href="ko_8install_8php.html#a5b072c5fd1d2228c6ba5cee13cd142e3">title</a></div><div class="ttdeci">$args title</div><div class="ttdef"><b>Definition:</b> <a href="ko_8install_8php_source.html#l00189">ko.install.php:189</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_aee5af4e0aaa2cfde6be1272633d18b59"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#aee5af4e0aaa2cfde6be1272633d18b59">d</a></div><div class="ttdeci">var d</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_a9721a992655f700bdc2e91ba68b71e26"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#a9721a992655f700bdc2e91ba68b71e26">w</a></div><div class="ttdeci">var w</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="Xpress__Editor_8js_html_a7514998df379a196147db35a4a4da555"><div class="ttname"><a href="Xpress__Editor_8js.html#a7514998df379a196147db35a4a4da555">END_TO_END</a></div><div class="ttdeci">xe W3CDOMRange END_TO_END</div><div class="ttdef"><b>Definition:</b> <a href="Xpress__Editor_8js_source.html#l00880">Xpress_Editor.js:880</a></div></div>
<div class="ttc" id="Xpress__Editor_8js_html_a2a488ca0c54bef41cd94ae4334fca763"><div class="ttname"><a href="Xpress__Editor_8js.html#a2a488ca0c54bef41cd94ae4334fca763">START_TO_START</a></div><div class="ttdeci">xe W3CDOMRange START_TO_START</div><div class="ttdef"><b>Definition:</b> <a href="Xpress__Editor_8js_source.html#l00878">Xpress_Editor.js:878</a></div></div>
<div class="ttc" id="classftp_html"><div class="ttname"><a href="classftp.html">ftp</a></div><div class="ttdef"><b>Definition:</b> <a href="ftp_8class_8php_source.html#l00044">ftp.class.php:44</a></div></div>
<div class="ttc" id="classtag_html"><div class="ttname"><a href="classtag.html">tag</a></div><div class="ttdoc">high class of the tag module </div><div class="ttdef"><b>Definition:</b> <a href="tag_8class_8php_source.html#l00008">tag.class.php:8</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_a8bab16140cede5f71c657e8dc46c1887"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#a8bab16140cede5f71c657e8dc46c1887">S</a></div><div class="ttdeci">var S</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="JSSpec_8js_html_a1bbe1edfe5ca552feb7c8830e9a19625"><div class="ttname"><a href="JSSpec_8js.html#a1bbe1edfe5ca552feb7c8830e9a19625">run</a></div><div class="ttdeci">JSSpec Executor prototype run</div><div class="ttdef"><b>Definition:</b> <a href="JSSpec_8js_source.html#l00107">JSSpec.js:107</a></div></div>
<div class="ttc" id="xpresseditor_8min_8js_html_a252592379bc934b27218ace911e55c34"><div class="ttname"><a href="xpresseditor_8min_8js.html#a252592379bc934b27218ace911e55c34">setSelection</a></div><div class="ttdeci">c prototype c prototype setSelection</div><div class="ttdef"><b>Definition:</b> <a href="xpresseditor_8min_8js_source.html#l00002">xpresseditor.min.js:2</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_a14e11a60aa3603727bb80abf8f71a4d5"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#a14e11a60aa3603727bb80abf8f71a4d5">b</a></div><div class="ttdeci">var b</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="captcha_8js_html_a2b1d6f9c448e3ce72f4e1865d6e38d2c"><div class="ttname"><a href="captcha_8js.html#a2b1d6f9c448e3ce72f4e1865d6e38d2c">jQuery</a></div><div class="ttdeci">function jQuery</div><div class="ttdef"><b>Definition:</b> <a href="captcha_8js_source.html#l00003">captcha.js:3</a></div></div>
<div class="ttc" id="diff__match__patch_8js_html_a5d4c58bc1e0a7de2e75ea206be2cbe94"><div class="ttname"><a href="diff__match__patch_8js.html#a5d4c58bc1e0a7de2e75ea206be2cbe94">toString</a></div><div class="ttdeci">patch_obj prototype toString</div><div class="ttdef"><b>Definition:</b> <a href="diff__match__patch_8js_source.html#l00001">diff_match_patch.js:1</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_ad55530ae1e5978df8e721017c1fc8466"><div class="ttname"><a href="jquery-1_8x_8js.html#ad55530ae1e5978df8e721017c1fc8466">window</a></div><div class="ttdeci">function window</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l00014">jquery-1.x.js:14</a></div></div>
<div class="ttc" id="respond_8min_8js_html_a5e25b1d1bed9ab5f3174b76d6a722180"><div class="ttname"><a href="respond_8min_8js.html#a5e25b1d1bed9ab5f3174b76d6a722180">i</a></div><div class="ttdeci">var i</div><div class="ttdef"><b>Definition:</b> <a href="respond_8min_8js_source.html#l00006">respond.min.js:6</a></div></div>
<div class="ttc" id="Xpress__Editor_8js_html_a863e6d0bd8f47ce037b809e457a29c21"><div class="ttname"><a href="Xpress__Editor_8js.html#a863e6d0bd8f47ce037b809e457a29c21">END_TO_START</a></div><div class="ttdeci">xe W3CDOMRange END_TO_START</div><div class="ttdef"><b>Definition:</b> <a href="Xpress__Editor_8js_source.html#l00881">Xpress_Editor.js:881</a></div></div>
<div class="ttc" id="namespacexe_html"><div class="ttname"><a href="namespacexe.html">xe</a></div></div>
<div class="ttc" id="common_8js_html_a22c29d2aa8ed6161ce8faa718ef76e68"><div class="ttname"><a href="common_8js.html#a22c29d2aa8ed6161ce8faa718ef76e68">name</a></div><div class="ttdeci">os name</div><div class="ttdef"><b>Definition:</b> <a href="common_8js_source.html#l00019">common.js:19</a></div></div>
<div class="ttc" id="JSSpec_8js_html_a28141bc89afb42a8f39e596105992271"><div class="ttname"><a href="JSSpec_8js.html#a28141bc89afb42a8f39e596105992271">html</a></div><div class="ttdeci">html</div><div class="ttdef"><b>Definition:</b> <a href="JSSpec_8js_source.html#l01371">JSSpec.js:1371</a></div></div>
<div class="ttc" id="editor__common_8js_html_a591b7575f1b1950bda8ef3c6b5339317"><div class="ttname"><a href="editor__common_8js.html#a591b7575f1b1950bda8ef3c6b5339317">_editorAutoSave</a></div><div class="ttdeci">function _editorAutoSave(exe, callback)</div><div class="ttdef"><b>Definition:</b> <a href="editor__common_8js_source.html#l00046">editor_common.js:46</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_af22ff3acc1911f7b1d56fd19d45db91e"><div class="ttname"><a href="jquery-1_8x_8js.html#af22ff3acc1911f7b1d56fd19d45db91e">attr</a></div><div class="ttdeci">jQuery attr</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l09887">jquery-1.x.js:9887</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_a4411a3d16c33c71210302860f22ba789"><div class="ttname"><a href="jquery-1_8x_8js.html#a4411a3d16c33c71210302860f22ba789">init</a></div><div class="ttdeci">jQuery fn init</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l09987">jquery-1.x.js:9987</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_a638fd10c6d2f5e258459b1abfa3b94ea"><div class="ttname"><a href="jquery-1_8x_8js.html#a638fd10c6d2f5e258459b1abfa3b94ea">add</a></div><div class="ttdeci">jQuery event add</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l10205">jquery-1.x.js:10205</a></div></div>
<div class="ttc" id="admin_2tpl_2js_2jquery_8jstree_8js_html_afba6effcee365bc3169e58b1b3627ee9"><div class="ttname"><a href="admin_2tpl_2js_2jquery_8jstree_8js.html#afba6effcee365bc3169e58b1b3627ee9">css</a></div><div class="ttdeci">function vakata css</div><div class="ttdef"><b>Definition:</b> <a href="admin_2tpl_2js_2jquery_8jstree_8js_source.html#l00032">jquery.jstree.js:32</a></div></div>
<div class="ttc" id="jquery_8js_html_a84ade6b4c0a71f54664069487f2526dc"><div class="ttname"><a href="jquery_8js.html#a84ade6b4c0a71f54664069487f2526dc">extend</a></div><div class="ttdeci">jQuery extend</div><div class="ttdef"><b>Definition:</b> <a href="jquery_8js_source.html#l00285">jquery.js:285</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_a08113a236cc18d2a9d5ce27e638012be"><div class="ttname"><a href="jquery-1_8x_8js.html#a08113a236cc18d2a9d5ce27e638012be">undefined</a></div><div class="ttdeci">function undefined</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l00014">jquery-1.x.js:14</a></div></div>
<div class="ttc" id="xe_8min_8js_html_adee58f90c97f973ad30e3b5c6b693409"><div class="ttname"><a href="xe_8min_8js.html#adee58f90c97f973ad30e3b5c6b693409">registerPlugin</a></div><div class="ttdeci">k registerPlugin(new l)}(jQuery)</div></div>
<div class="ttc" id="LICENSE_8txt_html_ac4b61a1f8e5f59d19b9a24b25b336db1"><div class="ttname"><a href="LICENSE_8txt.html#ac4b61a1f8e5f59d19b9a24b25b336db1">http</a></div><div class="ttdeci">XpressEditor http</div><div class="ttdef"><b>Definition:</b> <a href="LICENSE_8txt_source.html#l00004">LICENSE.txt:4</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_af7620627e2f905064d3dff5102ed804b"><div class="ttname"><a href="jquery-1_8x_8js.html#af7620627e2f905064d3dff5102ed804b">each</a></div><div class="ttdeci">jQuery each([&quot;height&quot;,&quot;width&quot;], function(i, name){jQuery.cssHooks[name]={get:function(elem, computed, extra){if(computed){   return elem.offsetWidth===0 &amp;&amp;rdisplayswap.test(jQuery.css(elem,&quot;display&quot;))?jQuery.swap(elem, cssShow, function(){return getWidthOrHeight(elem, name, extra);}):getWidthOrHeight(elem, name, extra);}}, set:function(elem, value, extra){var styles=extra &amp;&amp;getStyles(elem);return setPositiveNumber(elem, value, extra?augmentWidthOrHeight(elem, name, extra, jQuery.support.boxSizing &amp;&amp;jQuery.css(elem,&quot;boxSizing&quot;, false, styles)===&quot;border-box&quot;, styles):0);}};})</div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_ad1707b001240e9c8298830073364c8bf"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#ad1707b001240e9c8298830073364c8bf">p</a></div><div class="ttdeci">var p</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="classcontent_html"><div class="ttname"><a href="classcontent.html">content</a></div><div class="ttdoc">widget to display content </div><div class="ttdef"><b>Definition:</b> <a href="content_8class_8php_source.html#l00009">content.class.php:9</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_afc984c4f6c68ce30a0af99006f5f8d27"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#afc984c4f6c68ce30a0af99006f5f8d27">n</a></div><div class="ttdeci">function n</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_aef10902ffededd983608fdb8dbfc441a"><div class="ttname"><a href="jquery-1_8x_8js.html#aef10902ffededd983608fdb8dbfc441a">start</a></div><div class="ttdeci">jQuery fx start</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l09518">jquery-1.x.js:9518</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_a8d0b9ec82c308161432f1c387d2fc2a7"><div class="ttname"><a href="jquery-1_8x_8js.html#a8d0b9ec82c308161432f1c387d2fc2a7">load</a></div><div class="ttdeci">jQuery fn load</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l07717">jquery-1.x.js:7717</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_ab8e6e1fb3b8b51b6afe437c63df0e09f"><div class="ttname"><a href="jquery-1_8x_8js.html#ab8e6e1fb3b8b51b6afe437c63df0e09f">getWindow</a></div><div class="ttdeci">function getWindow(elem)</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l09708">jquery-1.x.js:9708</a></div></div>
<div class="ttc" id="admin_2tpl_2js_2jquery_8tmpl_8js_html_a7bc49e0067f94427aa645d548daf1f0a"><div class="ttname"><a href="admin_2tpl_2js_2jquery_8tmpl_8js.html#a7bc49e0067f94427aa645d548daf1f0a">unescape</a></div><div class="ttdeci">function unescape(args)</div><div class="ttdef"><b>Definition:</b> <a href="admin_2tpl_2js_2jquery_8tmpl_8js_source.html#l00370">jquery.tmpl.js:370</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_abce695e0af988ece0826d9ad59b8160d"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#abce695e0af988ece0826d9ad59b8160d">c</a></div><div class="ttdeci">var c</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_a81e910173af87b1161e719a504d52407"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#a81e910173af87b1161e719a504d52407">x</a></div><div class="ttdeci">var x</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="classdocument_html"><div class="ttname"><a href="classdocument.html">document</a></div><div class="ttdoc">document the module&amp;#39;s high class { </div><div class="ttdef"><b>Definition:</b> <a href="document_8class_8php_source.html#l00014">document.class.php:14</a></div></div>
<div class="ttc" id="modernizr_8min_8js_html_a286f9ec831c5e676eeb493248eab9575"><div class="ttname"><a href="modernizr_8min_8js.html#a286f9ec831c5e676eeb493248eab9575">null</a></div><div class="ttdeci">B B B null</div><div class="ttdef"><b>Definition:</b> <a href="modernizr_8min_8js_source.html#l00004">modernizr.min.js:4</a></div></div>
<div class="ttc" id="ReadMe_8txt_html_a4d93093c68b5e8c12de9bf3182195739"><div class="ttname"><a href="ReadMe_8txt.html#a4d93093c68b5e8c12de9bf3182195739">form</a></div><div class="ttdeci">We wish to convert a whole URI into the IDNA form</div><div class="ttdef"><b>Definition:</b> <a href="ReadMe_8txt_source.html#l00111">ReadMe.txt:111</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_ad9a7d92cb87932d25187fdec3ba1b621"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#ad9a7d92cb87932d25187fdec3ba1b621">s</a></div><div class="ttdeci">var s</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_a37b9e1ceee4c6d2616fa6081784b5468"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#a37b9e1ceee4c6d2616fa6081784b5468">fn</a></div><div class="ttdeci">var fn</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00005">jquery-1.x.min.js:5</a></div></div>
<div class="ttc" id="layouts_2xedition_2js_2layout_8js_html_a3a1f4f7d234c54c60d004099251de877"><div class="ttname"><a href="layouts_2xedition_2js_2layout_8js.html#a3a1f4f7d234c54c60d004099251de877">focus</a></div><div class="ttdeci">focus(function(){$(this).mouseover();}).end().mouseleave(function()</div><div class="ttdef"><b>Definition:</b> <a href="layouts_2xedition_2js_2layout_8js_source.html#l00052">layout.js:52</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_a7ef9b7a13e7ecdb967f1b98b4ada2470"><div class="ttname"><a href="jquery-1_8x_8js.html#a7ef9b7a13e7ecdb967f1b98b4ada2470">prototype</a></div><div class="ttdeci">Tween prototype</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l09193">jquery-1.x.js:9193</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_a400dc8109620963da8314d4bdfa14f83"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#a400dc8109620963da8314d4bdfa14f83">o</a></div><div class="ttdeci">var o</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="layouts_2xedition_2js_2layout_8js_html_a36ec7864a007264541b9a389ce97d8a6"><div class="ttname"><a href="layouts_2xedition_2js_2layout_8js.html#a36ec7864a007264541b9a389ce97d8a6">click</a></div><div class="ttdeci">$searchEl click(function(){if($searchForm.is(':hidden')){$searchForm.fadeIn().find('input').focus();if($('.magazine').length &gt; 0){$('.custom_area').css('opacity', 0);$('.side').css('opacity', 0)}else{$('.header').css('opacity', 0)}}return false;})</div></div>
<div class="ttc" id="jquery-1_8x_8js_html_afa6806c6ee5e63d5177f1dcc082ba6bc"><div class="ttname"><a href="jquery-1_8x_8js.html#afa6806c6ee5e63d5177f1dcc082ba6bc">size</a></div><div class="ttdeci">jQuery fn size</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l09760">jquery-1.x.js:9760</a></div></div>
<div class="ttc" id="jquery_8mobile_8customized_8min_8js_html_a014f4b186ec2d7af824aa74fbff0cb94"><div class="ttname"><a href="jquery_8mobile_8customized_8min_8js.html#a014f4b186ec2d7af824aa74fbff0cb94">find</a></div><div class="ttdeci">a find</div><div class="ttdef"><b>Definition:</b> <a href="jquery_8mobile_8customized_8min_8js_source.html#l00003">jquery.mobile.customized.min.js:3</a></div></div>
<div class="ttc" id="Xpress__Editor_8js_html_af2839fc42e9583ecad27de8c79c94551"><div class="ttname"><a href="Xpress__Editor_8js.html#af2839fc42e9583ecad27de8c79c94551">START_TO_END</a></div><div class="ttdeci">xe W3CDOMRange START_TO_END</div><div class="ttdef"><b>Definition:</b> <a href="Xpress__Editor_8js_source.html#l00879">Xpress_Editor.js:879</a></div></div>
<div class="ttc" id="html5_8js_html_a2c038346d47955cbe2cb91e338edd7e1"><div class="ttname"><a href="html5_8js.html#a2c038346d47955cbe2cb91e338edd7e1">e</a></div><div class="ttdeci">var e</div><div class="ttdef"><b>Definition:</b> <a href="html5_8js_source.html#l00007">html5.js:7</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_ad2e233c7f69c182810f01dc9d1a2d546"><div class="ttname"><a href="jquery-1_8x_8js.html#ad2e233c7f69c182810f01dc9d1a2d546">browser</a></div><div class="ttdeci">var browser</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l09980">jquery-1.x.js:9980</a></div></div>
<div class="ttc" id="editor__common_8js_html_a4eb48219a7e62e11219039145b0165c8"><div class="ttname"><a href="editor__common_8js.html#a4eb48219a7e62e11219039145b0165c8">editorRemoveSavedDoc</a></div><div class="ttdeci">function editorRemoveSavedDoc()</div><div class="ttdef"><b>Definition:</b> <a href="editor__common_8js_source.html#l00108">editor_common.js:108</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_a4a9f594d20d927164551fc7fa4751a2f"><div class="ttname"><a href="jquery-1_8x_8js.html#a4a9f594d20d927164551fc7fa4751a2f">offset</a></div><div class="ttdeci">jQuery fn offset</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l09546">jquery-1.x.js:9546</a></div></div>
<div class="ttc" id="JSSpec_8js_html_ae8ddf9e890c62bf03be54143867a14a8"><div class="ttname"><a href="JSSpec_8js.html#ae8ddf9e890c62bf03be54143867a14a8">id</a></div><div class="ttdeci">JSSpec Spec id</div><div class="ttdef"><b>Definition:</b> <a href="JSSpec_8js_source.html#l00218">JSSpec.js:218</a></div></div>
<div class="ttc" id="xpresseditor_8min_8js_html_ab483765d900d3be44fd88e28e03c1d56"><div class="ttname"><a href="xpresseditor_8min_8js.html#ab483765d900d3be44fd88e28e03c1d56">paste</a></div><div class="ttdeci">c prototype c prototype c prototype c prototype paste</div><div class="ttdef"><b>Definition:</b> <a href="xpresseditor_8min_8js_source.html#l00002">xpresseditor.min.js:2</a></div></div>
<div class="ttc" id="xpresseditor_2js_2xe__interface_8js_html_a0f3c0e237d9657010d0a21498e93ea46"><div class="ttname"><a href="xpresseditor_2js_2xe__interface_8js.html#a0f3c0e237d9657010d0a21498e93ea46">editorGetAutoSavedDoc</a></div><div class="ttdeci">function editorGetAutoSavedDoc(form)</div><div class="ttdef"><b>Definition:</b> <a href="xpresseditor_2js_2xe__interface_8js_source.html#l00224">xe_interface.js:224</a></div></div>
<div class="ttc" id="Xpress__Editor_8js_html_a86e645479660fa42b910395d43150925"><div class="ttname"><a href="Xpress__Editor_8js.html#a86e645479660fa42b910395d43150925">Class_extend</a></div><div class="ttdeci">function Class_extend(superDef)</div><div class="ttdef"><b>Definition:</b> <a href="Xpress__Editor_8js_source.html#l00038">Xpress_Editor.js:38</a></div></div>
<div class="ttc" id="html5_8js_html_aa14f8e0338cced6720590fd2ea13bd4b"><div class="ttname"><a href="html5_8js.html#aa14f8e0338cced6720590fd2ea13bd4b">document</a></div><div class="ttdeci">document</div><div class="ttdef"><b>Definition:</b> <a href="html5_8js_source.html#l00008">html5.js:8</a></div></div>
<div class="ttc" id="editor__common_8js_html_ab93b882536c44fdf3619d68842133a5c"><div class="ttname"><a href="editor__common_8js.html#ab93b882536c44fdf3619d68842133a5c">editorPrevNode</a></div><div class="ttdeci">var editorPrevNode</div><div class="ttdef"><b>Definition:</b> <a href="editor__common_8js_source.html#l00217">editor_common.js:217</a></div></div>
<div class="ttc" id="ckeditor_2js_2xe__interface_8js_html_a4fb96abdf073a439bca5e051c333b35d"><div class="ttname"><a href="ckeditor_2js_2xe__interface_8js.html#a4fb96abdf073a439bca5e051c333b35d">val</a></div><div class="ttdeci">var val</div><div class="ttdef"><b>Definition:</b> <a href="ckeditor_2js_2xe__interface_8js_source.html#l00038">xe_interface.js:38</a></div></div>
<div class="ttc" id="editor__common_8js_html_aefa1bbe206ace10cf6ebc63da9ef7219"><div class="ttname"><a href="editor__common_8js.html#aefa1bbe206ace10cf6ebc63da9ef7219">openComponent</a></div><div class="ttdeci">function openComponent(component_name, editor_sequence, manual_url)</div><div class="ttdef"><b>Definition:</b> <a href="editor__common_8js_source.html#l00205">editor_common.js:205</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_a23c5666e83bbbceee94adcd0851f50c4"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#a23c5666e83bbbceee94adcd0851f50c4">t</a></div><div class="ttdeci">function t</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00003">jquery-1.x.min.js:3</a></div></div>
<div class="ttc" id="modernizr_8min_8js_html_aa4d4888597588a84fd5b1184d00c91f3"><div class="ttname"><a href="modernizr_8min_8js.html#aa4d4888597588a84fd5b1184d00c91f3">a</a></div><div class="ttdeci">function a</div><div class="ttdef"><b>Definition:</b> <a href="modernizr_8min_8js_source.html#l00004">modernizr.min.js:4</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_a103df269476e78897c9c4c6cb8f4eb06"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#a103df269476e78897c9c4c6cb8f4eb06">g</a></div><div class="ttdeci">var g</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00007">jquery-1.x.min.js:7</a></div></div>
<div class="ttc" id="jquery-1_8x_8js_html_abe5393d870043cf6aaa1d5ad5fce755c"><div class="ttname"><a href="jquery-1_8x_8js.html#abe5393d870043cf6aaa1d5ad5fce755c">value</a></div><div class="ttdeci">jQuery attrHooks value</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8js_source.html#l09953">jquery-1.x.js:9953</a></div></div>
<div class="ttc" id="jquery-1_8x_8min_8js_html_a9d5fa4fe98b38569490d55d1a97b0f72"><div class="ttname"><a href="jquery-1_8x_8min_8js.html#a9d5fa4fe98b38569490d55d1a97b0f72">on</a></div><div class="ttdeci">function getComputedStyle(Rt=function(t){return e.getComputedStyle(t, null)}, Wt=function(e, n, r){var i, o, a, s=r||Rt(e), l=s?s.getPropertyValue(n)||s[n]:t, u=e.style;return s &amp;&amp;(&quot;&quot;!==l||x.contains(e.ownerDocument, e)||(l=x.style(e, n)), Yt.test(l)&amp;&amp;Ut.test(n)&amp;&amp;(i=u.width, o=u.minWidth, a=u.maxWidth, u.minWidth=u.maxWidth=u.width=l, l=s.width, u.width=i, u.minWidth=o, u.maxWidth=a)), l}) on(e, t, n)</div><div class="ttdef"><b>Definition:</b> <a href="jquery-1_8x_8min_8js_source.html#l00005">jquery-1.x.min.js:5</a></div></div>
<div class="ttc" id="editor__common_8js_html_a493216c50b02e45914523b7f1aba4d88"><div class="ttname"><a href="editor__common_8js.html#a493216c50b02e45914523b7f1aba4d88">editorEnableAutoSave</a></div><div class="ttdeci">function editorEnableAutoSave(fo_obj, editor_sequence, callback)</div><div class="ttdef"><b>Definition:</b> <a href="editor__common_8js_source.html#l00034">editor_common.js:34</a></div></div>
<div class="ttc" id="xpresseditor_8min_8js_html_abe32dbc1f360937030a749861db6c5fc"><div class="ttname"><a href="xpresseditor_8min_8js.html#abe32dbc1f360937030a749861db6c5fc">copy</a></div><div class="ttdeci">c prototype c prototype c prototype copy</div><div class="ttdef"><b>Definition:</b> <a href="xpresseditor_8min_8js_source.html#l00002">xpresseditor.min.js:2</a></div></div>
<div class="ttc" id="xpresseditor_8min_8js_html_a35285773512637248aba162f229c8949"><div class="ttname"><a href="xpresseditor_8min_8js.html#a35285773512637248aba162f229c8949">getSelection</a></div><div class="ttdeci">c prototype getSelection</div><div class="ttdef"><b>Definition:</b> <a href="xpresseditor_8min_8js_source.html#l00002">xpresseditor.min.js:2</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 5 2016 15:26:56 for XpressEngine Core by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
